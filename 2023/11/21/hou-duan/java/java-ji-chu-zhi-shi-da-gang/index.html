<!DOCTYPE HTML>
<html lang="zh-CN">


<head>
    <meta charset="utf-8">
    <meta name="keywords" content="Java基础知识大纲, 沙漠之狐，jochen">
    <meta name="description" content="Java基础知识大纲一.java基础问题1.Arraylist 原理以及特性ArrayList 是 Java 中的一个动态数组实现，它属于 Java Collections Framework 的一部分。以下是关于 ArrayList 的一">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="renderer" content="webkit|ie-stand|ie-comp">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="format-detection" content="telephone=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="referrer" content="no-referrer-when-downgrade">
    <!-- Global site tag (gtag.js) - Google Analytics -->


    <title>Java基础知识大纲 | 沙漠之狐</title>
    <link rel="icon" type="image/png" href="/favicon.png">
    


    <!-- bg-cover style     -->



<link rel="stylesheet" type="text/css" href="/libs/awesome/css/all.min.css">
<link rel="stylesheet" type="text/css" href="/libs/materialize/materialize.min.css">
<link rel="stylesheet" type="text/css" href="/libs/aos/aos.css">
<link rel="stylesheet" type="text/css" href="/libs/animate/animate.min.css">
<link rel="stylesheet" type="text/css" href="/libs/lightGallery/css/lightgallery.min.css">
<link rel="stylesheet" type="text/css" href="/css/matery.css">
<link rel="stylesheet" type="text/css" href="/css/my.css">
<link rel="stylesheet" type="text/css" href="/css/dark.css" media="none" onload="if(media!='all')media='all'">




    <link rel="stylesheet" href="/libs/tocbot/tocbot.css">
    <link rel="stylesheet" href="/css/post.css">




    
        <link rel="stylesheet" type="text/css" href="/css/reward.css">
    



    <script src="/libs/jquery/jquery-3.6.0.min.js"></script>

<meta name="generator" content="Hexo 6.3.0">
<style>.github-emoji { position: relative; display: inline-block; width: 1.2em; min-height: 1.2em; overflow: hidden; vertical-align: top; color: transparent; }  .github-emoji > span { position: relative; z-index: 10; }  .github-emoji img, .github-emoji .fancybox { margin: 0 !important; padding: 0 !important; border: none !important; outline: none !important; text-decoration: none !important; user-select: none !important; cursor: auto !important; }  .github-emoji img { height: 1.2em !important; width: 1.2em !important; position: absolute !important; left: 50% !important; top: 50% !important; transform: translate(-50%, -50%) !important; user-select: none !important; cursor: auto !important; } .github-emoji-fallback { color: inherit; } .github-emoji-fallback img { opacity: 0 !important; }</style>
<link rel="alternate" href="/atom.xml" title="沙漠之狐" type="application/atom+xml">
</head>


<body>
    <header class="navbar-fixed">
    <nav id="headNav" class="bg-color nav-transparent">
        <div id="navContainer" class="nav-wrapper container">
            <div class="brand-logo">
                <a href="/" class="waves-effect waves-light">
                    
                    <img src="/medias/logo.png" class="logo-img" alt="LOGO">
                    
                    <span class="logo-span">沙漠之狐</span>
                </a>
            </div>
            

<a href="#" data-target="mobile-nav" class="sidenav-trigger button-collapse"><i class="fas fa-bars"></i></a>
<ul class="right nav-menu">
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/" class="waves-effect waves-light">
      
      <i class="fas fa-home" style="zoom: 0.6;"></i>
      
      <span>首页</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/tags" class="waves-effect waves-light">
      
      <i class="fas fa-tags" style="zoom: 0.6;"></i>
      
      <span>标签</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/categories" class="waves-effect waves-light">
      
      <i class="fas fa-bookmark" style="zoom: 0.6;"></i>
      
      <span>分类</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/archives" class="waves-effect waves-light">
      
      <i class="fas fa-archive" style="zoom: 0.6;"></i>
      
      <span>归档</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/about" class="waves-effect waves-light">
      
      <i class="fas fa-user-circle" style="zoom: 0.6;"></i>
      
      <span>关于</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/contact" class="waves-effect waves-light">
      
      <i class="fas fa-comments" style="zoom: 0.6;"></i>
      
      <span>联系人</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/friends" class="waves-effect waves-light">
      
      <i class="fas fa-address-book" style="zoom: 0.6;"></i>
      
      <span>链接</span>
    </a>
    
  </li>
  
  <li>
    <a href="#searchModal" class="modal-trigger waves-effect waves-light">
      <i id="searchIcon" class="fas fa-search" title="搜索" style="zoom: 0.85;"></i>
    </a>
  </li>
  <li>
    <a href="javascript:;" class="waves-effect waves-light" onclick="switchNightMode()" title="深色/浅色模式" >
      <i id="sum-moon-icon" class="fas fa-sun" style="zoom: 0.85;"></i>
    </a>
  </li>
</ul>


<div id="mobile-nav" class="side-nav sidenav">

    <div class="mobile-head bg-color">
        
        <img src="/medias/logo.png" class="logo-img circle responsive-img">
        
        <div class="logo-name">沙漠之狐</div>
        <div class="logo-desc">
            
            有什么胜利可言，挺住意味着一切！
            
        </div>
    </div>

    <ul class="menu-list mobile-menu-list">
        
        <li class="m-nav-item">
	  
		<a href="/" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-home"></i>
			
			首页
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/tags" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-tags"></i>
			
			标签
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/categories" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-bookmark"></i>
			
			分类
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/archives" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-archive"></i>
			
			归档
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/about" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-user-circle"></i>
			
			关于
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/contact" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-comments"></i>
			
			联系人
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/friends" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-address-book"></i>
			
			链接
		</a>
          
        </li>
        
        
    </ul>
</div>


        </div>

        
    </nav>

</header>

    



<div class="bg-cover pd-header post-cover" style="background-image: url('https://statics.sh1a.qingstor.com/2018/11/13/java8-1.jpg')">
    <div class="container" style="right: 0px;left: 0px;">
        <div class="row">
            <div class="col s12 m12 l12">
                <div class="brand">
                    <h1 class="description center-align post-title">Java基础知识大纲</h1>
                </div>
            </div>
        </div>
    </div>
</div>




<main class="post-container content">

    
    <div class="row">
    <div id="main-content" class="col s12 m12 l9">
        <!-- 文章内容详情 -->
<div id="artDetail">
    <div class="card">
        <div class="card-content article-info">
            <div class="row tag-cate">
                <div class="col s7">
                    
                    <div class="article-tag">
                        
                            <a href="/tags/java/">
                                <span class="chip bg-color">java</span>
                            </a>
                        
                    </div>
                    
                </div>
                <div class="col s5 right-align">
                    
                    <div class="post-cate">
                        <i class="fas fa-bookmark fa-fw icon-category"></i>
                        
                            <a href="/categories/%E5%90%8E%E7%AB%AF/" class="post-category">
                                后端
                            </a>
                        
                    </div>
                    
                </div>
            </div>

            <div class="post-info">
                
                <div class="post-date info-break-policy">
                    <i class="far fa-calendar-minus fa-fw"></i>发布日期:&nbsp;&nbsp;
                    2023-11-21
                </div>
                

                
                <div class="post-date info-break-policy">
                    <i class="far fa-calendar-check fa-fw"></i>更新日期:&nbsp;&nbsp;
                    2023-11-23
                </div>
                

                
                <div class="info-break-policy">
                    <i class="far fa-file-word fa-fw"></i>文章字数:&nbsp;&nbsp;
                    27.5k
                </div>
                

                

                
                    <div id="busuanzi_container_page_pv" class="info-break-policy">
                        <i class="far fa-eye fa-fw"></i>阅读次数:&nbsp;&nbsp;
                        <span id="busuanzi_value_page_pv"></span>
                    </div>
				
            </div>
        </div>
        <hr class="clearfix">

        
        <!-- 是否加载使用自带的 prismjs. -->
        <link rel="stylesheet" href="/libs/prism/prism.min.css">
        

        

        <div class="card-content article-card-content">
            <div id="articleContent">
                <h2 id="Java基础知识大纲"><a href="#Java基础知识大纲" class="headerlink" title="Java基础知识大纲"></a>Java基础知识大纲</h2><h3 id="一-java基础问题"><a href="#一-java基础问题" class="headerlink" title="一.java基础问题"></a>一.java基础问题</h3><h4 id="1-Arraylist-原理以及特性"><a href="#1-Arraylist-原理以及特性" class="headerlink" title="1.Arraylist 原理以及特性"></a>1.Arraylist 原理以及特性</h4><p><code>ArrayList</code> 是 Java 中的一个动态数组实现，它属于 Java Collections Framework 的一部分。以下是关于 <code>ArrayList</code> 的一些原理和特性：</p>
<h5 id="1-1-底层实现原理："><a href="#1-1-底层实现原理：" class="headerlink" title="1.1 底层实现原理："></a>1.1 <strong>底层实现原理：</strong></h5><ul>
<li><code>ArrayList</code> 的底层是基于数组实现的，它通过一个动态数组来存储元素。</li>
<li>当数组容量不足以容纳新的元素时，<code>ArrayList</code> 会自动增加容量，通常是当前容量的 1.5 倍。</li>
</ul>
<h5 id="1-2-动态增长："><a href="#1-2-动态增长：" class="headerlink" title="1.2 动态增长："></a>1.2 <strong>动态增长：</strong></h5><ul>
<li><code>ArrayList</code> 具有动态增长的能力，因此可以根据需要自动调整大小。</li>
<li>这使得 <code>ArrayList</code> 在元素数量不断增加的情况下表现较好。</li>
</ul>
<h5 id="1-3-随机访问："><a href="#1-3-随机访问：" class="headerlink" title="1.3  随机访问："></a>1.3  <strong>随机访问：</strong></h5><ul>
<li><code>ArrayList</code> 允许通过索引进行快速的随机访问，因为底层是数组，可以直接通过索引定位元素。</li>
</ul>
<h5 id="1-4-实现了List接口："><a href="#1-4-实现了List接口：" class="headerlink" title="1.4 实现了List接口："></a>1.4 <strong>实现了List接口：</strong></h5><ul>
<li><code>ArrayList</code> 实现了 <code>List</code> 接口，因此支持有序的元素集合，并且允许包含重复元素。</li>
</ul>
<h5 id="1-5-可变大小："><a href="#1-5-可变大小：" class="headerlink" title="1.5 可变大小："></a>1.5 <strong>可变大小：</strong></h5><ul>
<li>与传统数组不同，<code>ArrayList</code> 的大小是可变的，可以根据需要进行动态调整。</li>
</ul>
<h5 id="1-6-支持泛型："><a href="#1-6-支持泛型：" class="headerlink" title="1.6 支持泛型："></a>1.6 <strong>支持泛型：</strong></h5><ul>
<li><code>ArrayList</code> 支持泛型，因此可以在编译时提供类型安全性。</li>
</ul>
<h5 id="1-7-迭代器："><a href="#1-7-迭代器：" class="headerlink" title="1.7 迭代器："></a>1.7 <strong>迭代器：</strong></h5><ul>
<li><code>ArrayList</code> 提供了迭代器，可以通过迭代器遍历集合中的元素。</li>
</ul>
<h5 id="1-8-不是线程安全的："><a href="#1-8-不是线程安全的：" class="headerlink" title="1.8 不是线程安全的："></a>1.8 <strong>不是线程安全的：</strong></h5><ul>
<li><code>ArrayList</code> 不是线程安全的，如果有多个线程同时访问一个 <code>ArrayList</code> 实例，并且至少有一个线程修改了该 <code>ArrayList</code>，那么它必须保持外部同步。</li>
</ul>
<h5 id="1-9-性能特性："><a href="#1-9-性能特性：" class="headerlink" title="1.9 性能特性："></a>1.9 <strong>性能特性：</strong></h5><ul>
<li>由于 <code>ArrayList</code> 支持随机访问，因此适合读取操作。但是，在中间插入或删除元素时可能会比较耗时，因为需要移动元素。</li>
</ul>
<h5 id="1-10-自动装箱："><a href="#1-10-自动装箱：" class="headerlink" title="1.10 自动装箱："></a>1.10 <strong>自动装箱：</strong></h5><ul>
<li>由于 <code>ArrayList</code> 存储的是对象，如果存储基本数据类型，会自动进行装箱和拆箱操作。</li>
</ul>
<p>总体而言，<code>ArrayList</code> 是一个灵活、方便的集合类，适用于大多数场景，但在某些特殊情况下，可能需要考虑其他数据结构的使用，比如 <code>LinkedList</code> 或 <code>HashSet</code>，具体取决于使用场景和需求。</p>
<h4 id="2-Hashmap-原理"><a href="#2-Hashmap-原理" class="headerlink" title="2. Hashmap 原理"></a>2. Hashmap 原理</h4><p><code>HashMap</code> 是 Java 中常用的数据结构之一，它实现了 <code>Map</code> 接口，用于存储键值对。以下是关于 <code>HashMap</code> 的一些原理：</p>
<h5 id="2-1-底层数据结构："><a href="#2-1-底层数据结构：" class="headerlink" title="2.1 底层数据结构："></a>2.1 <strong>底层数据结构：</strong></h5><ul>
<li><code>HashMap</code> 使用数组和链表（或红黑树）的组合来实现。</li>
<li>数组用于存储桶（buckets），每个桶是一个链表（或红黑树）的头部。</li>
</ul>
<h5 id="2-2-哈希函数："><a href="#2-2-哈希函数：" class="headerlink" title="2.2 哈希函数："></a>2.2 <strong>哈希函数：</strong></h5><ul>
<li>当我们将键值对放入 <code>HashMap</code> 时，首先会根据键的哈希码计算出一个哈希值。</li>
<li>这个哈希值用于确定该键值对在数组中的存储位置（桶）。</li>
</ul>
<h5 id="2-3-解决哈希冲突："><a href="#2-3-解决哈希冲突：" class="headerlink" title="2.3 解决哈希冲突："></a>2.3 <strong>解决哈希冲突：</strong></h5><ul>
<li>不同的键可能有相同的哈希值，这就是哈希冲突。<code>HashMap</code> 使用链表（或红黑树）来解决冲突。</li>
<li>如果两个键具有相同的哈希值，它们会被放入同一个桶中，形成一个链表。</li>
<li>当链表的长度达到一定阈值时，链表会转换成红黑树，以提高查找效率。</li>
</ul>
<h5 id="2-4-扩容："><a href="#2-4-扩容：" class="headerlink" title="2.4 扩容："></a>2.4 <strong>扩容：</strong></h5><ul>
<li>当 <code>HashMap</code> 中的元素数量超过容量乘以加载因子时，<code>HashMap</code> 会进行扩容。</li>
<li>扩容会重新计算哈希值，并重新分配到新的更大的桶数组中。</li>
</ul>
<h5 id="2-5-加载因子："><a href="#2-5-加载因子：" class="headerlink" title="2.5 加载因子："></a>2.5 <strong>加载因子：</strong></h5><ul>
<li>加载因子是一个用于衡量容器满的程度的参数，它的默认值为 0.75。</li>
<li>达到加载因子时，<code>HashMap</code> 会自动扩容，以保持其性能。</li>
</ul>
<h5 id="2-6-迭代顺序："><a href="#2-6-迭代顺序：" class="headerlink" title="2.6 迭代顺序："></a>2.6 <strong>迭代顺序：</strong></h5><ul>
<li><code>HashMap</code> 的迭代顺序不是严格按照插入顺序或者哈希值的顺序。</li>
<li>在 Java 8 之后，<code>HashMap</code> 在实现中引入了红黑树，导致元素的遍历顺序可能不同于插入顺序。</li>
</ul>
<h5 id="2-7-线程不安全："><a href="#2-7-线程不安全：" class="headerlink" title="2.7 线程不安全："></a>2.7 <strong>线程不安全：</strong></h5><ul>
<li><code>HashMap</code> 不是线程安全的，如果有多个线程同时访问一个 <code>HashMap</code> 实例，并且至少有一个线程修改了该 <code>HashMap</code>，那么它必须保持外部同步。</li>
</ul>
<h5 id="2-8-性能优势："><a href="#2-8-性能优势：" class="headerlink" title="2.8 性能优势："></a>2.8 <strong>性能优势：</strong></h5><ul>
<li>在良好的散列函数和适当的容量大小下，<code>HashMap</code> 具有常数时间的查找复杂度，因此在大多数情况下，它提供了高效的存储和检索性能。</li>
</ul>
<p><code>HashMap</code> 是一个常见的数据结构，用于快速检索和存储键值对。然而，在多线程环境中，需要考虑线程安全性，可以考虑使用 <code>ConcurrentHashMap</code> 或者在外部进行同步控制。</p>
<h4 id="3-set数据结构"><a href="#3-set数据结构" class="headerlink" title="3. set数据结构"></a>3. set数据结构</h4><h5 id="3-1-HashSet"><a href="#3-1-HashSet" class="headerlink" title="3.1 HashSet:"></a>3.1 <strong>HashSet:</strong></h5><ul>
<li><strong>原理：</strong> <code>HashSet</code> 基于哈希表实现，使用哈希函数将元素映射到数组索引上。它通过一个数组和链表（在Java 8之后，链表可能会转换成红黑树）的组合来存储元素。哈希表的插入、删除和查找操作具有常数级别的时间复杂度。</li>
<li><strong>应用场景：</strong> <ul>
<li>当你需要一个无序的、不允许重复元素的集合。</li>
<li>当你对性能要求较高，因为 <code>HashSet</code> 提供了快速的插入、删除和查找操作。</li>
</ul>
</li>
</ul>
<h5 id="3-2-LinkedHashSet"><a href="#3-2-LinkedHashSet" class="headerlink" title="3.2 LinkedHashSet:"></a>3.2 <strong>LinkedHashSet:</strong></h5><ul>
<li><strong>原理：</strong> <code>LinkedHashSet</code> 在 <code>HashSet</code> 的基础上使用链表维护元素的插入顺序。它继承自 <code>HashSet</code>，所以也是基于哈希表实现的，但额外维护了一个链表来保持插入的顺序。</li>
<li><strong>应用场景：</strong> <ul>
<li>当你需要一个有序的、不允许重复元素的集合，且需要快速地按照插入顺序进行迭代。</li>
<li>当你的应用场景需要综合考虑插入顺序和快速查找时。</li>
</ul>
</li>
</ul>
<h5 id="3-3-TreeSet"><a href="#3-3-TreeSet" class="headerlink" title="3.3 TreeSet:"></a>3.3 <strong>TreeSet:</strong></h5><ul>
<li><strong>原理：</strong> <code>TreeSet</code> 基于红黑树实现，保持了元素的有序性。红黑树是一种自平衡的二叉查找树，确保元素按照升序或降序排列。</li>
<li><strong>应用场景：</strong> <ul>
<li>当你需要一个有序的、不允许重复元素的集合，且需要按照自定义顺序进行排序。</li>
<li>当你对元素的自然排序或者提供的比较器的性能要求较高时。</li>
</ul>
</li>
</ul>
<h5 id="3-4-应用场景小结："><a href="#3-4-应用场景小结：" class="headerlink" title="3.4 应用场景小结："></a>3.4 <strong>应用场景小结：</strong></h5><ul>
<li><strong>通用场景：</strong> 如果只需要一个无序集合，而不关心元素的顺序，通常选择 <code>HashSet</code>，因为它提供了更好的性能。</li>
<li><strong>按插入顺序：</strong> 如果需要保持元素的插入顺序，可以选择 <code>LinkedHashSet</code>。</li>
<li><strong>按自然顺序或自定义排序：</strong> 如果需要一个有序集合，并且按照元素的自然顺序或者提供的比较器进行排序，可以选择 <code>TreeSet</code>。</li>
</ul>
<p>选择适当的 <code>Set</code> 实现取决于具体的业务需求和性能要求。</p>
<h3 id="二-Jpa基础知识"><a href="#二-Jpa基础知识" class="headerlink" title="二.Jpa基础知识"></a>二.Jpa基础知识</h3><p>Java Persistence API（JPA）是一种Java EE和Java SE的规范，用于通过对象-关系映射（ORM）将Java对象映射到关系数据库。以下是关于JPA的一些基础知识：</p>
<h4 id="1-实体（Entity）："><a href="#1-实体（Entity）：" class="headerlink" title="1. 实体（Entity）："></a>1. <strong>实体（Entity）：</strong></h4><ul>
<li>在JPA中，实体是指一个简单的Java对象，它映射到数据库中的表。实体类使用 <code>@Entity</code> 注解进行标识。</li>
</ul>
   <pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@Entity</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Employee</span> <span class="token punctuation">{</span>
    <span class="token comment">// 实体类的属性和对应数据库表的字段</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<h4 id="2-主键（Primary-Key）："><a href="#2-主键（Primary-Key）：" class="headerlink" title="2. 主键（Primary Key）："></a>2. <strong>主键（Primary Key）：</strong></h4><ul>
<li>实体类需要指定一个主键字段，可以使用 <code>@Id</code> 注解标识。主键可以是简单类型，也可以是嵌入式对象。</li>
</ul>
   <pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@Entity</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Employee</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Id</span>
    <span class="token keyword">private</span> <span class="token class-name">Long</span> id<span class="token punctuation">;</span>
    <span class="token comment">// 其他属性和方法</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h4 id="3-映射关系（Mapping-Relationships）："><a href="#3-映射关系（Mapping-Relationships）：" class="headerlink" title="3. 映射关系（Mapping Relationships）："></a>3. <strong>映射关系（Mapping Relationships）：</strong></h4><ul>
<li>JPA支持在实体之间建立关系，包括一对一、一对多、多对一和多对多关系。可以使用 <code>@OneToOne</code>、<code>@OneToMany</code>、<code>@ManyToOne</code> 和 <code>@ManyToMany</code> 等注解来指定关系。</li>
</ul>
   <pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@Entity</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Department</span> <span class="token punctuation">{</span>
    <span class="token comment">// 一对多关系</span>
    <span class="token annotation punctuation">@OneToMany</span><span class="token punctuation">(</span>mappedBy <span class="token operator">=</span> <span class="token string">"department"</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Employee</span><span class="token punctuation">&gt;</span></span> employees<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token annotation punctuation">@Entity</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Employee</span> <span class="token punctuation">{</span>
    <span class="token comment">// 多对一关系</span>
    <span class="token annotation punctuation">@ManyToOne</span>
    <span class="token keyword">private</span> <span class="token class-name">Department</span> department<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h4 id="4-持久性上下文（Persistence-Context）："><a href="#4-持久性上下文（Persistence-Context）：" class="headerlink" title="4. 持久性上下文（Persistence Context）："></a>4. <strong>持久性上下文（Persistence Context）：</strong></h4><ul>
<li>持久性上下文是一个在应用程序执行期间，用于管理实体的上下文。它负责实体的状态变更和与数据库的同步。</li>
</ul>
<h4 id="5-EntityManager："><a href="#5-EntityManager：" class="headerlink" title="5. EntityManager："></a>5. <strong>EntityManager：</strong></h4><ul>
<li><code>EntityManager</code> 是JPA中的核心接口之一，用于执行实体管理操作，如保存、更新、删除和查询实体。</li>
</ul>
   <pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@PersistenceContext</span>
<span class="token keyword">private</span> <span class="token class-name">EntityManager</span> entityManager<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<h4 id="6-查询语言（JPQL）："><a href="#6-查询语言（JPQL）：" class="headerlink" title="6. 查询语言（JPQL）："></a>6. <strong>查询语言（JPQL）：</strong></h4><ul>
<li>JPQL（Java Persistence Query Language）是一种基于对象模型的查询语言，用于查询实体。它类似于SQL，但是操作的是实体对象而不是数据库表。</li>
</ul>
   <pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token class-name">TypedQuery</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Employee</span><span class="token punctuation">&gt;</span></span> query <span class="token operator">=</span> entityManager<span class="token punctuation">.</span><span class="token function">createQuery</span><span class="token punctuation">(</span>
    <span class="token string">"SELECT e FROM Employee e WHERE e.department.name = :deptName"</span><span class="token punctuation">,</span> <span class="token class-name">Employee</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
query<span class="token punctuation">.</span><span class="token function">setParameter</span><span class="token punctuation">(</span><span class="token string">"deptName"</span><span class="token punctuation">,</span> <span class="token string">"IT"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Employee</span><span class="token punctuation">&gt;</span></span> resultList <span class="token operator">=</span> query<span class="token punctuation">.</span><span class="token function">getResultList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<h4 id="7-事务管理："><a href="#7-事务管理：" class="headerlink" title="7. 事务管理："></a>7. <strong>事务管理：</strong></h4><ul>
<li>JPA通常与事务结合使用，以确保数据库操作的一致性。可以使用 <code>@Transactional</code> 注解或者在编程中通过 <code>EntityTransaction</code> 来管理事务。</li>
</ul>
   <pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@Transactional</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">saveEmployee</span><span class="token punctuation">(</span><span class="token class-name">Employee</span> employee<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    entityManager<span class="token punctuation">.</span><span class="token function">persist</span><span class="token punctuation">(</span>employee<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<h4 id="8-配置文件（persistence-xml）："><a href="#8-配置文件（persistence-xml）：" class="headerlink" title="8. 配置文件（persistence.xml）："></a>8. <strong>配置文件（persistence.xml）：</strong></h4><ul>
<li>JPA配置文件是 <code>persistence.xml</code>，其中定义了数据源、实体类、JPA提供商等信息。</li>
</ul>
   <pre class="line-numbers language-markup" data-language="markup"><code class="language-markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>persistence-unit</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>myPersistenceUnit<span class="token punctuation">"</span></span> <span class="token attr-name">transaction-type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>RESOURCE_LOCAL<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>class</span><span class="token punctuation">&gt;</span></span>com.example.Employee<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>class</span><span class="token punctuation">&gt;</span></span>
    <span class="token comment">&lt;!-- 其他配置 --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>persistence-unit</span><span class="token punctuation">&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<p>JPA提供了一种方便的方式来进行对象-关系映射，简化了数据库操作的过程。上述介绍是JPA的一些基础概念，实际使用中还涉及到更多高级特性和配置。</p>
<h4 id="9-jpa整合应用springboot："><a href="#9-jpa整合应用springboot：" class="headerlink" title="9. jpa整合应用springboot："></a>9. jpa整合应用springboot：</h4><p>在Spring Boot中使用JPA通常涉及以下步骤：</p>
<h5 id="9-1-添加依赖："><a href="#9-1-添加依赖：" class="headerlink" title="9.1. 添加依赖："></a>9.1. <strong>添加依赖：</strong></h5><p>确保在<code>pom.xml</code>（如果使用Maven）或<code>build.gradle</code>（如果使用Gradle）中添加Spring Boot和JPA的依赖。</p>
<pre class="line-numbers language-markup" data-language="markup"><code class="language-markup"><span class="token comment">&lt;!-- Maven 依赖 --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-boot-starter-data-jpa<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>

<span class="token comment">&lt;!-- 如果使用Hibernate作为JPA提供商 --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.hibernate<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>hibernate-core<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h5 id="9-2-配置数据源："><a href="#9-2-配置数据源：" class="headerlink" title="9.2. 配置数据源："></a>9.2. <strong>配置数据源：</strong></h5><p>在<code>application.properties</code>或<code>application.yml</code>中配置数据库连接信息。</p>
<pre class="line-numbers language-properties" data-language="properties"><code class="language-properties"><span class="token key attr-name">spring.datasource.url</span><span class="token punctuation">=</span><span class="token value attr-value">jdbc:mysql://localhost:3306/your_database</span>
<span class="token key attr-name">spring.datasource.username</span><span class="token punctuation">=</span><span class="token value attr-value">your_username</span>
<span class="token key attr-name">spring.datasource.password</span><span class="token punctuation">=</span><span class="token value attr-value">your_password</span>
<span class="token key attr-name">spring.datasource.driver-class-name</span><span class="token punctuation">=</span><span class="token value attr-value">com.mysql.cj.jdbc.Driver</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<h5 id="9-3-定义实体类："><a href="#9-3-定义实体类：" class="headerlink" title="9.3. 定义实体类："></a>9.3. <strong>定义实体类：</strong></h5><p>创建JPA实体类，并使用<code>@Entity</code>和<code>@Id</code>等注解标识实体和主键。</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@Entity</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Employee</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Id</span>
    <span class="token annotation punctuation">@GeneratedValue</span><span class="token punctuation">(</span>strategy <span class="token operator">=</span> <span class="token class-name">GenerationType</span><span class="token punctuation">.</span><span class="token constant">IDENTITY</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">Long</span> id<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> name<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> department<span class="token punctuation">;</span>
    <span class="token comment">// getters and setters</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h5 id="9-4-创建Repository接口："><a href="#9-4-创建Repository接口：" class="headerlink" title="9.4. 创建Repository接口："></a>9.4. <strong>创建Repository接口：</strong></h5><p>创建一个继承自<code>JpaRepository</code>的接口，它会提供一些基本的CRUD操作，你也可以自定义查询方法。</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">EmployeeRepository</span> <span class="token keyword">extends</span> <span class="token class-name">JpaRepository</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Employee</span><span class="token punctuation">,</span> <span class="token class-name">Long</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">{</span>
    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Employee</span><span class="token punctuation">&gt;</span></span> <span class="token function">findByDepartment</span><span class="token punctuation">(</span><span class="token class-name">String</span> department<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<h5 id="9-5-使用Repository："><a href="#9-5-使用Repository：" class="headerlink" title="9.5. 使用Repository："></a>9.5. <strong>使用Repository：</strong></h5><p>在你的服务类或控制器中注入<code>EmployeeRepository</code>，然后使用它进行数据库操作。</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@Service</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">EmployeeService</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Autowired</span>
    <span class="token keyword">private</span> <span class="token class-name">EmployeeRepository</span> employeeRepository<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Employee</span><span class="token punctuation">&gt;</span></span> <span class="token function">getEmployeesByDepartment</span><span class="token punctuation">(</span><span class="token class-name">String</span> department<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> employeeRepository<span class="token punctuation">.</span><span class="token function">findByDepartment</span><span class="token punctuation">(</span>department<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token class-name">Employee</span> <span class="token function">saveEmployee</span><span class="token punctuation">(</span><span class="token class-name">Employee</span> employee<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> employeeRepository<span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span>employee<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h5 id="9-6-启用JPA："><a href="#9-6-启用JPA：" class="headerlink" title="9.6. 启用JPA："></a>9.6. <strong>启用JPA：</strong></h5><p>确保在主应用程序类上添加<code>@SpringBootApplication</code>注解，并在需要启用JPA的地方添加<code>@EnableJpaRepositories</code>注解。</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@SpringBootApplication</span>
<span class="token annotation punctuation">@EnableJpaRepositories</span><span class="token punctuation">(</span>basePackages <span class="token operator">=</span> <span class="token string">"com.example.repository"</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">YourApplication</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">SpringApplication</span><span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token class-name">YourApplication</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> args<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h5 id="9-7-其他配置（可选）："><a href="#9-7-其他配置（可选）：" class="headerlink" title="9.7. 其他配置（可选）："></a>9.7. <strong>其他配置（可选）：</strong></h5><p>根据需要，你还可以进行其他JPA和Hibernate的配置，例如配置文件<code>persistence.xml</code>（如果需要自定义JPA配置）或者定义Hibernate方言等。</p>
<p>这些步骤基本上覆盖了在Spring Boot中使用JPA的基本配置和使用方法。通过这些步骤，你可以轻松地进行数据库操作而无需写过多的SQL语句。</p>
<h3 id="三-Mybatis-Plus基础知识"><a href="#三-Mybatis-Plus基础知识" class="headerlink" title="三.Mybatis-Plus基础知识"></a>三.Mybatis-Plus基础知识</h3><p>MyBatis-Plus是基于MyBatis的增强工具包，提供了一些增强功能和简化开发的特性。以下是MyBatis-Plus的一些基础知识：</p>
<h4 id="1-添加依赖："><a href="#1-添加依赖：" class="headerlink" title="1. 添加依赖："></a>1. <strong>添加依赖：</strong></h4><p>在<code>pom.xml</code>（如果使用Maven）或<code>build.gradle</code>（如果使用Gradle）中添加MyBatis-Plus的依赖。</p>
<pre class="line-numbers language-markup" data-language="markup"><code class="language-markup"><span class="token comment">&lt;!-- Maven 依赖 --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.baomidou<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>mybatis-plus-boot-starter<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>最新版本<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h4 id="2-配置数据源："><a href="#2-配置数据源：" class="headerlink" title="2. 配置数据源："></a>2. <strong>配置数据源：</strong></h4><p>在<code>application.properties</code>或<code>application.yml</code>中配置数据库连接信息，与Spring Boot的配置方式一致。</p>
<pre class="line-numbers language-properties" data-language="properties"><code class="language-properties"><span class="token key attr-name">spring.datasource.url</span><span class="token punctuation">=</span><span class="token value attr-value">jdbc:mysql://localhost:3306/your_database</span>
<span class="token key attr-name">spring.datasource.username</span><span class="token punctuation">=</span><span class="token value attr-value">your_username</span>
<span class="token key attr-name">spring.datasource.password</span><span class="token punctuation">=</span><span class="token value attr-value">your_password</span>
<span class="token key attr-name">spring.datasource.driver-class-name</span><span class="token punctuation">=</span><span class="token value attr-value">com.mysql.cj.jdbc.Driver</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<h4 id="3-定义实体类："><a href="#3-定义实体类：" class="headerlink" title="3. 定义实体类："></a>3. <strong>定义实体类：</strong></h4><p>创建与数据库表对应的实体类，与MyBatis一样，但MyBatis-Plus提供了一些注解简化操作。</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>baomidou<span class="token punctuation">.</span>mybatisplus<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">TableName</span></span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@TableName</span><span class="token punctuation">(</span><span class="token string">"employee"</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Employee</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token class-name">Long</span> id<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> name<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> department<span class="token punctuation">;</span>
    <span class="token comment">// getters and setters</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h4 id="4-继承BaseMapper："><a href="#4-继承BaseMapper：" class="headerlink" title="4. 继承BaseMapper："></a>4. <strong>继承BaseMapper：</strong></h4><p>在DAO接口中继承<code>BaseMapper</code>接口，MyBatis-Plus会自动实现通用的CRUD操作。</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">EmployeeMapper</span> <span class="token keyword">extends</span> <span class="token class-name">BaseMapper</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Employee</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">{</span>
    <span class="token comment">// 可以添加一些自定义的查询方法</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<h4 id="5-使用Service："><a href="#5-使用Service：" class="headerlink" title="5. 使用Service："></a>5. <strong>使用Service：</strong></h4><p>在Service中注入<code>EmployeeMapper</code>，并使用其提供的方法进行数据库操作。</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@Service</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">EmployeeService</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Autowired</span>
    <span class="token keyword">private</span> <span class="token class-name">EmployeeMapper</span> employeeMapper<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Employee</span><span class="token punctuation">&gt;</span></span> <span class="token function">getAllEmployees</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> employeeMapper<span class="token punctuation">.</span><span class="token function">selectList</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token class-name">Employee</span> <span class="token function">getEmployeeById</span><span class="token punctuation">(</span><span class="token class-name">Long</span> id<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> employeeMapper<span class="token punctuation">.</span><span class="token function">selectById</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">saveEmployee</span><span class="token punctuation">(</span><span class="token class-name">Employee</span> employee<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        employeeMapper<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span>employee<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">updateEmployee</span><span class="token punctuation">(</span><span class="token class-name">Employee</span> employee<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        employeeMapper<span class="token punctuation">.</span><span class="token function">updateById</span><span class="token punctuation">(</span>employee<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">deleteEmployee</span><span class="token punctuation">(</span><span class="token class-name">Long</span> id<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        employeeMapper<span class="token punctuation">.</span><span class="token function">deleteById</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h4 id="6-其他特性："><a href="#6-其他特性：" class="headerlink" title="6. 其他特性："></a>6. <strong>其他特性：</strong></h4><p>MyBatis-Plus还提供了一些其他特性，如条件构造器、分页查询、逻辑删除、自动填充等，可以根据实际需求选择使用。</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">// 示例：条件构造器</span>
<span class="token class-name">QueryWrapper</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Employee</span><span class="token punctuation">&gt;</span></span> queryWrapper <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">QueryWrapper</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
queryWrapper<span class="token punctuation">.</span><span class="token function">eq</span><span class="token punctuation">(</span><span class="token string">"department"</span><span class="token punctuation">,</span> <span class="token string">"IT"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">like</span><span class="token punctuation">(</span><span class="token string">"name"</span><span class="token punctuation">,</span> <span class="token string">"John"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Employee</span><span class="token punctuation">&gt;</span></span> employees <span class="token operator">=</span> employeeMapper<span class="token punctuation">.</span><span class="token function">selectList</span><span class="token punctuation">(</span>queryWrapper<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h4 id="7-配置（可选）："><a href="#7-配置（可选）：" class="headerlink" title="7. 配置（可选）："></a>7. <strong>配置（可选）：</strong></h4><p>根据需要，你可以在<code>application.properties</code>或<code>application.yml</code>中添加一些MyBatis-Plus的配置，例如分页插件的配置。</p>
<pre class="line-numbers language-properties" data-language="properties"><code class="language-properties"><span class="token comment"># 分页插件配置</span>
<span class="token key attr-name">mybatis-plus.configuration.mapper-locations</span><span class="token punctuation">=</span><span class="token value attr-value">classpath:mapper/**/*.xml</span>
<span class="token key attr-name">mybatis-plus.pagehelper.helper-dialect</span><span class="token punctuation">=</span><span class="token value attr-value">mysql</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<p>通过上述配置和基本使用，你可以轻松地利用MyBatis-Plus进行数据库操作，而无需手写过多的SQL语句。 MyBatis-Plus的文档提供了更详细的信息，可以根据实际需求进行更高级的配置和使用。</p>
<h4 id="8-Mybatis-Plus-xml配置文件标签用法详情"><a href="#8-Mybatis-Plus-xml配置文件标签用法详情" class="headerlink" title="8. Mybatis-Plus xml配置文件标签用法详情"></a>8. Mybatis-Plus xml配置文件标签用法详情</h4><p>MyBatis-Plus中的XML文件主要用于配置映射关系、SQL语句等信息，它扩展了MyBatis的XML配置文件，提供了一些用于简化和增强配置的标签。以下是一些常用的XML标签及其用法：</p>
<h5 id="8-1-："><a href="#8-1-：" class="headerlink" title="8.1. <resultMap>："></a>8.1. <strong><code>&lt;resultMap&gt;</code>：</strong></h5><p>用于映射查询结果到实体类的字段。</p>
<pre class="line-numbers language-markup" data-language="markup"><code class="language-markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>resultMap</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>userResultMap<span class="token punctuation">"</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>User<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>id</span> <span class="token attr-name">property</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>id<span class="token punctuation">"</span></span> <span class="token attr-name">column</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>user_id<span class="token punctuation">"</span></span> <span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>result</span> <span class="token attr-name">property</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>username<span class="token punctuation">"</span></span> <span class="token attr-name">column</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>user_name<span class="token punctuation">"</span></span> <span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>result</span> <span class="token attr-name">property</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>password<span class="token punctuation">"</span></span> <span class="token attr-name">column</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>user_password<span class="token punctuation">"</span></span> <span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>resultMap</span><span class="token punctuation">&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h5 id="8-2-："><a href="#8-2-：" class="headerlink" title="8.2. <select>："></a>8.2. <strong><code>&lt;select&gt;</code>：</strong></h5><p>配置查询语句。</p>
<pre class="line-numbers language-markup" data-language="markup"><code class="language-markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>select</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>selectUserById<span class="token punctuation">"</span></span> <span class="token attr-name">resultMap</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>userResultMap<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
    SELECT * FROM user WHERE user_id = #{id}
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>select</span><span class="token punctuation">&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<h5 id="8-3-："><a href="#8-3-：" class="headerlink" title="8.3. <insert>："></a>8.3. <strong><code>&lt;insert&gt;</code>：</strong></h5><p>配置插入语句。</p>
<pre class="line-numbers language-markup" data-language="markup"><code class="language-markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>insert</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>insertUser<span class="token punctuation">"</span></span> <span class="token attr-name">parameterType</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>User<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
    INSERT INTO user (user_id, user_name, user_password)
    VALUES (#{id}, #{username}, #{password})
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>insert</span><span class="token punctuation">&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<h5 id="8-4-："><a href="#8-4-：" class="headerlink" title="8.4. <update>："></a>8.4. <strong><code>&lt;update&gt;</code>：</strong></h5><p>配置更新语句。</p>
<pre class="line-numbers language-markup" data-language="markup"><code class="language-markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>update</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>updateUser<span class="token punctuation">"</span></span> <span class="token attr-name">parameterType</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>User<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
    UPDATE user SET user_name = #{username}, user_password = #{password}
    WHERE user_id = #{id}
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>update</span><span class="token punctuation">&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<h5 id="8-5-："><a href="#8-5-：" class="headerlink" title="8.5. <delete>："></a>8.5. <strong><code>&lt;delete&gt;</code>：</strong></h5><p>配置删除语句。</p>
<pre class="line-numbers language-markup" data-language="markup"><code class="language-markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>delete</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>deleteUser<span class="token punctuation">"</span></span> <span class="token attr-name">parameterType</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>int<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
    DELETE FROM user WHERE user_id = #{id}
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>delete</span><span class="token punctuation">&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<h5 id="8-6-："><a href="#8-6-：" class="headerlink" title="8.6. <if>："></a>8.6. <strong><code>&lt;if&gt;</code>：</strong></h5><p>用于条件判断，根据条件决定是否拼接SQL片段。</p>
<pre class="line-numbers language-markup" data-language="markup"><code class="language-markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>select</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>selectUsers<span class="token punctuation">"</span></span> <span class="token attr-name">resultMap</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>userResultMap<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
    SELECT * FROM user
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>where</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>if</span> <span class="token attr-name">test</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>username != null<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
            AND user_name = #{username}
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>if</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>if</span> <span class="token attr-name">test</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>password != null<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
            AND user_password = #{password}
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>if</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>where</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>select</span><span class="token punctuation">&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h5 id="8-7-："><a href="#8-7-：" class="headerlink" title="8.7. <foreach>："></a>8.7. <strong><code>&lt;foreach&gt;</code>：</strong></h5><p>用于处理集合类型的参数，循环拼接SQL片段。</p>
<pre class="line-numbers language-markup" data-language="markup"><code class="language-markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>select</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>selectUsersByIdList<span class="token punctuation">"</span></span> <span class="token attr-name">resultMap</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>userResultMap<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
    SELECT * FROM user
    WHERE user_id IN
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>foreach</span> <span class="token attr-name">collection</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>idList<span class="token punctuation">"</span></span> <span class="token attr-name">item</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>id<span class="token punctuation">"</span></span> <span class="token attr-name">open</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>(<span class="token punctuation">"</span></span> <span class="token attr-name">separator</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>,<span class="token punctuation">"</span></span> <span class="token attr-name">close</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>)<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
        #{id}
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>foreach</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>select</span><span class="token punctuation">&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h5 id="8-8-："><a href="#8-8-：" class="headerlink" title="8.8. <sql>："></a>8.8. <strong><code>&lt;sql&gt;</code>：</strong></h5><p>用于定义可重用的SQL片段。</p>
<pre class="line-numbers language-markup" data-language="markup"><code class="language-markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>sql</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>columns<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
    user_id, user_name, user_password
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>sql</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>select</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>selectAllUsers<span class="token punctuation">"</span></span> <span class="token attr-name">resultMap</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>userResultMap<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
    SELECT <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>include</span> <span class="token attr-name">refid</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>columns<span class="token punctuation">"</span></span> <span class="token punctuation">/&gt;</span></span> FROM user
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>select</span><span class="token punctuation">&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h5 id="8-9-、、："><a href="#8-9-、、：" class="headerlink" title="8.9. <choose>、<when>、<otherwise>："></a>8.9. <strong><code>&lt;choose&gt;</code>、<code>&lt;when&gt;</code>、<code>&lt;otherwise&gt;</code>：</strong></h5><p>用于处理多个条件的选择语句。</p>
<pre class="line-numbers language-markup" data-language="markup"><code class="language-markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>select</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>selectUsersByCondition<span class="token punctuation">"</span></span> <span class="token attr-name">resultMap</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>userResultMap<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
    SELECT * FROM user
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>where</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>choose</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>when</span> <span class="token attr-name">test</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>username != null<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
                AND user_name = #{username}
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>when</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>when</span> <span class="token attr-name">test</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>password != null<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
                AND user_password = #{password}
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>when</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>otherwise</span><span class="token punctuation">&gt;</span></span>
                AND 1 = 1
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>otherwise</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>choose</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>where</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>select</span><span class="token punctuation">&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>这些XML标签提供了灵活的配置选项，允许开发者根据具体的需求进行配置。通过合理使用这些标签，可以更好地管理SQL语句和映射关系，提高代码的可维护性。</p>
<h3 id="四-线程"><a href="#四-线程" class="headerlink" title="四. 线程"></a>四. 线程</h3><h4 id="6-线程池有几个参数，如何配置"><a href="#6-线程池有几个参数，如何配置" class="headerlink" title="6.线程池有几个参数，如何配置"></a>6.线程池有几个参数，如何配置</h4><p>线程池是一种用于管理和重用线程的机制，Java中通过<code>Executor</code>框架提供了线程池的实现。线程池的配置通常涉及到一些重要的参数。在Java中，常见的线程池参数有以下几个：</p>
<h5 id="6-1-corePoolSize（核心线程数）："><a href="#6-1-corePoolSize（核心线程数）：" class="headerlink" title="6.1. corePoolSize（核心线程数）："></a>6.1. <strong>corePoolSize（核心线程数）：</strong></h5><ul>
<li>核心线程数是线程池中一直保持活动的线程数量，即使它们处于空闲状态。当有新任务提交时，如果当前线程池中的线程数小于核心线程数，会创建新的线程来执行任务。</li>
<li>核心线程通常会一直存在，除非设置了<code>allowCoreThreadTimeOut</code>。</li>
</ul>
<h5 id="6-2-maximumPoolSize（最大线程数）："><a href="#6-2-maximumPoolSize（最大线程数）：" class="headerlink" title="6.2. maximumPoolSize（最大线程数）："></a>6.2. <strong>maximumPoolSize（最大线程数）：</strong></h5><ul>
<li>最大线程数是线程池中允许的最大线程数量。当线程池中的线程数达到核心线程数时，新任务会放入工作队列（如果队列未满），或者创建新的非核心线程（如果线程数未达到最大线程数）。</li>
</ul>
<h5 id="6-3-keepAliveTime（线程空闲时间）："><a href="#6-3-keepAliveTime（线程空闲时间）：" class="headerlink" title="6.3. keepAliveTime（线程空闲时间）："></a>6.3. <strong>keepAliveTime（线程空闲时间）：</strong></h5><ul>
<li>线程空闲时间是非核心线程在空闲状态下被回收前等待新任务的最长时间。如果设置了<code>allowCoreThreadTimeOut</code>，那么核心线程也会受到这个参数的影响。</li>
</ul>
<h5 id="6-4-unit（时间单位）："><a href="#6-4-unit（时间单位）：" class="headerlink" title="6.4. unit（时间单位）："></a>6.4. <strong>unit（时间单位）：</strong></h5><ul>
<li>用于指定keepAliveTime的时间单位，通常是<code>TimeUnit.SECONDS</code>、<code>TimeUnit.MILLISECONDS</code>等。</li>
</ul>
<h5 id="6-5-workQueue（工作队列）："><a href="#6-5-workQueue（工作队列）：" class="headerlink" title="6.5. workQueue（工作队列）："></a>6.5. <strong>workQueue（工作队列）：</strong></h5><ul>
<li>工作队列是用于保存等待执行任务的队列。当线程池中的线程数达到核心线程数时，新任务会放入工作队列。工作队列可以是不同类型的队列，如<code>LinkedBlockingQueue</code>、<code>ArrayBlockingQueue</code>等。</li>
</ul>
<h5 id="6-6-threadFactory（线程工厂）："><a href="#6-6-threadFactory（线程工厂）：" class="headerlink" title="6.6. threadFactory（线程工厂）："></a>6.6. <strong>threadFactory（线程工厂）：</strong></h5><ul>
<li>用于创建新线程的工厂。可以通过自定义线程工厂来配置线程的一些特性，如线程的命名、优先级等。</li>
</ul>
<h5 id="6-7-handler（拒绝策略）："><a href="#6-7-handler（拒绝策略）：" class="headerlink" title="6.7. handler（拒绝策略）："></a>6.7. <strong>handler（拒绝策略）：</strong></h5><ul>
<li>当工作队列和线程池都满了，且线程池中的线程数达到最大线程数时，采取的拒绝策略。常见的拒绝策略有<code>AbortPolicy</code>（默认，直接抛出异常）、<code>CallerRunsPolicy</code>（使用调用者的线程执行任务）、<code>DiscardPolicy</code>（直接丢弃任务）等。</li>
</ul>
<h5 id="如何配置："><a href="#如何配置：" class="headerlink" title="如何配置："></a>如何配置：</h5><p>可以通过<code>ThreadPoolExecutor</code>的构造函数或者通过<code>Executors.newXXXThreadPool</code>等静态工厂方法来创建线程池，并传入相应的参数进行配置。例如：</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token class-name">ThreadPoolExecutor</span> executor <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ThreadPoolExecutor</span><span class="token punctuation">(</span>
    corePoolSize<span class="token punctuation">,</span>          <span class="token comment">// 核心线程数</span>
    maximumPoolSize<span class="token punctuation">,</span>       <span class="token comment">// 最大线程数</span>
    keepAliveTime<span class="token punctuation">,</span>         <span class="token comment">// 线程空闲时间</span>
    <span class="token class-name">TimeUnit</span><span class="token punctuation">.</span><span class="token constant">SECONDS</span><span class="token punctuation">,</span>       <span class="token comment">// 时间单位</span>
    workQueue<span class="token punctuation">,</span>             <span class="token comment">// 工作队列</span>
    threadFactory<span class="token punctuation">,</span>         <span class="token comment">// 线程工厂</span>
    handler                <span class="token comment">// 拒绝策略</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>另外，Java 5及以上版本提供了<code>Executors.newFixedThreadPool</code>、<code>Executors.newCachedThreadPool</code>等静态工厂方法，这些方法使用了一些默认的参数值，适合一些简单的使用场景。例如：</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token class-name">ExecutorService</span> executor <span class="token operator">=</span> <span class="token class-name">Executors</span><span class="token punctuation">.</span><span class="token function">newFixedThreadPool</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 创建固定大小的线程池</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>在配置线程池时，需要根据具体的应用场景和需求来调整参数，以确保线程池的性能和稳定性。</p>
<h4 id="7-线程与进程的区别"><a href="#7-线程与进程的区别" class="headerlink" title="7.线程与进程的区别"></a>7.线程与进程的区别</h4><p>线程（Thread）和进程（Process）是操作系统中管理执行程序的两个基本概念，它们之间有一些关键的区别：</p>
<h5 id="7-1-定义："><a href="#7-1-定义：" class="headerlink" title="7.1. 定义："></a>7.1. <strong>定义：</strong></h5><ul>
<li><strong>线程：</strong> 线程是一个进程内的独立执行单元，是程序执行流的最小单元。一个进程可以包含多个线程，它们共享同一进程的资源，如内存空间、文件句柄等。</li>
<li><strong>进程：</strong> 进程是一个独立的程序执行单元，拥有独立的内存空间和系统资源。进程是系统分配资源的基本单位。</li>
</ul>
<h5 id="7-2-资源共享："><a href="#7-2-资源共享：" class="headerlink" title="7.2. 资源共享："></a>7.2. <strong>资源共享：</strong></h5><ul>
<li><strong>线程：</strong> 线程属于进程，共享进程的资源。多个线程可以同时访问相同的内存空间和文件，因此线程之间的通信更加方便。</li>
<li><strong>进程：</strong> 进程之间的资源是相互隔离的，每个进程拥有独立的内存空间和系统资源。进程之间通信相对复杂，需要通过进程间通信（IPC）的机制。</li>
</ul>
<h5 id="7-3-开销："><a href="#7-3-开销：" class="headerlink" title="7.3. 开销："></a>7.3. <strong>开销：</strong></h5><ul>
<li><strong>线程：</strong> 线程的创建和销毁比进程轻量级，线程切换的开销相对较小。</li>
<li><strong>进程：</strong> 进程的创建和销毁较为重量级，进程切换的开销相对较大。</li>
</ul>
<h5 id="7-4-并发性："><a href="#7-4-并发性：" class="headerlink" title="7.4. 并发性："></a>7.4. <strong>并发性：</strong></h5><ul>
<li><strong>线程：</strong> 多线程的并发性较高，多个线程可以并行执行，共同完成任务。</li>
<li><strong>进程：</strong> 进程的并发性较低，进程之间相对独立，通常需要通过进程间通信来协调工作。</li>
</ul>
<h5 id="7-5-健壮性："><a href="#7-5-健壮性：" class="headerlink" title="7.5. 健壮性："></a>7.5. <strong>健壮性：</strong></h5><ul>
<li><strong>线程：</strong> 由于线程共享同一进程的资源，一个线程的错误可能影响到整个进程，导致程序崩溃。</li>
<li><strong>进程：</strong> 进程之间相对独立，一个进程的错误不会直接影响其他进程，因此进程的健壮性相对较高。</li>
</ul>
<h5 id="7-6-切换代价："><a href="#7-6-切换代价：" class="headerlink" title="7.6. 切换代价："></a>7.6. <strong>切换代价：</strong></h5><ul>
<li><strong>线程：</strong> 线程切换的代价相对较小，因为线程共享同一地址空间，切换时只需保存寄存器等少量状态。</li>
<li><strong>进程：</strong> 进程切换的代价较大，需要保存和恢复更多的状态信息，包括内存映射、文件描述符等。</li>
</ul>
<h5 id="7-7-通信："><a href="#7-7-通信：" class="headerlink" title="7.7. 通信："></a>7.7. <strong>通信：</strong></h5><ul>
<li><strong>线程：</strong> 线程之间的通信较为简便，可以通过共享内存等方式进行直接通信。</li>
<li><strong>进程：</strong> 进程之间通信相对复杂，需要使用IPC机制，如消息队列、管道、信号等。</li>
</ul>
<p>总体来说，线程和进程都是并发编程的基本单位，各自有优势和适用场景。线程通常用于轻量级的并发任务，而进程通常用于更加独立和复杂的任务。在实际开发中，通常会根据任务的性质和要求来选择使用线程或进程。</p>
<h4 id="8-线程池是怎么用的"><a href="#8-线程池是怎么用的" class="headerlink" title="8.线程池是怎么用的"></a>8.线程池是怎么用的</h4><p>线程池是一种用于管理和重用线程的机制，它通过维护一定数量的线程，根据需要分配任务给这些线程，可以提高线程的利用率、降低线程创建和销毁的开销。在Java中，线程池通常使用<code>Executor</code>框架来实现。以下是使用线程池的基本步骤：</p>
<h5 id="8-1-创建线程池："><a href="#8-1-创建线程池：" class="headerlink" title="8.1. 创建线程池："></a>8.1. 创建线程池：</h5><p>通过<code>Executors</code>类提供的静态工厂方法创建不同类型的线程池，常用的线程池有：</p>
<ul>
<li><code>newFixedThreadPool(int n)</code>：创建一个固定大小的线程池，有固定数量的线程处理任务。</li>
<li><code>newCachedThreadPool()</code>：创建一个可缓存的线程池，线程数根据任务的数量动态调整。</li>
<li><code>newSingleThreadExecutor()</code>：创建一个单线程的线程池，任务按顺序执行。</li>
<li><code>newScheduledThreadPool(int corePoolSize)</code>：创建一个固定大小的线程池，可以执行定时任务和周期性任务。</li>
</ul>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token class-name">ExecutorService</span> executor <span class="token operator">=</span> <span class="token class-name">Executors</span><span class="token punctuation">.</span><span class="token function">newFixedThreadPool</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<h5 id="8-2-提交任务："><a href="#8-2-提交任务：" class="headerlink" title="8.2. 提交任务："></a>8.2. 提交任务：</h5><p>使用<code>submit</code>方法提交任务给线程池。任务可以是<code>Runnable</code>接口的实现类，也可以是<code>Callable</code>接口的实现类。</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java">executor<span class="token punctuation">.</span><span class="token function">submit</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Runnable</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// 执行任务的代码</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>或者使用Lambda表达式：</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java">executor<span class="token punctuation">.</span><span class="token function">submit</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">// 执行任务的代码</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<h5 id="8-3-关闭线程池："><a href="#8-3-关闭线程池：" class="headerlink" title="8.3. 关闭线程池："></a>8.3. 关闭线程池：</h5><p>当不再需要线程池时，应该调用<code>shutdown()</code>方法来关闭线程池。关闭线程池后，将不再接受新的任务，但会等待已经提交的任务执行完成。</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java">executor<span class="token punctuation">.</span><span class="token function">shutdown</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>如果要立即关闭线程池，并尝试停止所有正在执行的任务，可以使用<code>shutdownNow()</code>方法：</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java">executor<span class="token punctuation">.</span><span class="token function">shutdownNow</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<h5 id="8-4-使用Future获取任务结果（可选）："><a href="#8-4-使用Future获取任务结果（可选）：" class="headerlink" title="8.4. 使用Future获取任务结果（可选）："></a>8.4. 使用<code>Future</code>获取任务结果（可选）：</h5><p>如果提交的任务实现了<code>Callable</code>接口，可以通过<code>submit</code>方法的返回值<code>Future</code>来获取任务的执行结果。</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token class-name">Future</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> future <span class="token operator">=</span> executor<span class="token punctuation">.</span><span class="token function">submit</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Callable</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">call</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
        <span class="token comment">// 执行任务的代码，返回结果</span>
        <span class="token keyword">return</span> <span class="token string">"Task Result"</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">try</span> <span class="token punctuation">{</span>
    <span class="token class-name">String</span> result <span class="token operator">=</span> future<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 阻塞等待任务执行完成并获取结果</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">InterruptedException</span> <span class="token operator">|</span> <span class="token class-name">ExecutionException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h5 id="8-5-注意事项："><a href="#8-5-注意事项：" class="headerlink" title="8.5. 注意事项："></a>8.5. 注意事项：</h5><ul>
<li>应根据实际需求选择合适的线程池类型。</li>
<li>使用线程池时应根据任务的性质和规模来配置合适的线程数。</li>
<li>线程池的生命周期应该根据应用程序的生命周期来管理，及时关闭不再需要的线程池。</li>
<li>如果任务的执行时间较短，可以考虑使用<code>newCachedThreadPool</code>，而对于需要长时间运行的任务，可以使用<code>newFixedThreadPool</code>。</li>
<li>在Java 8 及以上版本，推荐使用<code>java.util.concurrent.Executors.newWorkStealingPool()</code>来创建工作窃取线程池，它结合了线程池和工作窃取算法，适用于并行计算场景。</li>
</ul>
<h4 id="9-线程安全性，怎么解决线程安全性"><a href="#9-线程安全性，怎么解决线程安全性" class="headerlink" title="9.线程安全性，怎么解决线程安全性"></a>9.线程安全性，怎么解决线程安全性</h4><p>线程安全性是指在多线程环境下，程序能够正确、可靠地执行，而不会产生不确定的结果或导致数据不一致。在并发编程中，解决线程安全性问题是一个重要的任务。以下是一些常见的手段来解决线程安全性问题：</p>
<h5 id="9-1-互斥锁（Synchronization）："><a href="#9-1-互斥锁（Synchronization）：" class="headerlink" title="9.1. 互斥锁（Synchronization）："></a>9.1. <strong>互斥锁（Synchronization）：</strong></h5><ul>
<li>使用关键字 <code>synchronized</code> 来保护共享资源，确保在同一时刻只有一个线程访问该资源。这可以通过方法级别的同步或使用同步代码块来实现。</li>
</ul>
   <pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">synchronized</span> <span class="token keyword">void</span> <span class="token function">synchronizedMethod</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 线程安全的操作</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

   <pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">synchronizedBlock</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">synchronized</span> <span class="token punctuation">(</span>lockObject<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// 线程安全的操作</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h5 id="9-2-使用线程安全的数据结构："><a href="#9-2-使用线程安全的数据结构：" class="headerlink" title="9.2. 使用线程安全的数据结构："></a>9.2. <strong>使用线程安全的数据结构：</strong></h5><ul>
<li>Java提供了一些线程安全的数据结构，如<code>ConcurrentHashMap</code>、<code>CopyOnWriteArrayList</code>等。这些数据结构内部使用了一些机制来保证多线程访问时的安全性。</li>
</ul>
   <pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> concurrentMap <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ConcurrentHashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> copyOnWriteList <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">CopyOnWriteArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<h5 id="9-3-原子类（Atomic-Classes）："><a href="#9-3-原子类（Atomic-Classes）：" class="headerlink" title="9.3. 原子类（Atomic Classes）："></a>9.3. <strong>原子类（Atomic Classes）：</strong></h5><ul>
<li>使用<code>java.util.concurrent.atomic</code>包提供的原子类，如<code>AtomicInteger</code>、<code>AtomicLong</code>等，可以保证特定操作的原子性。</li>
</ul>
   <pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token class-name">AtomicInteger</span> atomicInteger <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">AtomicInteger</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
atomicInteger<span class="token punctuation">.</span><span class="token function">incrementAndGet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 原子操作</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<h5 id="9-4-使用锁机制："><a href="#9-4-使用锁机制：" class="headerlink" title="9.4. 使用锁机制："></a>9.4. <strong>使用锁机制：</strong></h5><ul>
<li>显式地使用<code>ReentrantLock</code>等锁机制，以便更细粒度地控制对共享资源的访问。</li>
</ul>
   <pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">ReentrantLock</span> lock <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ReentrantLock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">performTask</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    lock<span class="token punctuation">.</span><span class="token function">lock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">try</span> <span class="token punctuation">{</span>
        <span class="token comment">// 线程安全的操作</span>
    <span class="token punctuation">}</span> <span class="token keyword">finally</span> <span class="token punctuation">{</span>
        lock<span class="token punctuation">.</span><span class="token function">unlock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h5 id="9-5-不可变对象："><a href="#9-5-不可变对象：" class="headerlink" title="9.5. 不可变对象："></a>9.5. <strong>不可变对象：</strong></h5><ul>
<li>创建不可变对象，即对象一旦被创建就不能被修改。不可变对象天然是线程安全的。</li>
</ul>
   <pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">final</span> <span class="token keyword">class</span> <span class="token class-name">ImmutableObject</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token keyword">int</span> value<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token class-name">ImmutableObject</span><span class="token punctuation">(</span><span class="token keyword">int</span> value<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>value <span class="token operator">=</span> value<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">getValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> value<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h5 id="9-6-线程局部变量："><a href="#9-6-线程局部变量：" class="headerlink" title="9.6. 线程局部变量："></a>9.6. <strong>线程局部变量：</strong></h5><ul>
<li>使用<code>ThreadLocal</code>来保证每个线程都有自己的变量副本，从而避免共享变量的线程安全问题。</li>
</ul>
   <pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token class-name">ThreadLocal</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">SimpleDateFormat</span><span class="token punctuation">&gt;</span></span> dateFormat <span class="token operator">=</span> <span class="token class-name">ThreadLocal</span><span class="token punctuation">.</span><span class="token function">withInitial</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token keyword">new</span> <span class="token class-name">SimpleDateFormat</span><span class="token punctuation">(</span><span class="token string">"yyyy-MM-dd"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<h5 id="9-7-避免竞态条件（Race-Condition）："><a href="#9-7-避免竞态条件（Race-Condition）：" class="headerlink" title="9.7. 避免竞态条件（Race Condition）："></a>9.7. <strong>避免竞态条件（Race Condition）：</strong></h5><ul>
<li>竞态条件是指在多线程环境下，由于执行顺序不确定而导致程序产生不正确的结果。避免竞态条件可以通过同步、加锁、使用原子操作等手段来确保一组操作的原子性。</li>
</ul>
<h5 id="9-8-注意事项："><a href="#9-8-注意事项：" class="headerlink" title="9.8.注意事项："></a>9.8.注意事项：</h5><ul>
<li>在解决线程安全性问题时，需要考虑性能、可维护性以及是否引入死锁等问题。</li>
<li>避免过度的同步，因为过度同步可能导致性能下降。</li>
<li>在设计并发程序时，考虑尽量减少共享状态，以降低并发编程的复杂度。</li>
</ul>
<h4 id="10-怎么创建线程，方式有几种"><a href="#10-怎么创建线程，方式有几种" class="headerlink" title="10 怎么创建线程，方式有几种"></a>10 怎么创建线程，方式有几种</h4><p>在Java中，创建线程的方式主要有两种：通过继承<code>Thread</code>类和通过实现<code>Runnable</code>接口。此外，在Java 5及以上版本，还引入了更为灵活的<code>Executor</code>框架，以及<code>Callable</code>和<code>Future</code>接口。下面分别详细介绍这几种方式：</p>
<h5 id="10-1-继承-Thread-类："><a href="#10-1-继承-Thread-类：" class="headerlink" title="10.1. 继承 Thread 类："></a>10.1. <strong>继承 <code>Thread</code> 类：</strong></h5><p>通过创建一个继承自<code>Thread</code>类的子类，重写<code>run()</code>方法来定义线程的执行逻辑。</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">class</span> <span class="token class-name">MyThread</span> <span class="token keyword">extends</span> <span class="token class-name">Thread</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// 线程执行的逻辑</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">5</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">currentThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">" Value "</span> <span class="token operator">+</span> i<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ThreadExample</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span> args<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">MyThread</span> thread1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">MyThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">MyThread</span> thread2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">MyThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// 启动线程</span>
        thread1<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        thread2<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h5 id="10-2-实现-Runnable-接口："><a href="#10-2-实现-Runnable-接口：" class="headerlink" title="10.2. 实现 Runnable 接口："></a>10.2. <strong>实现 <code>Runnable</code> 接口：</strong></h5><p>通过创建一个实现了<code>Runnable</code>接口的类，实现<code>run()</code>方法，然后创建<code>Thread</code>对象并将实现了<code>Runnable</code>接口的对象传递给<code>Thread</code>构造函数。</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">class</span> <span class="token class-name">MyRunnable</span> <span class="token keyword">implements</span> <span class="token class-name">Runnable</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// 线程执行的逻辑</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">5</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">currentThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">" Value "</span> <span class="token operator">+</span> i<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">RunnableExample</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span> args<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">Thread</span> thread1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">MyRunnable</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Thread</span> thread2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">MyRunnable</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// 启动线程</span>
        thread1<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        thread2<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h5 id="10-3-使用-Callable-和-Future（Java-5及以上）："><a href="#10-3-使用-Callable-和-Future（Java-5及以上）：" class="headerlink" title="10.3. 使用 Callable 和 Future（Java 5及以上）："></a>10.3. <strong>使用 <code>Callable</code> 和 <code>Future</code>（Java 5及以上）：</strong></h5><p>通过创建一个实现<code>Callable</code>接口的类，使用<code>ExecutorService</code>的<code>submit</code>方法来提交任务，并获得<code>Future</code>对象。</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>concurrent<span class="token punctuation">.</span></span><span class="token class-name">Callable</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>concurrent<span class="token punctuation">.</span></span><span class="token class-name">ExecutorService</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>concurrent<span class="token punctuation">.</span></span><span class="token class-name">Executors</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>concurrent<span class="token punctuation">.</span></span><span class="token class-name">Future</span></span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">MyCallable</span> <span class="token keyword">implements</span> <span class="token class-name">Callable</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">call</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// 线程执行的逻辑</span>
        <span class="token keyword">return</span> <span class="token string">"Task completed"</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">CallableExample</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span> args<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
        <span class="token class-name">ExecutorService</span> executorService <span class="token operator">=</span> <span class="token class-name">Executors</span><span class="token punctuation">.</span><span class="token function">newFixedThreadPool</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Future</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> future <span class="token operator">=</span> executorService<span class="token punctuation">.</span><span class="token function">submit</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">MyCallable</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// 获取线程执行结果</span>
        <span class="token class-name">String</span> result <span class="token operator">=</span> future<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// 关闭线程池</span>
        executorService<span class="token punctuation">.</span><span class="token function">shutdown</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h5 id="10-4-使用-Executor-框架（Java-5及以上）："><a href="#10-4-使用-Executor-框架（Java-5及以上）：" class="headerlink" title="10.4. 使用 Executor 框架（Java 5及以上）："></a>10.4. <strong>使用 <code>Executor</code> 框架（Java 5及以上）：</strong></h5><p><code>Executor</code>框架提供了更高级的线程管理和控制机制，通过使用<code>ExecutorService</code>来提交和管理任务。</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>concurrent<span class="token punctuation">.</span></span><span class="token class-name">ExecutorService</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>concurrent<span class="token punctuation">.</span></span><span class="token class-name">Executors</span></span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">MyRunnable</span> <span class="token keyword">implements</span> <span class="token class-name">Runnable</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// 线程执行的逻辑</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">5</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">currentThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">" Value "</span> <span class="token operator">+</span> i<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ExecutorExample</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span> args<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">ExecutorService</span> executorService <span class="token operator">=</span> <span class="token class-name">Executors</span><span class="token punctuation">.</span><span class="token function">newFixedThreadPool</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// 提交任务给线程池</span>
        executorService<span class="token punctuation">.</span><span class="token function">submit</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">MyRunnable</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        executorService<span class="token punctuation">.</span><span class="token function">submit</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">MyRunnable</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// 关闭线程池</span>
        executorService<span class="token punctuation">.</span><span class="token function">shutdown</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>在选择创建线程的方式时，一般推荐使用实现<code>Runnable</code>接口的方式，因为它更灵活，一个类可以同时实现多个接口。此外，使用<code>Executor</code>框架能够更好地控制线程的生命周期、并发度等。</p>
<h3 id="五-springboot知识"><a href="#五-springboot知识" class="headerlink" title="五.springboot知识"></a>五.springboot知识</h3><h4 id="1-springboot-常用注解的用法"><a href="#1-springboot-常用注解的用法" class="headerlink" title="1.springboot 常用注解的用法"></a>1.springboot 常用注解的用法</h4><p>Spring Boot提供了许多注解，用于简化应用程序的开发和配置。以下是一些常用的Spring Boot注解及其用法：</p>
<h5 id="1-1-SpringBootApplication："><a href="#1-1-SpringBootApplication：" class="headerlink" title="1.1. @SpringBootApplication："></a>1.1. <strong><code>@SpringBootApplication</code>：</strong></h5><p>用于标注主类，通常位于Spring Boot应用程序的入口类上。它包含了<code>@Configuration</code>、<code>@EnableAutoConfiguration</code>和<code>@ComponentScan</code>注解，用于开启自动配置和组件扫描。</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@SpringBootApplication</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyApplication</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">SpringApplication</span><span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token class-name">MyApplication</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> args<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h5 id="1-2-Controller、-RestController："><a href="#1-2-Controller、-RestController：" class="headerlink" title="1.2. @Controller、@RestController："></a>1.2. <strong><code>@Controller</code>、<code>@RestController</code>：</strong></h5><p>用于定义控制器类。<code>@RestController</code>注解相当于<code>@Controller</code> + <code>@ResponseBody</code>，用于返回JSON格式的数据。</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@RestController</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyController</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">"/hello"</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">hello</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token string">"Hello, Spring Boot!"</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h5 id="1-3-Service："><a href="#1-3-Service：" class="headerlink" title="1.3. @Service："></a>1.3. <strong><code>@Service</code>：</strong></h5><p>用于标注服务类。通常用于注入到其他组件中。</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@Service</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyService</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">doSomething</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token string">"Service is doing something."</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h5 id="1-4-Repository："><a href="#1-4-Repository：" class="headerlink" title="1.4. @Repository："></a>1.4. <strong><code>@Repository</code>：</strong></h5><p>用于标注数据访问组件，通常用于注入到服务层中。</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@Repository</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyRepository</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getData</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token string">"Data from repository."</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h5 id="1-5-Autowired："><a href="#1-5-Autowired：" class="headerlink" title="1.5. @Autowired："></a>1.5. <strong><code>@Autowired</code>：</strong></h5><p>用于自动装配Bean，可以标注在字段、构造方法、Setter方法上。</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@Service</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyService</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">MyRepository</span> myRepository<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Autowired</span>
    <span class="token keyword">public</span> <span class="token class-name">MyService</span><span class="token punctuation">(</span><span class="token class-name">MyRepository</span> myRepository<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>myRepository <span class="token operator">=</span> myRepository<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// other methods...</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h5 id="1-6-Value："><a href="#1-6-Value：" class="headerlink" title="1.6. @Value："></a>1.6. <strong><code>@Value</code>：</strong></h5><p>用于注入配置文件中的属性值。</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@Service</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyService</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Value</span><span class="token punctuation">(</span><span class="token string">"${my.property}"</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> myProperty<span class="token punctuation">;</span>

    <span class="token comment">// other methods...</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h5 id="1-7-RequestMapping、-GetMapping、-PostMapping、-PutMapping、-DeleteMapping："><a href="#1-7-RequestMapping、-GetMapping、-PostMapping、-PutMapping、-DeleteMapping：" class="headerlink" title="1.7. @RequestMapping、@GetMapping、@PostMapping、@PutMapping、@DeleteMapping："></a>1.7. <strong><code>@RequestMapping</code>、<code>@GetMapping</code>、<code>@PostMapping</code>、<code>@PutMapping</code>、<code>@DeleteMapping</code>：</strong></h5><p>用于定义请求映射。<code>@RequestMapping</code>可以用于类和方法上，而其他注解一般用于方法上。</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@RestController</span>
<span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">"/api"</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyController</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">"/hello"</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">hello</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token string">"Hello, Spring Boot!"</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h5 id="1-8-PathVariable、-RequestParam："><a href="#1-8-PathVariable、-RequestParam：" class="headerlink" title="1.8. @PathVariable、@RequestParam："></a>1.8. <strong><code>@PathVariable</code>、<code>@RequestParam</code>：</strong></h5><p>用于获取请求路径中的变量或请求参数。</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@RestController</span>
<span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">"/api"</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyController</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">"/user/{id}"</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getUserById</span><span class="token punctuation">(</span><span class="token annotation punctuation">@PathVariable</span> <span class="token class-name">Long</span> id<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token string">"User ID: "</span> <span class="token operator">+</span> id<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">"/greet"</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">greet</span><span class="token punctuation">(</span><span class="token annotation punctuation">@RequestParam</span> <span class="token class-name">String</span> name<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token string">"Hello, "</span> <span class="token operator">+</span> name <span class="token operator">+</span> <span class="token string">"!"</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h5 id="1-9-Configuration："><a href="#1-9-Configuration：" class="headerlink" title="1.9. @Configuration："></a>1.9. <strong><code>@Configuration</code>：</strong></h5><p>用于定义配置类，可以在配置类中定义Bean。</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@Configuration</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyConfiguration</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Bean</span>
    <span class="token keyword">public</span> <span class="token class-name">MyBean</span> <span class="token function">myBean</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">MyBean</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>这些注解只是Spring Boot中的一部分，实际上还有很多其他有用的注解。使用这些注解可以有效简化代码，提高开发效率。</p>
<h3 id="六-spring知识"><a href="#六-spring知识" class="headerlink" title="六.spring知识"></a>六.spring知识</h3><p>Spring是一个广泛用于构建企业级Java应用程序的开源框架。它提供了全面的基础设施支持，使得开发者能够专注于业务逻辑的开发而不用过多关注底层的复杂性。以下是一些关键的Spring知识点：</p>
<h5 id="1-核心概念："><a href="#1-核心概念：" class="headerlink" title="1. 核心概念："></a>1. <strong>核心概念：</strong></h5><ul>
<li><strong>IoC（Inversion of Control）：</strong> IoC是Spring的核心理念，它通过将对象的创建和管理交给Spring容器来实现，降低了组件之间的耦合度。</li>
<li><strong>DI（Dependency Injection）：</strong> DI是IoC的一种具体实现，通过注入依赖关系来实现对象之间的解耦。Spring支持构造器注入、属性注入和方法注入。</li>
</ul>
<h5 id="2-Spring容器："><a href="#2-Spring容器：" class="headerlink" title="2. Spring容器："></a>2. <strong>Spring容器：</strong></h5><ul>
<li><strong>BeanFactory：</strong> 是Spring的最基本容器，负责管理Bean的生命周期和依赖关系。</li>
<li><strong>ApplicationContext：</strong> 是BeanFactory的扩展，提供更多的功能，如事件传播、国际化、资源加载等。</li>
</ul>
<h5 id="3-Spring配置："><a href="#3-Spring配置：" class="headerlink" title="3. Spring配置："></a>3. <strong>Spring配置：</strong></h5><ul>
<li><strong>XML配置：</strong> 通过XML文件配置Spring Bean和相关的依赖关系。</li>
<li><strong>注解配置：</strong> 使用注解（如<code>@Component</code>、<code>@Configuration</code>、<code>@Autowired</code>等）替代XML配置，提高开发效率。</li>
</ul>
<h5 id="4-AOP（Aspect-Oriented-Programming）："><a href="#4-AOP（Aspect-Oriented-Programming）：" class="headerlink" title="4. AOP（Aspect-Oriented Programming）："></a>4. <strong>AOP（Aspect-Oriented Programming）：</strong></h5><ul>
<li>AOP是一种编程范式，通过在不同的模块中定义横切关注点（cross-cutting concerns）并将其与主业务逻辑解耦。Spring提供了强大的AOP支持，可以通过注解或XML配置进行切面编程。</li>
</ul>
<h5 id="5-数据访问与事务管理："><a href="#5-数据访问与事务管理：" class="headerlink" title="5. 数据访问与事务管理："></a>5. <strong>数据访问与事务管理：</strong></h5><ul>
<li><strong>Spring JDBC：</strong> 简化了JDBC代码的编写，提供了异常处理和资源管理等功能。</li>
<li><strong>ORM（Object-Relational Mapping）：</strong> Spring支持多种ORM框架，如Hibernate、MyBatis等，简化了数据库操作。</li>
<li><strong>事务管理：</strong> Spring提供声明式事务管理，可以通过注解或XML配置来实现事务。</li>
</ul>
<h5 id="6-Spring-MVC："><a href="#6-Spring-MVC：" class="headerlink" title="6. Spring MVC："></a>6. <strong>Spring MVC：</strong></h5><ul>
<li>Spring MVC是一个基于MVC模式的Web框架，用于构建Web应用程序。它提供了模型（Model）、视图（View）、控制器（Controller）的支持，并通过注解简化了URL映射、数据绑定等操作。</li>
</ul>
<h5 id="7-Spring-Boot："><a href="#7-Spring-Boot：" class="headerlink" title="7. Spring Boot："></a>7. <strong>Spring Boot：</strong></h5><ul>
<li>Spring Boot是Spring家族中的一个子项目，用于简化Spring应用程序的开发和部署。它提供了一套默认的配置，支持快速搭建、运行和测试Spring应用程序。</li>
</ul>
<h5 id="8-Spring-Security："><a href="#8-Spring-Security：" class="headerlink" title="8. Spring Security："></a>8. <strong>Spring Security：</strong></h5><ul>
<li>Spring Security是用于处理身份验证和授权的框架，提供了一系列的过滤器和扩展点，用于保护应用程序的安全性。</li>
</ul>
<h5 id="9-Spring-Cloud："><a href="#9-Spring-Cloud：" class="headerlink" title="9. Spring Cloud："></a>9. <strong>Spring Cloud：</strong></h5><ul>
<li>Spring Cloud是用于构建分布式系统的一组工具，提供了服务发现、配置管理、负载均衡等功能，支持构建微服务架构。</li>
</ul>
<h5 id="10-测试："><a href="#10-测试：" class="headerlink" title="10. 测试："></a>10. <strong>测试：</strong></h5><ul>
<li>Spring提供了一系列的测试支持，包括单元测试、集成测试、模拟测试等。可以使用JUnit或TestNG等测试框架进行测试。</li>
</ul>
<p>这些是Spring框架的一些核心知识点，Spring的强大之处在于它提供了一整套解决方案，涵盖了应用程序开发的各个方面。在使用Spring时，开发者可以根据实际需求选择合适的模块和组件，以构建高效、可维护的企业级应用程序。</p>
<h4 id="11-Spring注解用法"><a href="#11-Spring注解用法" class="headerlink" title="11. Spring注解用法"></a>11. Spring注解用法</h4><p>Spring框架提供了丰富的注解，用于简化配置和开发，以下是一些常用的Spring注解及其用法：</p>
<h5 id="11-1-Component、-Service、-Repository、-Controller："><a href="#11-1-Component、-Service、-Repository、-Controller：" class="headerlink" title="11.1. @Component、@Service、@Repository、@Controller："></a>11.1. <strong><code>@Component</code>、<code>@Service</code>、<code>@Repository</code>、<code>@Controller</code>：</strong></h5><p>这些注解用于声明一个类为Spring的组件，分别用于标识普通组件、服务层组件、数据访问组件和控制器组件。</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@Component</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyComponent</span> <span class="token punctuation">{</span>
    <span class="token comment">// ...</span>
<span class="token punctuation">}</span>

<span class="token annotation punctuation">@Service</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyService</span> <span class="token punctuation">{</span>
    <span class="token comment">// ...</span>
<span class="token punctuation">}</span>

<span class="token annotation punctuation">@Repository</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyRepository</span> <span class="token punctuation">{</span>
    <span class="token comment">// ...</span>
<span class="token punctuation">}</span>

<span class="token annotation punctuation">@Controller</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyController</span> <span class="token punctuation">{</span>
    <span class="token comment">// ...</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h5 id="11-2-Autowired："><a href="#11-2-Autowired：" class="headerlink" title="11.2. @Autowired："></a>11.2. <strong><code>@Autowired</code>：</strong></h5><p>用于自动装配（注入）Bean，可以标注在字段、构造方法、Setter方法上。</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@Service</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyService</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">MyRepository</span> myRepository<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Autowired</span>
    <span class="token keyword">public</span> <span class="token class-name">MyService</span><span class="token punctuation">(</span><span class="token class-name">MyRepository</span> myRepository<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>myRepository <span class="token operator">=</span> myRepository<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// other methods...</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h5 id="11-3-Value："><a href="#11-3-Value：" class="headerlink" title="11.3. @Value："></a>11.3. <strong><code>@Value</code>：</strong></h5><p>用于注入配置文件中的属性值。</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@Service</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyService</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Value</span><span class="token punctuation">(</span><span class="token string">"${my.property}"</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> myProperty<span class="token punctuation">;</span>

    <span class="token comment">// other methods...</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h5 id="11-4-Configuration："><a href="#11-4-Configuration：" class="headerlink" title="11.4. @Configuration："></a>11.4. <strong><code>@Configuration</code>：</strong></h5><p>用于定义配置类，通常与<code>@Bean</code>注解一起使用，将方法返回的对象注册为Spring的Bean。</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@Configuration</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyConfiguration</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Bean</span>
    <span class="token keyword">public</span> <span class="token class-name">MyBean</span> <span class="token function">myBean</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">MyBean</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h5 id="11-5-Primary、-Qualifier："><a href="#11-5-Primary、-Qualifier：" class="headerlink" title="11.5. @Primary、@Qualifier："></a>11.5. <strong><code>@Primary</code>、<code>@Qualifier</code>：</strong></h5><p>用于解决自动装配时的歧义性。<code>@Primary</code>用于标识首选的Bean，而<code>@Qualifier</code>用于指定具体要注入的Bean。</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@Component</span>
<span class="token annotation punctuation">@Primary</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyPrimaryBean</span> <span class="token keyword">implements</span> <span class="token class-name">MyInterface</span> <span class="token punctuation">{</span>
    <span class="token comment">// ...</span>
<span class="token punctuation">}</span>

<span class="token annotation punctuation">@Component</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MySecondaryBean</span> <span class="token keyword">implements</span> <span class="token class-name">MyInterface</span> <span class="token punctuation">{</span>
    <span class="token comment">// ...</span>
<span class="token punctuation">}</span>

<span class="token annotation punctuation">@Service</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyService</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Autowired</span>
    <span class="token keyword">private</span> <span class="token class-name">MyInterface</span> myInterface<span class="token punctuation">;</span>

    <span class="token comment">// ...</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h5 id="11-6-Scope："><a href="#11-6-Scope：" class="headerlink" title="11.6. @Scope："></a>11.6. <strong><code>@Scope</code>：</strong></h5><p>用于指定Bean的作用域，包括单例（Singleton）、原型（Prototype）等。</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@Component</span>
<span class="token annotation punctuation">@Scope</span><span class="token punctuation">(</span><span class="token string">"prototype"</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyPrototypeBean</span> <span class="token punctuation">{</span>
    <span class="token comment">// ...</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h5 id="11-7-RequestMapping、-GetMapping、-PostMapping、-PutMapping、-DeleteMapping："><a href="#11-7-RequestMapping、-GetMapping、-PostMapping、-PutMapping、-DeleteMapping：" class="headerlink" title="11.7. @RequestMapping、@GetMapping、@PostMapping、@PutMapping、@DeleteMapping："></a>11.7. <strong><code>@RequestMapping</code>、<code>@GetMapping</code>、<code>@PostMapping</code>、<code>@PutMapping</code>、<code>@DeleteMapping</code>：</strong></h5><p>用于定义请求映射。</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@Controller</span>
<span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">"/api"</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyController</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">"/hello"</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">hello</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token string">"Hello, Spring!"</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h5 id="11-8-ResponseBody、-RequestBody："><a href="#11-8-ResponseBody、-RequestBody：" class="headerlink" title="11.8. @ResponseBody、@RequestBody："></a>11.8. <strong><code>@ResponseBody</code>、<code>@RequestBody</code>：</strong></h5><p>用于处理HTTP请求和响应中的数据。<code>@ResponseBody</code>用于将方法返回的对象转换为HTTP响应体，而<code>@RequestBody</code>用于将HTTP请求体转换为方法参数。</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@RestController</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyRestController</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@PostMapping</span><span class="token punctuation">(</span><span class="token string">"/submit"</span><span class="token punctuation">)</span>
    <span class="token annotation punctuation">@ResponseBody</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">submit</span><span class="token punctuation">(</span><span class="token annotation punctuation">@RequestBody</span> <span class="token class-name">MyObject</span> myObject<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// ...</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h5 id="11-9-Transactional："><a href="#11-9-Transactional：" class="headerlink" title="11.9. @Transactional："></a>11.9. <strong><code>@Transactional</code>：</strong></h5><p>用于声明事务管理，通常标注在方法或类上。</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@Service</span>
<span class="token annotation punctuation">@Transactional</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyTransactionalService</span> <span class="token punctuation">{</span>
    <span class="token comment">// ...</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h5 id="11-10-Async："><a href="#11-10-Async：" class="headerlink" title="11.10. @Async："></a>11.10. <strong><code>@Async</code>：</strong></h5><p>用于声明异步方法，通常标注在方法上。</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@Service</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyAsyncService</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Async</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">asyncMethod</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// ...</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>这些注解是Spring框架中常用的一些注解，它们可以帮助开发者简化配置、提高开发效率，并提供了更灵活的方式来处理依赖注入、事务管理、请求处理等方面的问题。在实际应用中，根据具体的场景和需求选择合适的注解是非常重要的。</p>
<h4 id="12-Java-bean注入方式"><a href="#12-Java-bean注入方式" class="headerlink" title="12. Java bean注入方式"></a>12. Java bean注入方式</h4><p>在Java中，Bean的注入方式通常有三种：构造器注入、Setter方法注入和字段注入。这些注入方式可以通过依赖注入（DI）的方式来实现，Spring框架是其中一个典型的使用依赖注入的例子。</p>
<h5 id="12-1-构造器注入："><a href="#12-1-构造器注入：" class="headerlink" title="12.1. 构造器注入："></a>12.1. <strong>构造器注入：</strong></h5><p>通过构造器注入，依赖关系通过构造器的参数传递进来。</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyService</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">MyRepository</span> myRepository<span class="token punctuation">;</span>

    <span class="token comment">// 构造器注入</span>
    <span class="token keyword">public</span> <span class="token class-name">MyService</span><span class="token punctuation">(</span><span class="token class-name">MyRepository</span> myRepository<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>myRepository <span class="token operator">=</span> myRepository<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// other methods...</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h5 id="12-2-Setter方法注入："><a href="#12-2-Setter方法注入：" class="headerlink" title="12.2. Setter方法注入："></a>12.2. <strong>Setter方法注入：</strong></h5><p>通过Setter方法注入，依赖关系通过Setter方法设置。</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyService</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token class-name">MyRepository</span> myRepository<span class="token punctuation">;</span>

    <span class="token comment">// Setter方法注入</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setMyRepository</span><span class="token punctuation">(</span><span class="token class-name">MyRepository</span> myRepository<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>myRepository <span class="token operator">=</span> myRepository<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// other methods...</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h5 id="12-3-字段注入："><a href="#12-3-字段注入：" class="headerlink" title="12.3. 字段注入："></a>12.3. <strong>字段注入：</strong></h5><p>通过字段注入，依赖关系通过直接设置字段的方式实现。</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyService</span> <span class="token punctuation">{</span>
    <span class="token comment">// 字段注入</span>
    <span class="token keyword">private</span> <span class="token class-name">MyRepository</span> myRepository<span class="token punctuation">;</span>

    <span class="token comment">// other methods...</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h5 id="12-4-使用-Autowired注解进行自动注入："><a href="#12-4-使用-Autowired注解进行自动注入：" class="headerlink" title="12.4. 使用@Autowired注解进行自动注入："></a>12.4. <strong>使用<code>@Autowired</code>注解进行自动注入：</strong></h5><p>Spring框架提供了<code>@Autowired</code>注解，用于标注在构造器、Setter方法、字段上，以实现自动装配。通过<code>@Autowired</code>注解，Spring容器会自动寻找匹配的Bean进行注入。</p>
<h6 id="12-4-1-使用构造器注入："><a href="#12-4-1-使用构造器注入：" class="headerlink" title="12.4.1. 使用构造器注入："></a>12.4.1. 使用构造器注入：</h6><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyService</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">MyRepository</span> myRepository<span class="token punctuation">;</span>

    <span class="token comment">// 构造器注入</span>
    <span class="token annotation punctuation">@Autowired</span>
    <span class="token keyword">public</span> <span class="token class-name">MyService</span><span class="token punctuation">(</span><span class="token class-name">MyRepository</span> myRepository<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>myRepository <span class="token operator">=</span> myRepository<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// other methods...</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h6 id="12-4-2-使用Setter方法注入："><a href="#12-4-2-使用Setter方法注入：" class="headerlink" title="12.4.2. 使用Setter方法注入："></a>12.4.2. 使用Setter方法注入：</h6><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyService</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token class-name">MyRepository</span> myRepository<span class="token punctuation">;</span>

    <span class="token comment">// Setter方法注入</span>
    <span class="token annotation punctuation">@Autowired</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setMyRepository</span><span class="token punctuation">(</span><span class="token class-name">MyRepository</span> myRepository<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>myRepository <span class="token operator">=</span> myRepository<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// other methods...</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h6 id="12-4-3-使用字段注入："><a href="#12-4-3-使用字段注入：" class="headerlink" title="12.4.3. 使用字段注入："></a>12.4.3. 使用字段注入：</h6><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyService</span> <span class="token punctuation">{</span>
    <span class="token comment">// 字段注入</span>
    <span class="token annotation punctuation">@Autowired</span>
    <span class="token keyword">private</span> <span class="token class-name">MyRepository</span> myRepository<span class="token punctuation">;</span>

    <span class="token comment">// other methods...</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>选择使用哪种注入方式通常取决于个人或团队的偏好，以及具体的业务场景。构造器注入通常被认为是最佳实践，因为它确保在对象创建时，所有必需的依赖关系都已经被满足。 Setter方法注入和字段注入也是常见的，根据实际需要选择适合的方式。</p>
<h4 id="13-Spring中ioc概念及应用"><a href="#13-Spring中ioc概念及应用" class="headerlink" title="13. Spring中ioc概念及应用"></a>13. Spring中ioc概念及应用</h4><p><strong>IoC（Inversion of Control）</strong> 是 Spring 框架的核心概念之一。它是一种设计思想，通过将控制权反转给框架，由框架负责控制对象的创建和管理，而不是由应用程序代码直接控制。</p>
<p>在传统的编程模型中，应用程序代码通常会负责创建和管理对象。而在 IoC 容器中，对象的创建和管理被交由容器负责，应用程序代码只需关注对象的使用。IoC 容器负责将各个组件（对象）连接起来，形成一个完整的应用程序。</p>
<p>Spring IoC 的核心容器是 <strong>BeanFactory</strong> 和 <strong>ApplicationContext</strong>。</p>
<h5 id="13-1-BeanFactory："><a href="#13-1-BeanFactory：" class="headerlink" title="13.1. BeanFactory："></a>13.1. <strong>BeanFactory：</strong></h5><p><code>BeanFactory</code> 是 Spring IoC 容器的最基本形式，它负责管理 Spring 应用中的所有对象（Bean）。在配置文件中定义的 Bean 会在应用运行时由 BeanFactory 进行创建和管理。</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token class-name">XmlBeanFactory</span> factory <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">XmlBeanFactory</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">ClassPathResource</span><span class="token punctuation">(</span><span class="token string">"spring-config.xml"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">MyService</span> myService <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">MyService</span><span class="token punctuation">)</span> factory<span class="token punctuation">.</span><span class="token function">getBean</span><span class="token punctuation">(</span><span class="token string">"myService"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<h5 id="13-2-ApplicationContext："><a href="#13-2-ApplicationContext：" class="headerlink" title="13.2. ApplicationContext："></a>13.2. <strong>ApplicationContext：</strong></h5><p><code>ApplicationContext</code> 是 <code>BeanFactory</code> 的扩展，提供了更多的功能。除了管理 Bean 的生命周期外，它还支持国际化、事件传播、资源加载等。</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token class-name">ApplicationContext</span> context <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ClassPathXmlApplicationContext</span><span class="token punctuation">(</span><span class="token string">"spring-config.xml"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">MyService</span> myService <span class="token operator">=</span> context<span class="token punctuation">.</span><span class="token function">getBean</span><span class="token punctuation">(</span><span class="token class-name">MyService</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<h5 id="13-3-Bean的定义："><a href="#13-3-Bean的定义：" class="headerlink" title="13.3. Bean的定义："></a>13.3. <strong>Bean的定义：</strong></h5><p>在 Spring IoC 容器中，Bean 的定义包括 Bean 的标识符（ID）、类型（Class）以及配置元数据（Properties）。Bean 的定义通常通过 XML 配置文件、Java 注解或 Java 代码进行。</p>
<pre class="line-numbers language-markup" data-language="markup"><code class="language-markup"><span class="token comment">&lt;!-- XML 配置文件中的 Bean 定义 --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>bean</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>myService<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>com.example.MyService<span class="token punctuation">"</span></span> <span class="token punctuation">/&gt;</span></span>

<span class="token comment">&lt;!-- 使用 Java 注解进行 Bean 定义 --&gt;</span>
@Component
public class MyService {
    // ...
}

<span class="token comment">&lt;!-- 使用 Java 代码进行 Bean 定义 --&gt;</span>
@Configuration
public class AppConfig {
    @Bean
    public MyService myService() {
        return new MyService();
    }
}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h5 id="13-4-依赖注入（Dependency-Injection）："><a href="#13-4-依赖注入（Dependency-Injection）：" class="headerlink" title="13.4. 依赖注入（Dependency Injection）："></a>13.4. <strong>依赖注入（Dependency Injection）：</strong></h5><p>IoC 的另一个关键概念是依赖注入，它是 IoC 的具体实现。在 Spring 中，依赖注入可以通过构造器注入、Setter 方法注入、字段注入等方式实现。Spring IoC 容器负责将 Bean 之间的依赖关系建立起来。</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyService</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token class-name">MyRepository</span> myRepository<span class="token punctuation">;</span>

    <span class="token comment">// 通过构造器注入</span>
    <span class="token keyword">public</span> <span class="token class-name">MyService</span><span class="token punctuation">(</span><span class="token class-name">MyRepository</span> myRepository<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>myRepository <span class="token operator">=</span> myRepository<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// 通过 Setter 方法注入</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setMyRepository</span><span class="token punctuation">(</span><span class="token class-name">MyRepository</span> myRepository<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>myRepository <span class="token operator">=</span> myRepository<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// 通过字段注入</span>
    <span class="token annotation punctuation">@Autowired</span>
    <span class="token keyword">private</span> <span class="token class-name">MyRepository</span> myRepository<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h5 id="13-5-IoC-的优势："><a href="#13-5-IoC-的优势：" class="headerlink" title="13.5. IoC 的优势："></a>13.5. <strong>IoC 的优势：</strong></h5><ul>
<li><strong>松耦合（Loose Coupling）：</strong> IoC 通过将对象之间的依赖关系交由容器管理，降低了组件之间的耦合度，使得代码更加灵活和可维护。</li>
<li><strong>可测试性（Testability）：</strong> 由于对象的创建和管理被容器接管，可以更轻松地进行单元测试，更容易模拟和替换对象。</li>
<li><strong>可维护性（Maintainability）：</strong> IoC 通过集中管理对象的创建和配置，使得系统更易于维护和扩展。</li>
<li><strong>灵活性（Flexibility）：</strong> 可以通过配置文件或注解来改变应用程序的行为，而不需要修改代码。</li>
</ul>
<p>总体而言，IoC 是 Spring 框架的核心理念，通过它，我们可以更好地组织和管理应用程序的组件，提高代码的可读性、可维护性和可测试性。</p>
<h4 id="14-AOP含义用法"><a href="#14-AOP含义用法" class="headerlink" title="14. AOP含义用法"></a>14. AOP含义用法</h4><p>AOP为Aspect Oriented Programming的缩写，意为：面向切面编程，通过预编译方式和运行期动态代理实现程序功能的统一维护的一种技术。利用AOP可以对业务逻辑的各个部分进行隔离，从而使得业务逻辑各部分之间的耦合度降低，提高程序的可重用性，同时提高了开发的效率。</p>
<h5 id="通知（Advice）"><a href="#通知（Advice）" class="headerlink" title="通知（Advice）"></a>通知（Advice）</h5><p>通知描述了切面要完成的工作以及何时执行。比如我们的日志切面需要记录每个接口调用时长，就需要在接口调用前后分别记录当前时间，再取差值。</p>
<ul>
<li><p>前置通知（Before）：在目标方法调用前调用通知功能；</p>
</li>
<li><p>后置通知（After）：在目标方法调用之后调用通知功能，不关心方法的返回结果；</p>
</li>
<li><p>返回通知（AfterReturning）：在目标方法成功执行之后调用通知功能；</p>
</li>
<li><p>异常通知（AfterThrowing）：在目标方法抛出异常后调用通知功能；</p>
</li>
<li><p>环绕通知（Around）：通知包裹了目标方法，在目标方法调用之前和之后执行自定义的行为。</p>
</li>
</ul>
<h5 id="连接点（JoinPoint）"><a href="#连接点（JoinPoint）" class="headerlink" title="连接点（JoinPoint）"></a>连接点（JoinPoint）</h5><ul>
<li>通知功能被应用的时机。比如接口方法被调用的时候就是日志切面的连接点。</li>
</ul>
<h5 id="切点（Pointcut）"><a href="#切点（Pointcut）" class="headerlink" title="切点（Pointcut）"></a>切点（Pointcut）</h5><ul>
<li>切点定义了通知功能被应用的范围。比如日志切面的应用范围就是所有接口，即所有controller层的接口方法。</li>
</ul>
<h5 id="切面（Aspect）"><a href="#切面（Aspect）" class="headerlink" title="切面（Aspect）"></a>切面（Aspect）</h5><ul>
<li>切面是通知和切点的结合，定义了何时、何地应用通知功能。</li>
</ul>
<h5 id="引入（Introduction）"><a href="#引入（Introduction）" class="headerlink" title="引入（Introduction）"></a>引入（Introduction）</h5><ul>
<li>在无需修改现有类的情况下，向现有的类添加新方法或属性。</li>
</ul>
<h5 id="织入（Weaving）"><a href="#织入（Weaving）" class="headerlink" title="织入（Weaving）"></a>织入（Weaving）</h5><ul>
<li>把切面应用到目标对象并创建新的代理对象的过程。</li>
</ul>
<h5 id="AOP相关注解"><a href="#AOP相关注解" class="headerlink" title="AOP相关注解"></a>AOP相关注解</h5><ul>
<li>@Aspect：用于定义切面</li>
<li>@Before：通知方法会在目标方法调用之前执行</li>
<li>@After：通知方法会在目标方法返回或抛出异常后执行</li>
<li>@AfterReturning：通知方法会在目标方法返回后执行</li>
<li>@AfterThrowing：通知方法会在目标方法抛出异常后执行</li>
<li>@Around：通知方法会将目标方法封装起来</li>
<li>@Pointcut：定义切点表达式</li>
</ul>
<h5 id="切点表达式"><a href="#切点表达式" class="headerlink" title="切点表达式"></a>切点表达式</h5><p>指定了通知被应用的范围，表达式格式：</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token function">execution</span><span class="token punctuation">(</span>方法修饰符 返回类型 方法所属的包<span class="token punctuation">.</span>类名<span class="token punctuation">.</span>方法名称<span class="token punctuation">(</span>方法参数<span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">//com.macro.mall.controller包中所有类的public方法都应用切面里的通知</span>
<span class="token function">execution</span><span class="token punctuation">(</span><span class="token keyword">public</span> <span class="token operator">*</span> com<span class="token punctuation">.</span>macro<span class="token punctuation">.</span>mall<span class="token punctuation">.</span>controller<span class="token punctuation">.</span>*<span class="token punctuation">.</span>*<span class="token punctuation">(</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment">//com.macro.mall包及包含controller的子包下所有类中的所有方法都应用切面里的通知</span>
<span class="token function">execution</span><span class="token punctuation">(</span><span class="token keyword">public</span> <span class="token operator">*</span> com<span class="token punctuation">.</span>macro<span class="token punctuation">.</span>mall<span class="token punctuation">.</span>*<span class="token punctuation">.</span>controller<span class="token punctuation">.</span>*<span class="token punctuation">.</span>*<span class="token punctuation">(</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment">//com.macro.mall.controller.PmsBrandController类中的所有方法都应用切面里的通知</span>
<span class="token function">execution</span><span class="token punctuation">(</span><span class="token operator">*</span> <span class="token class-name"><span class="token namespace">com<span class="token punctuation">.</span>macro<span class="token punctuation">.</span>mall<span class="token punctuation">.</span>controller<span class="token punctuation">.</span></span>PmsBrandController</span><span class="token punctuation">.</span>*<span class="token punctuation">(</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="七-Redis-AOP优化权限管理功能"><a href="#七-Redis-AOP优化权限管理功能" class="headerlink" title="七.Redis+AOP优化权限管理功能"></a>七.Redis+AOP优化权限管理功能</h3><p>原由：由于每次访问接口进行权限校验时都会从数据库中去查询用户信息，这样做会带来性能问题。</p>
<p>解决方案：使用Redis作为缓存，把用户信息和用户资源信息存入到Redis中去，避免频繁查询数据库。使用的是RedisTemple的操作方式。当查询数据时，先去Redis缓存中查询，如果Redis中没有，再从数据库查询，查询到以后在把数据存储到Redis中去。</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">/**
 * UmsAdminService实现类
 * Created by macro on 2018/4/26.
 */</span>
<span class="token annotation punctuation">@Service</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">UmsAdminServiceImpl</span> <span class="token keyword">implements</span> <span class="token class-name">UmsAdminService</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">UmsAdmin</span> <span class="token function">getAdminByUsername</span><span class="token punctuation">(</span><span class="token class-name">String</span> username<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">//先从缓存中获取数据</span>
        <span class="token class-name">UmsAdmin</span> admin <span class="token operator">=</span> <span class="token function">getCacheService</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getAdmin</span><span class="token punctuation">(</span>username<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>admin<span class="token operator">!=</span><span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token keyword">return</span>  admin<span class="token punctuation">;</span>
        <span class="token comment">//缓存中没有从数据库中获取</span>
        <span class="token class-name">UmsAdminExample</span> example <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">UmsAdminExample</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        example<span class="token punctuation">.</span><span class="token function">createCriteria</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">andUsernameEqualTo</span><span class="token punctuation">(</span>username<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">UmsAdmin</span><span class="token punctuation">&gt;</span></span> adminList <span class="token operator">=</span> adminMapper<span class="token punctuation">.</span><span class="token function">selectByExample</span><span class="token punctuation">(</span>example<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>adminList <span class="token operator">!=</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> adminList<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            admin <span class="token operator">=</span> adminList<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">//将数据库中的数据存入缓存中</span>
            <span class="token function">getCacheService</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setAdmin</span><span class="token punctuation">(</span>admin<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> admin<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">UmsResource</span><span class="token punctuation">&gt;</span></span> <span class="token function">getResourceList</span><span class="token punctuation">(</span><span class="token class-name">Long</span> adminId<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">//先从缓存中获取数据</span>
        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">UmsResource</span><span class="token punctuation">&gt;</span></span> resourceList <span class="token operator">=</span> <span class="token function">getCacheService</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getResourceList</span><span class="token punctuation">(</span>adminId<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token class-name">CollUtil</span><span class="token punctuation">.</span><span class="token function">isNotEmpty</span><span class="token punctuation">(</span>resourceList<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token keyword">return</span>  resourceList<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token comment">//缓存中没有从数据库中获取</span>
        resourceList <span class="token operator">=</span> adminRoleRelationDao<span class="token punctuation">.</span><span class="token function">getResourceList</span><span class="token punctuation">(</span>adminId<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token class-name">CollUtil</span><span class="token punctuation">.</span><span class="token function">isNotEmpty</span><span class="token punctuation">(</span>resourceList<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token comment">//将数据库中的数据存入缓存中</span>
            <span class="token function">getCacheService</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setResourceList</span><span class="token punctuation">(</span>adminId<span class="token punctuation">,</span>resourceList<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> resourceList<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">UmsAdminCacheService</span> <span class="token function">getCacheService</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token class-name">SpringUtil</span><span class="token punctuation">.</span><span class="token function">getBean</span><span class="token punctuation">(</span><span class="token class-name">UmsAdminCacheService</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>上面这种查询操作其实用Spring Cache来操作更简单，直接使用@Cacheable即可实现，为什么还要使用RedisTemplate来直接操作呢？因为作为缓存，我们所希望的是，如果Redis宕机了，我们的业务逻辑不会有影响，而使用Spring Cache来实现的话，当Redis宕机以后，用户的登录等种种操作就会都无法进行了。</p>
<p>当Redis宕机以后，我们直接就无法登录了，下面我们使用AOP来解决这个问题。</p>
<h5 id="使用AOP处理缓存操作异常"><a href="#使用AOP处理缓存操作异常" class="headerlink" title="使用AOP处理缓存操作异常"></a>使用AOP处理缓存操作异常</h5><p>为什么要用AOP来解决这个问题呢？因为我们的缓存业务类<code>UmsAdminCacheService</code>已经写好了，要保证缓存业务类中的方法执行不影响正常的业务逻辑，就需要在所有方法中添加<code>try catch</code>逻辑。使用AOP，我们可以在一个地方写上<code>try catch</code>逻辑，然后应用到所有方法上去。试想下，我们如果又多了几个缓存业务类，只要配置下切面即可，这波操作多方便！</p>
<p>首先我们先定义一个切面，在相关缓存业务类上面应用，在它的环绕通知中直接处理掉异常，保障后续操作能执行。</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">/**
 * Redis缓存切面，防止Redis宕机影响正常业务逻辑
 * Created by macro on 2020/3/17.
 */</span>
<span class="token annotation punctuation">@Aspect</span>
<span class="token annotation punctuation">@Component</span>
<span class="token annotation punctuation">@Order</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">RedisCacheAspect</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token class-name">Logger</span> <span class="token constant">LOGGER</span> <span class="token operator">=</span> <span class="token class-name">LoggerFactory</span><span class="token punctuation">.</span><span class="token function">getLogger</span><span class="token punctuation">(</span><span class="token class-name">RedisCacheAspect</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Pointcut</span><span class="token punctuation">(</span><span class="token string">"execution(public * com.macro.mall.portal.service.*CacheService.*(..)) || execution(public * com.macro.mall.service.*CacheService.*(..))"</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">cacheAspect</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Around</span><span class="token punctuation">(</span><span class="token string">"cacheAspect()"</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">Object</span> <span class="token function">doAround</span><span class="token punctuation">(</span><span class="token class-name">ProceedingJoinPoint</span> joinPoint<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Throwable</span> <span class="token punctuation">{</span>
        <span class="token class-name">Object</span> result <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            result <span class="token operator">=</span> joinPoint<span class="token punctuation">.</span><span class="token function">proceed</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Throwable</span> throwable<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token constant">LOGGER</span><span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span>throwable<span class="token punctuation">.</span><span class="token function">getMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> result<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>这样处理之后，就算我们的Redis宕机了，我们的业务逻辑也能正常执行。</p>
<p>不过并不是所有的方法都需要处理异常的，比如我们的验证码存储，如果我们的Redis宕机了，我们的验证码存储接口需要的是报错，而不是返回执行成功。</p>
<p>对于上面这种需求我们可以通过自定义注解来完成，首先我们自定义一个<code>CacheException</code>注解，如果方法上面有这个注解，发生异常则直接抛出。</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">/**
 * 自定义注解，有该注解的缓存方法会抛出异常
 */</span>
<span class="token annotation punctuation">@Documented</span>
<span class="token annotation punctuation">@Target</span><span class="token punctuation">(</span><span class="token class-name">ElementType</span><span class="token punctuation">.</span><span class="token constant">METHOD</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@Retention</span><span class="token punctuation">(</span><span class="token class-name">RetentionPolicy</span><span class="token punctuation">.</span><span class="token constant">RUNTIME</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token annotation punctuation">@interface</span> <span class="token class-name">CacheException</span> <span class="token punctuation">{</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>之后需要改造下我们的切面类，对于有<code>@CacheException</code>注解的方法，如果发生异常直接抛出。</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">/**
 * Redis缓存切面，防止Redis宕机影响正常业务逻辑
 * Created by macro on 2020/3/17.
 */</span>
<span class="token annotation punctuation">@Aspect</span>
<span class="token annotation punctuation">@Component</span>
<span class="token annotation punctuation">@Order</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">RedisCacheAspect</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token class-name">Logger</span> <span class="token constant">LOGGER</span> <span class="token operator">=</span> <span class="token class-name">LoggerFactory</span><span class="token punctuation">.</span><span class="token function">getLogger</span><span class="token punctuation">(</span><span class="token class-name">RedisCacheAspect</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Pointcut</span><span class="token punctuation">(</span><span class="token string">"execution(public * com.macro.mall.portal.service.*CacheService.*(..)) || execution(public * com.macro.mall.service.*CacheService.*(..))"</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">cacheAspect</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Around</span><span class="token punctuation">(</span><span class="token string">"cacheAspect()"</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">Object</span> <span class="token function">doAround</span><span class="token punctuation">(</span><span class="token class-name">ProceedingJoinPoint</span> joinPoint<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Throwable</span> <span class="token punctuation">{</span>
        <span class="token class-name">Signature</span> signature <span class="token operator">=</span> joinPoint<span class="token punctuation">.</span><span class="token function">getSignature</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">MethodSignature</span> methodSignature <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">MethodSignature</span><span class="token punctuation">)</span> signature<span class="token punctuation">;</span>
        <span class="token class-name">Method</span> method <span class="token operator">=</span> methodSignature<span class="token punctuation">.</span><span class="token function">getMethod</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Object</span> result <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            result <span class="token operator">=</span> joinPoint<span class="token punctuation">.</span><span class="token function">proceed</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Throwable</span> throwable<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">//有CacheException注解的方法需要抛出异常</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>method<span class="token punctuation">.</span><span class="token function">isAnnotationPresent</span><span class="token punctuation">(</span><span class="token class-name">CacheException</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">throw</span> throwable<span class="token punctuation">;</span>
            <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
                <span class="token constant">LOGGER</span><span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span>throwable<span class="token punctuation">.</span><span class="token function">getMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> result<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>接下来我们需要把<code>@CacheException</code>注解应用到存储和获取验证码的方法上去，这里需要注意的是要应用在实现类上而不是接口上，因为<code>isAnnotationPresent</code>方法只能获取到当前方法上的注解，而不能获取到它实现接口方法上的注解。</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">/**
 * UmsMemberCacheService实现类
 * Created by macro on 2020/3/14.
 */</span>
<span class="token annotation punctuation">@Service</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">UmsMemberCacheServiceImpl</span> <span class="token keyword">implements</span> <span class="token class-name">UmsMemberCacheService</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Autowired</span>
    <span class="token keyword">private</span> <span class="token class-name">RedisService</span> redisService<span class="token punctuation">;</span>
    
    <span class="token annotation punctuation">@CacheException</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setAuthCode</span><span class="token punctuation">(</span><span class="token class-name">String</span> telephone<span class="token punctuation">,</span> <span class="token class-name">String</span> authCode<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">String</span> key <span class="token operator">=</span> <span class="token constant">REDIS_DATABASE</span> <span class="token operator">+</span> <span class="token string">":"</span> <span class="token operator">+</span> <span class="token constant">REDIS_KEY_AUTH_CODE</span> <span class="token operator">+</span> <span class="token string">":"</span> <span class="token operator">+</span> telephone<span class="token punctuation">;</span>
        redisService<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span>authCode<span class="token punctuation">,</span><span class="token constant">REDIS_EXPIRE_AUTH_CODE</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@CacheException</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getAuthCode</span><span class="token punctuation">(</span><span class="token class-name">String</span> telephone<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">String</span> key <span class="token operator">=</span> <span class="token constant">REDIS_DATABASE</span> <span class="token operator">+</span> <span class="token string">":"</span> <span class="token operator">+</span> <span class="token constant">REDIS_KEY_AUTH_CODE</span> <span class="token operator">+</span> <span class="token string">":"</span> <span class="token operator">+</span> telephone<span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">)</span> redisService<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>总结：对于影响性能的，频繁查询数据库的操作，我们可以通过Redis作为缓存来优化。缓存操作不该影响正常业务逻辑，我们可以使用AOP来统一处理缓存操作中的异常。</p>
<h3 id="八-springMVC知识"><a href="#八-springMVC知识" class="headerlink" title="八.springMVC知识"></a>八.springMVC知识</h3><h4 id="SpringMVC的含义以及请求流程"><a href="#SpringMVC的含义以及请求流程" class="headerlink" title="SpringMVC的含义以及请求流程"></a>SpringMVC的含义以及请求流程</h4><p>SpringMVC（Model-View-Controller）是 Spring 框架中用于开发基于Java的Web应用程序的一部分。它提供了一种用于构建灵活且可扩展的Web应用程序的模型-视图-控制器架构。下面是关于SpringMVC的含义和请求流程的简要说明：</p>
<h5 id="含义："><a href="#含义：" class="headerlink" title="含义："></a>含义：</h5><ol>
<li><p><strong>Model（模型）：</strong> 代表应用程序的数据模型，通常表示业务对象或数据访问层。模型负责管理数据、业务规则和逻辑。</p>
</li>
<li><p><strong>View（视图）：</strong> 负责显示用户界面，接受用户输入。通常是JSP页面、HTML、或者Thymeleaf等模板引擎，用于展示数据给用户。</p>
</li>
<li><p><strong>Controller（控制器）：</strong> 接收用户输入并处理业务逻辑，负责将用户请求映射到相应的模型和视图。控制器充当模型和视图之间的协调者。</p>
</li>
</ol>
<h5 id="请求流程："><a href="#请求流程：" class="headerlink" title="请求流程："></a>请求流程：</h5><ol>
<li><p><strong>客户端发送请求：</strong> 客户端（浏览器）发送HTTP请求到SpringMVC应用程序。</p>
</li>
<li><p><strong>DispatcherServlet（前端控制器）处理请求：</strong> DispatcherServlet 是SpringMVC的前端控制器，它负责接收所有的请求，并将请求分发给合适的控制器。</p>
</li>
<li><p><strong>HandlerMapping选择控制器：</strong> HandlerMapping 根据请求的URL映射到相应的控制器（Controller）。Controller是一个用于处理请求的Java类。</p>
</li>
<li><p><strong>Controller处理请求：</strong> Controller执行业务逻辑，可能调用业务服务、访问数据库等，然后根据请求返回一个ModelAndView对象。</p>
</li>
<li><p><strong>ModelAndView返回视图和模型数据：</strong> ModelAndView 包含了视图名和要传递给视图的模型数据。视图名将被解析为实际的视图（JSP、Thymeleaf等），模型数据将用于在视图中渲染内容。</p>
</li>
<li><p><strong>ViewResolver解析视图：</strong> ViewResolver 将视图名解析为实际的视图，决定使用哪个视图引擎（JSP、Thymeleaf等）来渲染页面。</p>
</li>
<li><p><strong>视图渲染：</strong> 视图引擎将使用模型数据来渲染页面，生成HTML响应。</p>
</li>
<li><p><strong>DispatcherServlet返回响应：</strong> DispatcherServlet 将渲染好的HTML响应发送回客户端。</p>
</li>
</ol>
<p>这是一个简化的SpringMVC请求流程，实际应用中可能包含更多的细节和配置。SpringMVC提供了丰富的特性和配置选项，使得开发者能够轻松构建灵活且可维护的Web应用程序。</p>
<h3 id="九-Springboot怎么整合Spring-Security"><a href="#九-Springboot怎么整合Spring-Security" class="headerlink" title="九.Springboot怎么整合Spring Security"></a>九.Springboot怎么整合Spring Security</h3><p>在 Spring Boot 中整合 Spring Security 相对简单，Spring Boot 提供了许多自动配置，你只需要添加依赖并进行一些基本配置即可。以下是整合 Spring Security 的基本步骤：</p>
<h4 id="1-添加-Spring-Security-依赖："><a href="#1-添加-Spring-Security-依赖：" class="headerlink" title="1. 添加 Spring Security 依赖："></a>1. 添加 Spring Security 依赖：</h4><p>在项目的 Maven 或 Gradle 配置文件中添加 Spring Security 的依赖。</p>
<h4 id="Maven"><a href="#Maven" class="headerlink" title="Maven:"></a>Maven:</h4><pre class="line-numbers language-markup" data-language="markup"><code class="language-markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependencies</span><span class="token punctuation">&gt;</span></span>
    <span class="token comment">&lt;!-- Spring Security --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-boot-starter-security<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependencies</span><span class="token punctuation">&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h4 id="Gradle"><a href="#Gradle" class="headerlink" title="Gradle:"></a>Gradle:</h4><pre class="line-numbers language-groovy" data-language="groovy"><code class="language-groovy">dependencies <span class="token punctuation">{</span>
    <span class="token comment">// Spring Security</span>
    implementation <span class="token string">'org.springframework.boot:spring-boot-starter-security'</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<h4 id="2-配置-Spring-Security："><a href="#2-配置-Spring-Security：" class="headerlink" title="2. 配置 Spring Security："></a>2. 配置 Spring Security：</h4><p>在 Spring Boot 项目中，你可以在 <code>application.properties</code> 或 <code>application.yml</code> 文件中进行基本配置。以下是一个简单的配置示例：</p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml"><span class="token comment"># application.yml</span>

<span class="token key atrule">spring</span><span class="token punctuation">:</span>
  <span class="token key atrule">security</span><span class="token punctuation">:</span>
    <span class="token key atrule">user</span><span class="token punctuation">:</span>
      <span class="token key atrule">name</span><span class="token punctuation">:</span> user
      <span class="token key atrule">password</span><span class="token punctuation">:</span> password
    <span class="token key atrule">basic</span><span class="token punctuation">:</span>
      <span class="token key atrule">enabled</span><span class="token punctuation">:</span> <span class="token boolean important">true</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>这个配置启用了基本的 HTTP 身份验证，并定义了一个默认用户（用户名：user，密码：password）。</p>
<h4 id="3-自定义配置："><a href="#3-自定义配置：" class="headerlink" title="3. 自定义配置："></a>3. 自定义配置：</h4><p>如果你需要进行更复杂的配置，例如定义哪些路径需要身份验证，如何处理登录和注销等，可以创建一个配置类并继承 <code>WebSecurityConfigurerAdapter</code>。</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>context<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Bean</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>context<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Configuration</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>security<span class="token punctuation">.</span>config<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span>web<span class="token punctuation">.</span>builders<span class="token punctuation">.</span></span><span class="token class-name">HttpSecurity</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>security<span class="token punctuation">.</span>config<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span>web<span class="token punctuation">.</span>configuration<span class="token punctuation">.</span></span><span class="token class-name">EnableWebSecurity</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>security<span class="token punctuation">.</span>crypto<span class="token punctuation">.</span>bcrypt<span class="token punctuation">.</span></span><span class="token class-name">BCryptPasswordEncoder</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>security<span class="token punctuation">.</span>crypto<span class="token punctuation">.</span>password<span class="token punctuation">.</span></span><span class="token class-name">PasswordEncoder</span></span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@Configuration</span>
<span class="token annotation punctuation">@EnableWebSecurity</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SecurityConfig</span> <span class="token keyword">extends</span> <span class="token class-name">WebSecurityConfigurerAdapter</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">configure</span><span class="token punctuation">(</span><span class="token class-name">HttpSecurity</span> http<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
        http
            <span class="token punctuation">.</span><span class="token function">authorizeRequests</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">antMatchers</span><span class="token punctuation">(</span><span class="token string">"/public/**"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">permitAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">anyRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">authenticated</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">and</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">formLogin</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">loginPage</span><span class="token punctuation">(</span><span class="token string">"/login"</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">permitAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">and</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">logout</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">logoutSuccessUrl</span><span class="token punctuation">(</span><span class="token string">"/"</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">permitAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Bean</span>
    <span class="token keyword">public</span> <span class="token class-name">PasswordEncoder</span> <span class="token function">passwordEncoder</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">BCryptPasswordEncoder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>上述配置示例定义了：</p>
<ul>
<li><code>/public/**</code> 路径下的所有请求不需要身份验证。</li>
<li>其他所有请求都需要身份验证。</li>
<li>配置了自定义登录页和登出操作。</li>
</ul>
<h4 id="4-添加用户和角色："><a href="#4-添加用户和角色：" class="headerlink" title="4. 添加用户和角色："></a>4. 添加用户和角色：</h4><p>你可以通过实现 <code>UserDetailsService</code> 接口或使用注解的方式来定义用户和角色信息。</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>security<span class="token punctuation">.</span>core<span class="token punctuation">.</span>userdetails<span class="token punctuation">.</span></span><span class="token class-name">User</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>security<span class="token punctuation">.</span>core<span class="token punctuation">.</span>userdetails<span class="token punctuation">.</span></span><span class="token class-name">UserDetails</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>security<span class="token punctuation">.</span>core<span class="token punctuation">.</span>userdetails<span class="token punctuation">.</span></span><span class="token class-name">UserDetailsService</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>security<span class="token punctuation">.</span>core<span class="token punctuation">.</span>userdetails<span class="token punctuation">.</span></span><span class="token class-name">UsernameNotFoundException</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>stereotype<span class="token punctuation">.</span></span><span class="token class-name">Service</span></span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@Service</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">CustomUserDetailsService</span> <span class="token keyword">implements</span> <span class="token class-name">UserDetailsService</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">UserDetails</span> <span class="token function">loadUserByUsername</span><span class="token punctuation">(</span><span class="token class-name">String</span> username<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">UsernameNotFoundException</span> <span class="token punctuation">{</span>
        <span class="token comment">// 实现自定义的用户加载逻辑，返回一个 UserDetails 对象</span>
        <span class="token keyword">return</span> <span class="token class-name">User</span><span class="token punctuation">.</span><span class="token function">withUsername</span><span class="token punctuation">(</span>username<span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">password</span><span class="token punctuation">(</span><span class="token string">"{noop}password"</span><span class="token punctuation">)</span> <span class="token comment">// 密码需要以明文形式存储，这里使用 {noop} 前缀表示明文</span>
            <span class="token punctuation">.</span><span class="token function">roles</span><span class="token punctuation">(</span><span class="token string">"USER"</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>这只是一个简单的入门示例，实际项目中可能需要更复杂的配置和自定义逻辑。Spring Security 提供了强大的功能，可以满足复杂的安全性需求。</p>
<h3 id="十-Spring-Security-与RBAC整合"><a href="#十-Spring-Security-与RBAC整合" class="headerlink" title="十.Spring Security 与RBAC整合"></a>十.Spring Security 与RBAC整合</h3><p>Spring Security 可以很容易与 RBAC（基于角色的访问控制）模型进行整合。在整合过程中，你可以使用 Spring Security 提供的注解和配置来定义角色和权限，并控制访问。以下是整合 Spring Security 和 RBAC 的一些建议：</p>
<h4 id="1-添加-Spring-Security-依赖：-1"><a href="#1-添加-Spring-Security-依赖：-1" class="headerlink" title="1. 添加 Spring Security 依赖："></a>1. <strong>添加 Spring Security 依赖：</strong></h4><p>在项目的 Maven 或 Gradle 配置文件中添加 Spring Security 的依赖。</p>
<h5 id="Maven-1"><a href="#Maven-1" class="headerlink" title="Maven:"></a>Maven:</h5><pre class="line-numbers language-markup" data-language="markup"><code class="language-markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependencies</span><span class="token punctuation">&gt;</span></span>
    <span class="token comment">&lt;!-- Spring Security --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-boot-starter-security<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependencies</span><span class="token punctuation">&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h5 id="Gradle-1"><a href="#Gradle-1" class="headerlink" title="Gradle:"></a>Gradle:</h5><pre class="line-numbers language-groovy" data-language="groovy"><code class="language-groovy">dependencies <span class="token punctuation">{</span>
    <span class="token comment">// Spring Security</span>
    implementation <span class="token string">'org.springframework.boot:spring-boot-starter-security'</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<h4 id="2-配置-Spring-Security：-1"><a href="#2-配置-Spring-Security：-1" class="headerlink" title="2. 配置 Spring Security："></a>2. <strong>配置 Spring Security：</strong></h4><p>在项目中创建一个配置类，继承 <code>WebSecurityConfigurerAdapter</code>，通过配置类定义角色和权限，以及访问规则。</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>context<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Bean</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>context<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Configuration</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>security<span class="token punctuation">.</span>config<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span>web<span class="token punctuation">.</span>builders<span class="token punctuation">.</span></span><span class="token class-name">HttpSecurity</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>security<span class="token punctuation">.</span>config<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span>web<span class="token punctuation">.</span>configuration<span class="token punctuation">.</span></span><span class="token class-name">EnableWebSecurity</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>security<span class="token punctuation">.</span>crypto<span class="token punctuation">.</span>bcrypt<span class="token punctuation">.</span></span><span class="token class-name">BCryptPasswordEncoder</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>security<span class="token punctuation">.</span>crypto<span class="token punctuation">.</span>password<span class="token punctuation">.</span></span><span class="token class-name">PasswordEncoder</span></span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@Configuration</span>
<span class="token annotation punctuation">@EnableWebSecurity</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SecurityConfig</span> <span class="token keyword">extends</span> <span class="token class-name">WebSecurityConfigurerAdapter</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">configure</span><span class="token punctuation">(</span><span class="token class-name">HttpSecurity</span> http<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
        http
            <span class="token punctuation">.</span><span class="token function">authorizeRequests</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">antMatchers</span><span class="token punctuation">(</span><span class="token string">"/public/**"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">permitAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">antMatchers</span><span class="token punctuation">(</span><span class="token string">"/admin/**"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">hasRole</span><span class="token punctuation">(</span><span class="token string">"ADMIN"</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">antMatchers</span><span class="token punctuation">(</span><span class="token string">"/user/**"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">hasRole</span><span class="token punctuation">(</span><span class="token string">"USER"</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">anyRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">authenticated</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">and</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">formLogin</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">loginPage</span><span class="token punctuation">(</span><span class="token string">"/login"</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">permitAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">and</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">logout</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">logoutSuccessUrl</span><span class="token punctuation">(</span><span class="token string">"/"</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">permitAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Bean</span>
    <span class="token keyword">public</span> <span class="token class-name">PasswordEncoder</span> <span class="token function">passwordEncoder</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">BCryptPasswordEncoder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>上述配置示例中：</p>
<ul>
<li><code>/public/**</code> 路径下的所有请求不需要身份验证。</li>
<li><code>/admin/**</code> 路径下的请求需要拥有 “ADMIN” 角色才能访问。</li>
<li><code>/user/**</code> 路径下的请求需要拥有 “USER” 角色才能访问。</li>
<li>其他所有请求需要身份验证。</li>
</ul>
<h4 id="3-用户角色和权限管理："><a href="#3-用户角色和权限管理：" class="headerlink" title="3. 用户角色和权限管理："></a>3. <strong>用户角色和权限管理：</strong></h4><p>可以通过实现 <code>UserDetailsService</code> 接口或使用注解的方式来定义用户和角色信息。</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>security<span class="token punctuation">.</span>core<span class="token punctuation">.</span>userdetails<span class="token punctuation">.</span></span><span class="token class-name">User</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>security<span class="token punctuation">.</span>core<span class="token punctuation">.</span>userdetails<span class="token punctuation">.</span></span><span class="token class-name">UserDetails</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>security<span class="token punctuation">.</span>core<span class="token punctuation">.</span>userdetails<span class="token punctuation">.</span></span><span class="token class-name">UserDetailsService</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>security<span class="token punctuation">.</span>core<span class="token punctuation">.</span>userdetails<span class="token punctuation">.</span></span><span class="token class-name">UsernameNotFoundException</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>stereotype<span class="token punctuation">.</span></span><span class="token class-name">Service</span></span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@Service</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">CustomUserDetailsService</span> <span class="token keyword">implements</span> <span class="token class-name">UserDetailsService</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">UserDetails</span> <span class="token function">loadUserByUsername</span><span class="token punctuation">(</span><span class="token class-name">String</span> username<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">UsernameNotFoundException</span> <span class="token punctuation">{</span>
        <span class="token comment">// 实现自定义的用户加载逻辑，返回一个 UserDetails 对象</span>
        <span class="token keyword">return</span> <span class="token class-name">User</span><span class="token punctuation">.</span><span class="token function">withUsername</span><span class="token punctuation">(</span>username<span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">password</span><span class="token punctuation">(</span><span class="token string">"{bcrypt}$2a$10$eVR0uFjMlG0EukF3h9WPH.FI5iY0wha6w4tY0FcRQ8O6zh5dm5IEe"</span><span class="token punctuation">)</span> <span class="token comment">// 使用 BCryptPasswordEncoder 加密的密码</span>
            <span class="token punctuation">.</span><span class="token function">roles</span><span class="token punctuation">(</span><span class="token string">"USER"</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h4 id="4-加密密码："><a href="#4-加密密码：" class="headerlink" title="4. 加密密码："></a>4. <strong>加密密码：</strong></h4><p>为了提高安全性，建议使用密码加密。上述示例中使用了 <code>BCryptPasswordEncoder</code> 加密密码。你可以使用其他加密方式，如 <code>PasswordEncoderFactories.createDelegatingPasswordEncoder()</code>。</p>
<h4 id="5-自定义访问决策管理器（可选）："><a href="#5-自定义访问决策管理器（可选）：" class="headerlink" title="5. 自定义访问决策管理器（可选）："></a>5. <strong>自定义访问决策管理器（可选）：</strong></h4><p>如果你有更复杂的访问控制需求，可以考虑实现自定义的访问决策管理器。</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>security<span class="token punctuation">.</span>access<span class="token punctuation">.</span></span><span class="token class-name">AccessDecisionManager</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>security<span class="token punctuation">.</span>access<span class="token punctuation">.</span></span><span class="token class-name">AccessDeniedException</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>security<span class="token punctuation">.</span>access<span class="token punctuation">.</span></span><span class="token class-name">ConfigAttribute</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>security<span class="token punctuation">.</span>core<span class="token punctuation">.</span></span><span class="token class-name">Authentication</span></span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">Collection</span></span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">CustomAccessDecisionManager</span> <span class="token keyword">implements</span> <span class="token class-name">AccessDecisionManager</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">decide</span><span class="token punctuation">(</span><span class="token class-name">Authentication</span> authentication<span class="token punctuation">,</span> <span class="token class-name">Object</span> object<span class="token punctuation">,</span> <span class="token class-name">Collection</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">ConfigAttribute</span><span class="token punctuation">&gt;</span></span> configAttributes<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">AccessDeniedException</span> <span class="token punctuation">{</span>
        <span class="token comment">// 自定义访问决策逻辑</span>
        <span class="token comment">// ...</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">supports</span><span class="token punctuation">(</span><span class="token class-name">ConfigAttribute</span> attribute<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">supports</span><span class="token punctuation">(</span><span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span></span> clazz<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>通过实现 <code>AccessDecisionManager</code> 接口，你可以实现自己的访问决策逻辑。</p>
<p>这只是一个基本示例，实际项目中可能需要更复杂的配置和自定义逻辑。Spring Security 提供了强大的功能，可以满足复杂的安全性需求。</p>
<h3 id="十一-Spring-Security实现接口的动态权限控制"><a href="#十一-Spring-Security实现接口的动态权限控制" class="headerlink" title="十一.Spring Security实现接口的动态权限控制"></a>十一.Spring Security实现接口的动态权限控制</h3><h4 id="1-实现方法"><a href="#1-实现方法" class="headerlink" title="1. 实现方法"></a>1. 实现方法</h4><h5 id="1-1-原先权限控制是采用Spring-Security的默认机制实现的，在需要权限的接口上使用-PreAuthorize注解定义好需要的权限，然后将该权限值存入到权限表中，当用户登录时，将其所拥有的权限查询出来"><a href="#1-1-原先权限控制是采用Spring-Security的默认机制实现的，在需要权限的接口上使用-PreAuthorize注解定义好需要的权限，然后将该权限值存入到权限表中，当用户登录时，将其所拥有的权限查询出来" class="headerlink" title="1.1. 原先权限控制是采用Spring Security的默认机制实现的，在需要权限的接口上使用@PreAuthorize注解定义好需要的权限，然后将该权限值存入到权限表中，当用户登录时，将其所拥有的权限查询出来"></a>1.1. 原先权限控制是采用Spring Security的默认机制实现的，在需要权限的接口上使用<code>@PreAuthorize</code>注解定义好需要的权限，然后将该权限值存入到权限表中，当用户登录时，将其所拥有的权限查询出来</h5><h5 id="1-2-之后Spring-Security把用户拥有的权限值和接口上注解定义的权限值进行比对，如果包含则可以访问，反之就不可以访问；"><a href="#1-2-之后Spring-Security把用户拥有的权限值和接口上注解定义的权限值进行比对，如果包含则可以访问，反之就不可以访问；" class="headerlink" title="1.2.  之后Spring Security把用户拥有的权限值和接口上注解定义的权限值进行比对，如果包含则可以访问，反之就不可以访问；"></a>1.2.  之后Spring Security把用户拥有的权限值和接口上注解定义的权限值进行比对，如果包含则可以访问，反之就不可以访问；</h5><h4 id="2-使用默认的权限控制产生的问题"><a href="#2-使用默认的权限控制产生的问题" class="headerlink" title="2. 使用默认的权限控制产生的问题"></a>2. 使用默认的权限控制产生的问题</h4><h5 id="2-1-需要在每个接口上都定义好访问该接口的权限值，而且只能挨个控制接口的权限，无法批量控制。其实每个接口都可以由它的访问路径唯一确定，我们可以使用基于路径的动态权限控制来解决这些问题。"><a href="#2-1-需要在每个接口上都定义好访问该接口的权限值，而且只能挨个控制接口的权限，无法批量控制。其实每个接口都可以由它的访问路径唯一确定，我们可以使用基于路径的动态权限控制来解决这些问题。" class="headerlink" title="2.1. 需要在每个接口上都定义好访问该接口的权限值，而且只能挨个控制接口的权限，无法批量控制。其实每个接口都可以由它的访问路径唯一确定，我们可以使用基于路径的动态权限控制来解决这些问题。"></a>2.1. 需要在每个接口上都定义好访问该接口的权限值，而且只能挨个控制接口的权限，无法批量控制。其实每个接口都可以由它的访问路径唯一确定，我们可以使用基于路径的动态权限控制来解决这些问题。</h5><h3 id="十二-Spring-Security实现基于路径的动态权限"><a href="#十二-Spring-Security实现基于路径的动态权限" class="headerlink" title="十二. Spring Security实现基于路径的动态权限"></a>十二. Spring Security实现基于路径的动态权限</h3><p>首先我们需要创建一个过滤器，用于实现动态权限控制，这里需要注意的是<code>doFilter</code>方法，对于OPTIONS请求直接放行，否则前端调用会出现跨域问题。对于配置在<code>IgnoreUrlsConfig</code>中的白名单路径我也需要直接放行，所有的鉴权操作都会在<code>super.beforeInvocation(fi)</code>中进行。</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">/**
 * 动态权限过滤器，用于实现基于路径的动态权限过滤
 * Created by macro on 2020/2/7.
 */</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">DynamicSecurityFilter</span> <span class="token keyword">extends</span> <span class="token class-name">AbstractSecurityInterceptor</span> <span class="token keyword">implements</span> <span class="token class-name">Filter</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Autowired</span>
    <span class="token keyword">private</span> <span class="token class-name">DynamicSecurityMetadataSource</span> dynamicSecurityMetadataSource<span class="token punctuation">;</span>
    <span class="token annotation punctuation">@Autowired</span>
    <span class="token keyword">private</span> <span class="token class-name">IgnoreUrlsConfig</span> ignoreUrlsConfig<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Autowired</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setMyAccessDecisionManager</span><span class="token punctuation">(</span><span class="token class-name">DynamicAccessDecisionManager</span> dynamicAccessDecisionManager<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">setAccessDecisionManager</span><span class="token punctuation">(</span>dynamicAccessDecisionManager<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">init</span><span class="token punctuation">(</span><span class="token class-name">FilterConfig</span> filterConfig<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">ServletException</span> <span class="token punctuation">{</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">doFilter</span><span class="token punctuation">(</span><span class="token class-name">ServletRequest</span> servletRequest<span class="token punctuation">,</span> <span class="token class-name">ServletResponse</span> servletResponse<span class="token punctuation">,</span> <span class="token class-name">FilterChain</span> filterChain<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span><span class="token punctuation">,</span> <span class="token class-name">ServletException</span> <span class="token punctuation">{</span>
        <span class="token class-name">HttpServletRequest</span> request <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">HttpServletRequest</span><span class="token punctuation">)</span> servletRequest<span class="token punctuation">;</span>
        <span class="token class-name">FilterInvocation</span> fi <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FilterInvocation</span><span class="token punctuation">(</span>servletRequest<span class="token punctuation">,</span> servletResponse<span class="token punctuation">,</span> filterChain<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//OPTIONS请求直接放行</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>request<span class="token punctuation">.</span><span class="token function">getMethod</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span><span class="token class-name">HttpMethod</span><span class="token punctuation">.</span><span class="token constant">OPTIONS</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            fi<span class="token punctuation">.</span><span class="token function">getChain</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">doFilter</span><span class="token punctuation">(</span>fi<span class="token punctuation">.</span><span class="token function">getRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> fi<span class="token punctuation">.</span><span class="token function">getResponse</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token comment">//白名单请求直接放行</span>
        <span class="token class-name">PathMatcher</span> pathMatcher <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">AntPathMatcher</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">String</span> path <span class="token operator">:</span> ignoreUrlsConfig<span class="token punctuation">.</span><span class="token function">getUrls</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span>pathMatcher<span class="token punctuation">.</span><span class="token function">match</span><span class="token punctuation">(</span>path<span class="token punctuation">,</span>request<span class="token punctuation">.</span><span class="token function">getRequestURI</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
                fi<span class="token punctuation">.</span><span class="token function">getChain</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">doFilter</span><span class="token punctuation">(</span>fi<span class="token punctuation">.</span><span class="token function">getRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> fi<span class="token punctuation">.</span><span class="token function">getResponse</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">return</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token comment">//此处会调用AccessDecisionManager中的decide方法进行鉴权操作</span>
        <span class="token class-name">InterceptorStatusToken</span> token <span class="token operator">=</span> <span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">beforeInvocation</span><span class="token punctuation">(</span>fi<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            fi<span class="token punctuation">.</span><span class="token function">getChain</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">doFilter</span><span class="token punctuation">(</span>fi<span class="token punctuation">.</span><span class="token function">getRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> fi<span class="token punctuation">.</span><span class="token function">getResponse</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">finally</span> <span class="token punctuation">{</span>
            <span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">afterInvocation</span><span class="token punctuation">(</span>token<span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">destroy</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span></span> <span class="token function">getSecureObjectClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token class-name">FilterInvocation</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">SecurityMetadataSource</span> <span class="token function">obtainSecurityMetadataSource</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> dynamicSecurityMetadataSource<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>在DynamicSecurityFilter中调用super.beforeInvocation(fi)方法时会调用AccessDecisionManager中的decide方法用于鉴权操作，而decide方法中的configAttributes参数会通过SecurityMetadataSource中的getAttributes方法来获取，configAttributes其实就是配置好的访问当前接口所需要的权限，下面是简化版的beforeInvocation源码。</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">abstract</span> <span class="token keyword">class</span> <span class="token class-name">AbstractSecurityInterceptor</span> <span class="token keyword">implements</span> <span class="token class-name">InitializingBean</span><span class="token punctuation">,</span>
		<span class="token class-name">ApplicationEventPublisherAware</span><span class="token punctuation">,</span> <span class="token class-name">MessageSourceAware</span> <span class="token punctuation">{</span>
    

<span class="token keyword">protected</span> <span class="token class-name">InterceptorStatusToken</span> <span class="token function">beforeInvocation</span><span class="token punctuation">(</span><span class="token class-name">Object</span> object<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        
        <span class="token comment">//获取元数据</span>
		<span class="token class-name">Collection</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">ConfigAttribute</span><span class="token punctuation">&gt;</span></span> attributes <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">obtainSecurityMetadataSource</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
				<span class="token punctuation">.</span><span class="token function">getAttributes</span><span class="token punctuation">(</span>object<span class="token punctuation">)</span><span class="token punctuation">;</span>

		<span class="token class-name">Authentication</span> authenticated <span class="token operator">=</span> <span class="token function">authenticateIfRequired</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

		<span class="token comment">//进行鉴权操作</span>
		<span class="token keyword">try</span> <span class="token punctuation">{</span>
			<span class="token keyword">this</span><span class="token punctuation">.</span>accessDecisionManager<span class="token punctuation">.</span><span class="token function">decide</span><span class="token punctuation">(</span>authenticated<span class="token punctuation">,</span> object<span class="token punctuation">,</span> attributes<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		<span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">AccessDeniedException</span> accessDeniedException<span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token function">publishEvent</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">AuthorizationFailureEvent</span><span class="token punctuation">(</span>object<span class="token punctuation">,</span> attributes<span class="token punctuation">,</span> authenticated<span class="token punctuation">,</span>
					accessDeniedException<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

			<span class="token keyword">throw</span> accessDeniedException<span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>需要自己实现SecurityMetadataSource接口的getAttributes方法，用于获取当前访问路径所需资源。</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">/**
 * 动态权限数据源，用于获取动态权限规则
 * Created by macro on 2020/2/7.
 */</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">DynamicSecurityMetadataSource</span> <span class="token keyword">implements</span> <span class="token class-name">FilterInvocationSecurityMetadataSource</span> <span class="token punctuation">{</span>

    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">ConfigAttribute</span><span class="token punctuation">&gt;</span></span> configAttributeMap <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
    <span class="token annotation punctuation">@Autowired</span>
    <span class="token keyword">private</span> <span class="token class-name">DynamicSecurityService</span> dynamicSecurityService<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@PostConstruct</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">loadDataSource</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        configAttributeMap <span class="token operator">=</span> dynamicSecurityService<span class="token punctuation">.</span><span class="token function">loadDataSource</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">clearDataSource</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        configAttributeMap<span class="token punctuation">.</span><span class="token function">clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        configAttributeMap <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">Collection</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">ConfigAttribute</span><span class="token punctuation">&gt;</span></span> <span class="token function">getAttributes</span><span class="token punctuation">(</span><span class="token class-name">Object</span> o<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IllegalArgumentException</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>configAttributeMap <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">loadDataSource</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">ConfigAttribute</span><span class="token punctuation">&gt;</span></span>  configAttributes <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//获取当前访问的路径</span>
        <span class="token class-name">String</span> url <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">FilterInvocation</span><span class="token punctuation">)</span> o<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getRequestUrl</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">String</span> path <span class="token operator">=</span> <span class="token class-name">URLUtil</span><span class="token punctuation">.</span><span class="token function">getPath</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">PathMatcher</span> pathMatcher <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">AntPathMatcher</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Iterator</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> iterator <span class="token operator">=</span> configAttributeMap<span class="token punctuation">.</span><span class="token function">keySet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">iterator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//获取访问该路径所需资源</span>
        <span class="token keyword">while</span> <span class="token punctuation">(</span>iterator<span class="token punctuation">.</span><span class="token function">hasNext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">String</span> pattern <span class="token operator">=</span> iterator<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>pathMatcher<span class="token punctuation">.</span><span class="token function">match</span><span class="token punctuation">(</span>pattern<span class="token punctuation">,</span> path<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                configAttributes<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>configAttributeMap<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>pattern<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token comment">// 未设置操作请求权限，返回空集合</span>
        <span class="token keyword">return</span> configAttributes<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">Collection</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">ConfigAttribute</span><span class="token punctuation">&gt;</span></span> <span class="token function">getAllConfigAttributes</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">supports</span><span class="token punctuation">(</span><span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span></span> aClass<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>由于后台资源规则被缓存在了一个Map对象之中，所以当后台资源发生变化时，我们需要清空缓存的数据，然后下次查询时就会被重新加载进来。这里我们需要修改UmsResourceController类，注入DynamicSecurityMetadataSource，当修改后台资源时，需要调用clearDataSource方法来清空缓存的数据。</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">/**
 * 后台资源管理Controller
 * Created by macro on 2020/2/4.
 */</span>
<span class="token annotation punctuation">@Controller</span>
<span class="token annotation punctuation">@Api</span><span class="token punctuation">(</span>tags <span class="token operator">=</span> <span class="token string">"UmsResourceController"</span><span class="token punctuation">,</span> description <span class="token operator">=</span> <span class="token string">"后台资源管理"</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">"/resource"</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">UmsResourceController</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Autowired</span>
    <span class="token keyword">private</span> <span class="token class-name">UmsResourceService</span> resourceService<span class="token punctuation">;</span>
    <span class="token annotation punctuation">@Autowired</span>
    <span class="token keyword">private</span> <span class="token class-name">DynamicSecurityMetadataSource</span> dynamicSecurityMetadataSource<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@ApiOperation</span><span class="token punctuation">(</span><span class="token string">"添加后台资源"</span><span class="token punctuation">)</span>
    <span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">"/create"</span><span class="token punctuation">,</span> method <span class="token operator">=</span> <span class="token class-name">RequestMethod</span><span class="token punctuation">.</span><span class="token constant">POST</span><span class="token punctuation">)</span>
    <span class="token annotation punctuation">@ResponseBody</span>
    <span class="token keyword">public</span> <span class="token class-name">CommonResult</span> <span class="token function">create</span><span class="token punctuation">(</span><span class="token annotation punctuation">@RequestBody</span> <span class="token class-name">UmsResource</span> umsResource<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">int</span> count <span class="token operator">=</span> resourceService<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>umsResource<span class="token punctuation">)</span><span class="token punctuation">;</span>
        dynamicSecurityMetadataSource<span class="token punctuation">.</span><span class="token function">clearDataSource</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>count <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token class-name">CommonResult</span><span class="token punctuation">.</span><span class="token function">success</span><span class="token punctuation">(</span>count<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token class-name">CommonResult</span><span class="token punctuation">.</span><span class="token function">failed</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
 <span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>我们需要实现AccessDecisionManager接口来实现权限校验，对于没有配置资源的接口我们直接允许访问，对于配置了资源的接口，我们把访问所需资源和用户拥有的资源进行比对，如果匹配则允许访问。</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">/**
 * 动态权限决策管理器，用于判断用户是否有访问权限
 * Created by macro on 2020/2/7.
 */</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">DynamicAccessDecisionManager</span> <span class="token keyword">implements</span> <span class="token class-name">AccessDecisionManager</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">decide</span><span class="token punctuation">(</span><span class="token class-name">Authentication</span> authentication<span class="token punctuation">,</span> <span class="token class-name">Object</span> object<span class="token punctuation">,</span>
                       <span class="token class-name">Collection</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">ConfigAttribute</span><span class="token punctuation">&gt;</span></span> configAttributes<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">AccessDeniedException</span><span class="token punctuation">,</span> <span class="token class-name">InsufficientAuthenticationException</span> <span class="token punctuation">{</span>
        <span class="token comment">// 当接口未被配置资源时直接放行</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name">CollUtil</span><span class="token punctuation">.</span><span class="token function">isEmpty</span><span class="token punctuation">(</span>configAttributes<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token class-name">Iterator</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">ConfigAttribute</span><span class="token punctuation">&gt;</span></span> iterator <span class="token operator">=</span> configAttributes<span class="token punctuation">.</span><span class="token function">iterator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">while</span> <span class="token punctuation">(</span>iterator<span class="token punctuation">.</span><span class="token function">hasNext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">ConfigAttribute</span> configAttribute <span class="token operator">=</span> iterator<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">//将访问所需资源或用户拥有资源进行比对</span>
            <span class="token class-name">String</span> needAuthority <span class="token operator">=</span> configAttribute<span class="token punctuation">.</span><span class="token function">getAttribute</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">GrantedAuthority</span> grantedAuthority <span class="token operator">:</span> authentication<span class="token punctuation">.</span><span class="token function">getAuthorities</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>needAuthority<span class="token punctuation">.</span><span class="token function">trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>grantedAuthority<span class="token punctuation">.</span><span class="token function">getAuthority</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    <span class="token keyword">return</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">AccessDeniedException</span><span class="token punctuation">(</span><span class="token string">"抱歉，您没有访问权限"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">supports</span><span class="token punctuation">(</span><span class="token class-name">ConfigAttribute</span> configAttribute<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">supports</span><span class="token punctuation">(</span><span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span></span> aClass<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>之前在DynamicSecurityMetadataSource中注入了一个DynamicSecurityService对象，它是我自定义的一个动态权限业务接口，其主要用于加载所有的后台资源规则。</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">/**
 * 动态权限相关业务接口
 * Created by macro on 2020/2/7.
 */</span>
<span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">DynamicSecurityService</span> <span class="token punctuation">{</span>
    <span class="token comment">/**
     * 加载资源ANT通配符和资源对应MAP
     */</span>
    <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">ConfigAttribute</span><span class="token punctuation">&gt;</span></span> <span class="token function">loadDataSource</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>需要修改Spring Security的配置类SecurityConfig，当有动态权限业务类时在FilterSecurityInterceptor过滤器前添加我们的动态权限过滤器。</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">/**
 * SpringSecurity相关配置，仅用于配置SecurityFilterChain
 * Created by macro on 2019/11/5.
 */</span>
<span class="token annotation punctuation">@Configuration</span>
<span class="token annotation punctuation">@EnableWebSecurity</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SecurityConfig</span> <span class="token punctuation">{</span>
    
    <span class="token annotation punctuation">@Autowired</span><span class="token punctuation">(</span>required <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">DynamicSecurityService</span> dynamicSecurityService<span class="token punctuation">;</span>
    <span class="token annotation punctuation">@Autowired</span><span class="token punctuation">(</span>required <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">DynamicSecurityFilter</span> dynamicSecurityFilter<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Bean</span>
    <span class="token class-name">SecurityFilterChain</span> <span class="token function">filterChain</span><span class="token punctuation">(</span><span class="token class-name">HttpSecurity</span> httpSecurity<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
        <span class="token class-name">ExpressionUrlAuthorizationConfigurer</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">HttpSecurity</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">.</span>ExpressionInterceptUrlRegistry registry <span class="token operator">=</span> httpSecurity
                <span class="token punctuation">.</span><span class="token function">authorizeRequests</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//省略若干代码...</span>
        <span class="token comment">//有动态权限配置时添加动态权限校验过滤器</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>dynamicSecurityService<span class="token operator">!=</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            registry<span class="token punctuation">.</span><span class="token function">and</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">addFilterBefore</span><span class="token punctuation">(</span>dynamicSecurityFilter<span class="token punctuation">,</span> <span class="token class-name">FilterSecurityInterceptor</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> httpSecurity<span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>在创建动态权限相关对象时，还使用了@ConditionalOnBean这个注解，当没有动态权限业务类时就不会创建动态权限相关对象，实现了有动态权限控制和没有这两种情况的兼容。</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">/**
 * SpringSecurity通用配置
 * 包括通用Bean、Security通用Bean及动态权限通用Bean
 * Created by macro on 2022/5/20.
 */</span>
<span class="token annotation punctuation">@Configuration</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">CommonSecurityConfig</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@ConditionalOnBean</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">"dynamicSecurityService"</span><span class="token punctuation">)</span>
    <span class="token annotation punctuation">@Bean</span>
    <span class="token keyword">public</span> <span class="token class-name">DynamicAccessDecisionManager</span> <span class="token function">dynamicAccessDecisionManager</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">DynamicAccessDecisionManager</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@ConditionalOnBean</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">"dynamicSecurityService"</span><span class="token punctuation">)</span>
    <span class="token annotation punctuation">@Bean</span>
    <span class="token keyword">public</span> <span class="token class-name">DynamicSecurityMetadataSource</span> <span class="token function">dynamicSecurityMetadataSource</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">DynamicSecurityMetadataSource</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@ConditionalOnBean</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">"dynamicSecurityService"</span><span class="token punctuation">)</span>
    <span class="token annotation punctuation">@Bean</span>
    <span class="token keyword">public</span> <span class="token class-name">DynamicSecurityFilter</span> <span class="token function">dynamicSecurityFilter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">DynamicSecurityFilter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>当前端跨域访问没有权限的接口时，会出现跨域问题，只需要在没有权限访问的处理类RestfulAccessDeniedHandler中添加允许跨域访问的响应头即可。</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">/**
 * 自定义返回结果：没有权限访问时
 * Created by macro on 2018/4/26.
 */</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">RestfulAccessDeniedHandler</span> <span class="token keyword">implements</span> <span class="token class-name">AccessDeniedHandler</span><span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">handle</span><span class="token punctuation">(</span><span class="token class-name">HttpServletRequest</span> request<span class="token punctuation">,</span>
                       <span class="token class-name">HttpServletResponse</span> response<span class="token punctuation">,</span>
                       <span class="token class-name">AccessDeniedException</span> e<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span><span class="token punctuation">,</span> <span class="token class-name">ServletException</span> <span class="token punctuation">{</span>
        response<span class="token punctuation">.</span><span class="token function">setHeader</span><span class="token punctuation">(</span><span class="token string">"Access-Control-Allow-Origin"</span><span class="token punctuation">,</span> <span class="token string">"*"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        response<span class="token punctuation">.</span><span class="token function">setHeader</span><span class="token punctuation">(</span><span class="token string">"Cache-Control"</span><span class="token punctuation">,</span><span class="token string">"no-cache"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        response<span class="token punctuation">.</span><span class="token function">setCharacterEncoding</span><span class="token punctuation">(</span><span class="token string">"UTF-8"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        response<span class="token punctuation">.</span><span class="token function">setContentType</span><span class="token punctuation">(</span><span class="token string">"application/json"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        response<span class="token punctuation">.</span><span class="token function">getWriter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token class-name">JSONUtil</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span><span class="token class-name">CommonResult</span><span class="token punctuation">.</span><span class="token function">forbidden</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span><span class="token function">getMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        response<span class="token punctuation">.</span><span class="token function">getWriter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">flush</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h3 id="十三-Mysql基础知识"><a href="#十三-Mysql基础知识" class="headerlink" title="十三. Mysql基础知识"></a>十三. Mysql基础知识</h3><h4 id="Mysql索引有哪些以及适用场景"><a href="#Mysql索引有哪些以及适用场景" class="headerlink" title="Mysql索引有哪些以及适用场景"></a>Mysql索引有哪些以及适用场景</h4><p>MySQL支持多种类型的索引，每种索引类型适用于不同的业务场景。选择合适的索引类型取决于数据库表的特点、查询模式和性能要求。以下是常见的MySQL索引类型及其适用场景：</p>
<h5 id="1-主键索引（Primary-Key-Index）："><a href="#1-主键索引（Primary-Key-Index）：" class="headerlink" title="1. 主键索引（Primary Key Index）："></a>1. 主键索引（Primary Key Index）：</h5><ul>
<li><strong>适用场景：</strong> 主键索引适用于唯一标识表中每一行数据的情况。通常用于表的主键列，确保每条记录都有唯一的标识。</li>
</ul>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> users <span class="token punctuation">(</span>
    user_id <span class="token keyword">INT</span> <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span><span class="token punctuation">,</span>
    username <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<h5 id="2-唯一索引（Unique-Index）："><a href="#2-唯一索引（Unique-Index）：" class="headerlink" title="2. 唯一索引（Unique Index）："></a>2. 唯一索引（Unique Index）：</h5><ul>
<li><strong>适用场景：</strong> 唯一索引确保索引列的值是唯一的，但允许存在空值。适用于需要保证数据唯一性的列。</li>
</ul>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> email_list <span class="token punctuation">(</span>
    email_id <span class="token keyword">INT</span><span class="token punctuation">,</span>
    email_address <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span> <span class="token keyword">UNIQUE</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<h5 id="3-普通索引（Normal-Index）："><a href="#3-普通索引（Normal-Index）：" class="headerlink" title="3. 普通索引（Normal Index）："></a>3. 普通索引（Normal Index）：</h5><ul>
<li><strong>适用场景：</strong> 普通索引是最基本的索引类型，用于加速查询。适用于经常被查询的列。</li>
</ul>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> products <span class="token punctuation">(</span>
    product_id <span class="token keyword">INT</span><span class="token punctuation">,</span>
    product_name <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token keyword">INDEX</span> index_name <span class="token punctuation">(</span>product_name<span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h5 id="4-全文索引（Full-Text-Index）："><a href="#4-全文索引（Full-Text-Index）：" class="headerlink" title="4. 全文索引（Full-Text Index）："></a>4. 全文索引（Full-Text Index）：</h5><ul>
<li><strong>适用场景：</strong> 全文索引用于全文搜索，适用于需要在大文本字段上进行搜索的场景，例如文章内容搜索。</li>
</ul>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> articles <span class="token punctuation">(</span>
    article_id <span class="token keyword">INT</span><span class="token punctuation">,</span>
    title <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    body <span class="token keyword">TEXT</span><span class="token punctuation">,</span>
    FULLTEXT <span class="token punctuation">(</span>title<span class="token punctuation">,</span> body<span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h5 id="5-空间索引（Spatial-Index）："><a href="#5-空间索引（Spatial-Index）：" class="headerlink" title="5. 空间索引（Spatial Index）："></a>5. 空间索引（Spatial Index）：</h5><ul>
<li><strong>适用场景：</strong> 空间索引用于地理空间数据类型的查询，适用于包含地理坐标的表。</li>
</ul>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> locations <span class="token punctuation">(</span>
    location_id <span class="token keyword">INT</span><span class="token punctuation">,</span>
    name <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    location <span class="token keyword">POINT</span><span class="token punctuation">,</span>
    SPATIAL <span class="token keyword">INDEX</span> <span class="token punctuation">(</span>location<span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h5 id="6-复合索引（Composite-Index）："><a href="#6-复合索引（Composite-Index）：" class="headerlink" title="6. 复合索引（Composite Index）："></a>6. 复合索引（Composite Index）：</h5><ul>
<li><strong>适用场景：</strong> 复合索引由多个列组成，适用于需要优化涉及这些列的查询。适用于多列联合查询。</li>
</ul>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> orders <span class="token punctuation">(</span>
    order_id <span class="token keyword">INT</span><span class="token punctuation">,</span>
    customer_id <span class="token keyword">INT</span><span class="token punctuation">,</span>
    product_id <span class="token keyword">INT</span><span class="token punctuation">,</span>
    <span class="token keyword">INDEX</span> index_name <span class="token punctuation">(</span>customer_id<span class="token punctuation">,</span> product_id<span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h5 id="7-前缀索引（Prefix-Index）："><a href="#7-前缀索引（Prefix-Index）：" class="headerlink" title="7. 前缀索引（Prefix Index）："></a>7. 前缀索引（Prefix Index）：</h5><ul>
<li><strong>适用场景：</strong> 前缀索引是对索引列的前缀进行索引，适用于需要减小索引大小的场景，提高查询性能。</li>
</ul>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> example <span class="token punctuation">(</span>
    id <span class="token keyword">INT</span><span class="token punctuation">,</span>
    name <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token keyword">INDEX</span> index_name <span class="token punctuation">(</span>name<span class="token punctuation">(</span><span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h5 id="8-组合索引："><a href="#8-组合索引：" class="headerlink" title="8. 组合索引："></a>8. 组合索引：</h5><ul>
<li><strong>适用场景：</strong> 将多个单列索引合并成一个索引，适用于多个列的多条件查询。</li>
</ul>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> employees <span class="token punctuation">(</span>
    employee_id <span class="token keyword">INT</span><span class="token punctuation">,</span>
    first_name <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    last_name <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token keyword">INDEX</span> index_name <span class="token punctuation">(</span>first_name<span class="token punctuation">,</span> last_name<span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>选择合适的索引类型取决于具体的业务需求和查询模式。需要注意的是，过多或不合理使用索引可能导致性能下降，因此在设计数据库时应谨慎考虑。了解查询模式、表的大小和数据分布等因素，有助于更好地选择和优化索引。</p>
<h4 id="2-Mysql的日志机制"><a href="#2-Mysql的日志机制" class="headerlink" title="2. Mysql的日志机制"></a>2. Mysql的日志机制</h4><p>MySQL的日志机制是其关键特性之一，它有助于确保数据库的可靠性、恢复性以及事务的一致性。MySQL主要包括以下几种日志：</p>
<h5 id="2-1-二进制日志（Binary-Log）："><a href="#2-1-二进制日志（Binary-Log）：" class="headerlink" title="2.1. 二进制日志（Binary Log）："></a>2.1. <strong>二进制日志（Binary Log）：</strong></h5><ul>
<li><p><strong>作用：</strong> 二进制日志记录了对数据库的修改操作，包括插入、更新和删除等。这个日志使得在数据库发生故障时，可以通过重新执行二进制日志中的操作来进行恢复。</p>
</li>
<li><p><strong>文件名：</strong> 通常以 <code>mysql-bin.xxxxxx</code> 形式存在，每个文件对应一段时间内的日志。</p>
</li>
<li><p><strong>配置：</strong> 可以通过配置文件中的 <code>log_bin</code> 来启用或禁用二进制日志。</p>
</li>
</ul>
<pre class="line-numbers language-ini" data-language="ini"><code class="language-ini"><span class="token comment"># 启用二进制日志</span>
<span class="token key attr-name">log_bin</span> <span class="token punctuation">=</span> <span class="token value attr-value">/path/to/mysql-bin</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<h5 id="2-2-错误日志（Error-Log）："><a href="#2-2-错误日志（Error-Log）：" class="headerlink" title="2.2. 错误日志（Error Log）："></a>2.2. <strong>错误日志（Error Log）：</strong></h5><ul>
<li><p><strong>作用：</strong> 错误日志记录了MySQL服务器运行时的错误和警告信息，有助于诊断问题。</p>
</li>
<li><p><strong>文件名：</strong> 通常以 <code>hostname.err</code> 形式存在。</p>
</li>
<li><p><strong>配置：</strong> 可以通过配置文件中的 <code>log_error</code> 来指定错误日志的位置。</p>
</li>
</ul>
<pre class="line-numbers language-ini" data-language="ini"><code class="language-ini"><span class="token comment"># 指定错误日志文件位置</span>
<span class="token key attr-name">log_error</span> <span class="token punctuation">=</span> <span class="token value attr-value">/path/to/error.log</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<h5 id="2-3-查询日志（Query-Log）："><a href="#2-3-查询日志（Query-Log）：" class="headerlink" title="2.3.  查询日志（Query Log）："></a>2.3.  <strong>查询日志（Query Log）：</strong></h5><ul>
<li><p><strong>作用：</strong> 查询日志记录了MySQL服务器收到的所有SQL查询语句，可用于审计和分析查询性能。</p>
</li>
<li><p><strong>文件名：</strong> 通常以 <code>hostname-slow.log</code> 形式存在，记录慢查询。</p>
</li>
<li><p><strong>配置：</strong> 可以通过配置文件中的 <code>slow_query_log</code> 来启用或禁用慢查询日志。</p>
</li>
</ul>
<pre class="line-numbers language-ini" data-language="ini"><code class="language-ini"><span class="token comment"># 启用慢查询日志</span>
<span class="token key attr-name">slow_query_log</span> <span class="token punctuation">=</span> <span class="token value attr-value">1</span>
<span class="token comment"># 指定慢查询日志文件位置</span>
<span class="token key attr-name">slow_query_log_file</span> <span class="token punctuation">=</span> <span class="token value attr-value">/path/to/slow-query.log</span>
<span class="token comment"># 阈值，执行时间超过该值的查询会被记录</span>
<span class="token key attr-name">long_query_time</span> <span class="token punctuation">=</span> <span class="token value attr-value">1.0</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h5 id="2-4-更新日志（Update-Log）："><a href="#2-4-更新日志（Update-Log）：" class="headerlink" title="2.4. 更新日志（Update Log）："></a>2.4. <strong>更新日志（Update Log）：</strong></h5><ul>
<li><p><strong>作用：</strong> 更新日志用于记录某些数据更改的信息，包括对InnoDB表中的聚簇索引进行的修改。</p>
</li>
<li><p><strong>文件名：</strong> 通常以 <code>hostname.ibd</code> 形式存在。</p>
</li>
<li><p><strong>配置：</strong> 可以通过配置文件中的 <code>innodb_log_file_size</code> 和 <code>innodb_log_files_in_group</code> 来配置InnoDB的更新日志。</p>
</li>
</ul>
<pre class="line-numbers language-ini" data-language="ini"><code class="language-ini"><span class="token comment"># 更新日志文件大小</span>
<span class="token key attr-name">innodb_log_file_size</span> <span class="token punctuation">=</span> <span class="token value attr-value">50M</span>
<span class="token comment"># 更新日志文件组数</span>
<span class="token key attr-name">innodb_log_files_in_group</span> <span class="token punctuation">=</span> <span class="token value attr-value">2</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<h5 id="2-5-慢查询日志（Slow-Query-Log）："><a href="#2-5-慢查询日志（Slow-Query-Log）：" class="headerlink" title="2.5. 慢查询日志（Slow Query Log）："></a>2.5. <strong>慢查询日志（Slow Query Log）：</strong></h5><ul>
<li><p><strong>作用：</strong> 慢查询日志记录执行时间超过一定阈值的SQL查询语句，用于识别和优化性能较差的查询。</p>
</li>
<li><p><strong>文件名：</strong> 通常以 <code>hostname-slow.log</code> 形式存在。</p>
</li>
<li><p><strong>配置：</strong> 可以通过配置文件中的 <code>slow_query_log</code> 来启用或禁用慢查询日志。</p>
</li>
</ul>
<pre class="line-numbers language-ini" data-language="ini"><code class="language-ini"><span class="token comment"># 启用慢查询日志</span>
<span class="token key attr-name">slow_query_log</span> <span class="token punctuation">=</span> <span class="token value attr-value">1</span>
<span class="token comment"># 指定慢查询日志文件位置</span>
<span class="token key attr-name">slow_query_log_file</span> <span class="token punctuation">=</span> <span class="token value attr-value">/path/to/slow-query.log</span>
<span class="token comment"># 阈值，执行时间超过该值的查询会被记录</span>
<span class="token key attr-name">long_query_time</span> <span class="token punctuation">=</span> <span class="token value attr-value">1.0</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>这些日志一起构成了MySQL强大的日志机制，为数据库的运维、调优和故障恢复提供了有力的支持。根据具体的需求，可以配置这些日志，以满足特定的业务和管理要求。</p>
<h4 id="3-Mysql事务机制与隔离级别"><a href="#3-Mysql事务机制与隔离级别" class="headerlink" title="3. Mysql事务机制与隔离级别"></a>3. Mysql事务机制与隔离级别</h4><p>MySQL的事务机制和隔离级别是数据库管理系统中的重要组成部分，用于确保数据的一致性、隔离性、持久性和原子性。以下是MySQL的事务机制和隔离级别的基本概念：</p>
<h5 id="1-事务机制："><a href="#1-事务机制：" class="headerlink" title="1. 事务机制："></a>1. <strong>事务机制：</strong></h5><ul>
<li><p><strong>事务（Transaction）：</strong> 事务是一系列SQL语句的执行，它们被视为一个原子操作，要么全部执行成功，要么全部失败回滚。MySQL使用事务来确保数据库的完整性和一致性。</p>
</li>
<li><p><strong>事务控制语句：</strong></p>
<ul>
<li><code>START TRANSACTION;</code>：开始一个新的事务。</li>
<li><code>COMMIT;</code>：提交事务，使得事务中的所有操作生效。</li>
<li><code>ROLLBACK;</code>：回滚事务，撤销事务中的所有操作。</li>
</ul>
</li>
<li><p><strong>事务的ACID属性：</strong></p>
<ul>
<li><strong>原子性（Atomicity）：</strong> 事务是一个原子操作，要么全部执行成功，要么全部失败回滚。</li>
<li><strong>一致性（Consistency）：</strong> 事务执行后，数据库从一个一致性状态转移到另一个一致性状态。</li>
<li><strong>隔离性（Isolation）：</strong> 事务的执行应该与其他事务隔离，互不干扰。</li>
<li><strong>持久性（Durability）：</strong> 一旦事务提交，其结果应该是永久性的。</li>
</ul>
</li>
</ul>
<h5 id="2-隔离级别（Isolation-Levels）："><a href="#2-隔离级别（Isolation-Levels）：" class="headerlink" title="2. 隔离级别（Isolation Levels）："></a>2. <strong>隔离级别（Isolation Levels）：</strong></h5><p>MySQL支持多个事务隔离级别，用于控制事务之间的可见性和并发性。隔离级别定义了一个事务内的操作对其他事务的影响程度。MySQL支持的隔离级别包括：</p>
<ul>
<li><p><strong>READ UNCOMMITTED（读未提交）：</strong> 允许读取其他事务未提交的数据。可能导致脏读、不可重复读和幻读。</p>
</li>
<li><p><strong>READ COMMITTED（读已提交）：</strong> 一个事务只能读取已经提交的其他事务的数据。避免了脏读，但仍可能发生不可重复读和幻读。</p>
</li>
<li><p><strong>REPEATABLE READ（可重复读）：</strong> 保证在同一事务中多次读取相同记录时，结果是一致的。避免了脏读和不可重复读，但仍可能发生幻读。</p>
</li>
<li><p><strong>SERIALIZABLE（串行化）：</strong> 最高的隔离级别，通过强制事务串行执行来避免脏读、不可重复读和幻读。性能较差，一般情况下很少使用。</p>
</li>
<li><p><strong>默认隔离级别：</strong> MySQL的默认隔离级别是REPEATABLE READ。</p>
</li>
<li><p><strong>设置隔离级别：</strong> 可以通过<code>SET TRANSACTION ISOLATION LEVEL</code>语句设置事务的隔离级别。</p>
</li>
</ul>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token comment">-- 设置隔离级别为READ COMMITTED</span>
<span class="token keyword">SET</span> <span class="token keyword">TRANSACTION</span> <span class="token keyword">ISOLATION</span> <span class="token keyword">LEVEL</span> <span class="token keyword">READ</span> <span class="token keyword">COMMITTED</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p>选择适当的隔离级别取决于应用程序的需求和性能要求。较高的隔离级别通常会导致更多的锁和性能开销，因此需要在一致性和性能之间进行权衡。在高并发环境中，了解隔离级别对事务并发性和数据一致性的影响非常重要。</p>
<h4 id="4-SQL的优化策略"><a href="#4-SQL的优化策略" class="headerlink" title="4. SQL的优化策略"></a>4. SQL的优化策略</h4><p>SQL优化是数据库性能优化的重要组成部分，它旨在提高查询性能、减少资源消耗以及优化数据库结构。以下是一些常见的SQL优化策略：</p>
<h5 id="1-使用合适的索引："><a href="#1-使用合适的索引：" class="headerlink" title="1. 使用合适的索引："></a>1. <strong>使用合适的索引：</strong></h5><ul>
<li><strong>创建索引：</strong> 在经常用于检索和过滤的列上创建索引，可以显著提高查询性能。</li>
<li><strong>复合索引：</strong> 对多个列创建复合索引，以支持联合查询。</li>
<li><strong>避免过多索引：</strong> 过多的索引可能导致性能下降，因此需要权衡。</li>
</ul>
<h5 id="2-优化查询语句："><a href="#2-优化查询语句：" class="headerlink" title="2. 优化查询语句："></a>2. <strong>优化查询语句：</strong></h5><ul>
<li>*<em>避免使用SELECT <em>：</em></em> 只选择实际需要的列，减少数据传输和IO开销。</li>
<li><strong>使用LIMIT：</strong> 对于不需要检索全部结果的查询，使用LIMIT限制返回的行数。</li>
<li><strong>避免使用SELECT DISTINCT：</strong> 如果可能，尽量避免使用DISTINCT关键字。</li>
</ul>
<h5 id="3-合理使用JOIN操作："><a href="#3-合理使用JOIN操作：" class="headerlink" title="3. 合理使用JOIN操作："></a>3. <strong>合理使用JOIN操作：</strong></h5><ul>
<li><strong>选择合适的JOIN类型：</strong> 根据查询需求选择INNER JOIN、LEFT JOIN等。</li>
<li><strong>避免笛卡尔积：</strong> 确保关联条件的正确性，避免产生不必要的笛卡尔积。</li>
</ul>
<h5 id="4-使用合适的数据类型："><a href="#4-使用合适的数据类型：" class="headerlink" title="4. 使用合适的数据类型："></a>4. <strong>使用合适的数据类型：</strong></h5><ul>
<li><strong>选择合适的数据类型：</strong> 使用尽可能小的数据类型，减少存储和IO开销。</li>
<li><strong>避免在WHERE子句中对列进行函数操作：</strong> 这可能导致索引失效。</li>
</ul>
<h5 id="5-定期分析和优化表结构："><a href="#5-定期分析和优化表结构：" class="headerlink" title="5. 定期分析和优化表结构："></a>5. <strong>定期分析和优化表结构：</strong></h5><ul>
<li><strong>规范化数据库：</strong> 将数据规范化以减少重复数据，提高数据一致性。</li>
<li><strong>使用合适的存储引擎：</strong> 不同的存储引擎适用于不同的使用场景。</li>
</ul>
<h5 id="6-使用缓存："><a href="#6-使用缓存：" class="headerlink" title="6. 使用缓存："></a>6. <strong>使用缓存：</strong></h5><ul>
<li><strong>数据库缓存：</strong> 使用数据库自身的查询缓存或者外部缓存系统。</li>
<li><strong>应用程序缓存：</strong> 缓存查询结果，减少对数据库的访问。</li>
</ul>
<h5 id="7-分析执行计划："><a href="#7-分析执行计划：" class="headerlink" title="7. 分析执行计划："></a>7. <strong>分析执行计划：</strong></h5><ul>
<li><strong>EXPLAIN语句：</strong> 使用EXPLAIN语句查看查询执行计划，了解索引使用情况和查询优化器的决策。</li>
<li><strong>优化执行计划：</strong> 根据执行计划进行调整，可能需要调整索引、重写查询等。</li>
</ul>
<h5 id="8-定期维护统计信息："><a href="#8-定期维护统计信息：" class="headerlink" title="8. 定期维护统计信息："></a>8. <strong>定期维护统计信息：</strong></h5><ul>
<li><strong>统计信息：</strong> 确保数据库收集和维护表的统计信息，以供查询优化器使用。</li>
<li><strong>定期分析性能：</strong> 定期监控数据库性能，识别慢查询，进行调整。</li>
</ul>
<h5 id="9-分区表："><a href="#9-分区表：" class="headerlink" title="9. 分区表："></a>9. <strong>分区表：</strong></h5><ul>
<li><strong>表分区：</strong> 对大表进行分区，可以提高查询性能和维护效率。</li>
</ul>
<h5 id="10-使用连接池："><a href="#10-使用连接池：" class="headerlink" title="10. 使用连接池："></a>10. <strong>使用连接池：</strong></h5><ul>
<li><strong>连接池：</strong> 使用连接池减少数据库连接的开销，提高性能。</li>
</ul>
<p>这些优化策略通常需要综合考虑，因为优化不同类型的查询和操作可能需要不同的方法。在进行SQL优化时，重要的是监测和分析实际的数据库性能，并根据需求调整和优化。</p>
<h4 id="5-Mysql的存储引擎"><a href="#5-Mysql的存储引擎" class="headerlink" title="5. Mysql的存储引擎"></a>5. Mysql的存储引擎</h4><p>MySQL支持多种存储引擎（Storage Engine），它们是底层负责数据的存储和检索的模块。每个存储引擎都有其特定的优势和适用场景。以下是一些常见的MySQL存储引擎：</p>
<h5 id="1-InnoDB："><a href="#1-InnoDB：" class="headerlink" title="1. InnoDB："></a>1. <strong>InnoDB：</strong></h5><ul>
<li><p><strong>特点：</strong></p>
<ul>
<li><strong>事务支持：</strong> 支持ACID事务，适合要求数据完整性和一致性的应用。</li>
<li><strong>行级锁定：</strong> 提供行级锁定，减少了读写冲突。</li>
<li><strong>外键支持：</strong> 支持外键约束，确保数据的完整性。</li>
<li><strong>崩溃恢复：</strong> 支持崩溃恢复，数据库恢复到崩溃前的状态。</li>
</ul>
</li>
<li><p><strong>适用场景：</strong> 适用于事务处理和具有高并发读写需求的应用。</p>
</li>
</ul>
<h5 id="2-MyISAM："><a href="#2-MyISAM：" class="headerlink" title="2. MyISAM："></a>2. <strong>MyISAM：</strong></h5><ul>
<li><p><strong>特点：</strong></p>
<ul>
<li><strong>表级锁定：</strong> 使用表级锁定，可能导致并发写入性能较差。</li>
<li><strong>无事务支持：</strong> 不支持事务和回滚。</li>
<li><strong>全文索引：</strong> 支持全文索引，适用于搜索引擎等应用。</li>
<li><strong>压缩表：</strong> 支持表级别的压缩。</li>
</ul>
</li>
<li><p><strong>适用场景：</strong> 适用于读密集型、插入和查询频繁的应用，如数据仓库和日志分析。</p>
</li>
</ul>
<h5 id="3-MEMORY-HEAP-："><a href="#3-MEMORY-HEAP-：" class="headerlink" title="3. MEMORY (HEAP)："></a>3. <strong>MEMORY (HEAP)：</strong></h5><ul>
<li><p><strong>特点：</strong></p>
<ul>
<li><strong>内存表：</strong> 数据存储在内存中，提供快速的读写访问。</li>
<li><strong>表级锁定：</strong> 使用表级锁定，适用于小型临时表。</li>
<li><strong>数据不持久：</strong> 数据在数据库关闭时丢失，适用于临时数据存储。</li>
</ul>
</li>
<li><p><strong>适用场景：</strong> 适用于需要快速读写访问的临时表，但不要求数据持久性的场景。</p>
</li>
</ul>
<h5 id="4-ARCHIVE："><a href="#4-ARCHIVE：" class="headerlink" title="4. ARCHIVE："></a>4. <strong>ARCHIVE：</strong></h5><ul>
<li><p><strong>特点：</strong></p>
<ul>
<li><strong>压缩表：</strong> 适用于高度压缩的归档数据。</li>
<li><strong>只支持INSERT和SELECT：</strong> 不支持更新和删除操作。</li>
<li><strong>表级锁定：</strong> 使用表级锁定。</li>
</ul>
</li>
<li><p><strong>适用场景：</strong> 适用于存档数据，以便占用更少的磁盘空间。</p>
</li>
</ul>
<h5 id="5-CSV："><a href="#5-CSV：" class="headerlink" title="5. CSV："></a>5. <strong>CSV：</strong></h5><ul>
<li><p><strong>特点：</strong></p>
<ul>
<li><strong>CSV格式：</strong> 数据以CSV格式存储。</li>
<li><strong>支持读写：</strong> 支持读写操作。</li>
<li><strong>表级锁定：</strong> 使用表级锁定。</li>
</ul>
</li>
<li><p><strong>适用场景：</strong> 适用于需要将MySQL数据导出为CSV文件或导入CSV文件的场景。</p>
</li>
</ul>
<h5 id="6-其他存储引擎："><a href="#6-其他存储引擎：" class="headerlink" title="6. 其他存储引擎："></a>6. <strong>其他存储引擎：</strong></h5><p>MySQL还支持其他存储引擎，如Blackhole、Federated、NDB Cluster等。这些存储引擎各自具有特定的优势和适用场景，可以根据实际需求选择合适的存储引擎。</p>
<p>在MySQL中，可以根据表的需求选择不同的存储引擎，甚至在同一数据库中的不同表使用不同的存储引擎。选择存储引擎时需要考虑事务支持、锁定级别、性能特性、数据完整性等因素。</p>
<h3 id="十四-Elasticsearch基础知识"><a href="#十四-Elasticsearch基础知识" class="headerlink" title="十四. Elasticsearch基础知识"></a>十四. Elasticsearch基础知识</h3><p>Elasticsearch是一个开源的分布式搜索和分析引擎，建立在Apache Lucene基础上。它提供了强大的全文搜索、分析和数据可视化功能，适用于大规模数据的实时搜索和分析。以下是Elasticsearch的一些基础知识：</p>
<h4 id="1-核心概念：-1"><a href="#1-核心概念：-1" class="headerlink" title="1. 核心概念："></a>1. <strong>核心概念：</strong></h4><ul>
<li><strong>Document（文档）：</strong> Elasticsearch存储的基本数据单元，通常用JSON格式表示。</li>
<li><strong>Index（索引）：</strong> 一组相关文档的集合，每个文档都属于一个索引。</li>
<li><strong>Type（类型）：</strong> 在过去的版本中，文档可以根据其类型进行组织，但在最新版本中逐渐被废弃，建议将所有文档放在一个类型中。</li>
<li><strong>Node（节点）：</strong> 单个运行的Elasticsearch实例。</li>
<li><strong>Cluster（集群）：</strong> 由一个或多个节点组成，共同保存整个数据集并提供跨所有节点的搜索和索引功能。</li>
</ul>
<h4 id="2-RESTful-API："><a href="#2-RESTful-API：" class="headerlink" title="2. RESTful API："></a>2. <strong>RESTful API：</strong></h4><p>Elasticsearch提供了RESTful API，通过HTTP与其进行交互。常见的API操作包括：</p>
<ul>
<li><strong>Index API：</strong> 创建、删除索引。</li>
<li><strong>Document API：</strong> 增、删、改、查文档。</li>
<li><strong>Search API：</strong> 执行全文搜索和复杂查询。</li>
<li><strong>Aggregations API：</strong> 数据聚合和分析。</li>
</ul>
<h4 id="3-Mapping（映射）："><a href="#3-Mapping（映射）：" class="headerlink" title="3. Mapping（映射）："></a>3. <strong>Mapping（映射）：</strong></h4><ul>
<li><strong>Mapping定义了文档的字段和类型。</strong> 在创建索引时，可以显式定义映射，也可以使用动态映射，让Elasticsearch自动推断字段类型。</li>
</ul>
<h4 id="4-分布式搜索和分析："><a href="#4-分布式搜索和分析：" class="headerlink" title="4. 分布式搜索和分析："></a>4. <strong>分布式搜索和分析：</strong></h4><ul>
<li>Elasticsearch是分布式的，能够水平扩展。数据被分成多个分片，每个分片可以在不同的节点上，从而提高搜索和分析的性能。</li>
</ul>
<h4 id="5-倒排索引："><a href="#5-倒排索引：" class="headerlink" title="5. 倒排索引："></a>5. <strong>倒排索引：</strong></h4><ul>
<li><p>Elasticsearch基于Lucene的倒排索引（Inverted Index）。这种索引结构允许快速的全文搜索，通过跟踪每个词在哪些文档中出现来实现。</p>
<p>倒排索引（Inverted Index）是Elasticsearch中一种核心的数据结构，用于支持全文搜索和快速的文本查询。与传统的顺序索引不同，倒排索引存储了词项（terms）到文档的映射关系，而不是文档到词项的关系。这种索引结构使得在大量文档中高效地执行搜索变得可能。</p>
<p>以下是倒排索引的关键概念：</p>
<h5 id="5-1-词项（Terms）："><a href="#5-1-词项（Terms）：" class="headerlink" title="5.1. 词项（Terms）："></a>5.1. <strong>词项（Terms）：</strong></h5><ul>
<li>词项是文档中的单词或标记，通常通过分析文本得到。在倒排索引中，每个词项都是索引的一个条目。</li>
</ul>
<h5 id="5-2-文档（Documents）："><a href="#5-2-文档（Documents）：" class="headerlink" title="5.2. 文档（Documents）："></a>5.2. <strong>文档（Documents）：</strong></h5><ul>
<li>文档是要被索引的基本单位。在倒排索引中，每个文档都与其包含的词项列表相关联。</li>
</ul>
<h5 id="5-3-倒排列表（Inverted-List）："><a href="#5-3-倒排列表（Inverted-List）：" class="headerlink" title="5.3. 倒排列表（Inverted List）："></a>5.3. <strong>倒排列表（Inverted List）：</strong></h5><ul>
<li>对于每个词项，倒排索引维护一个称为倒排列表的数据结构。倒排列表存储了包含该词项的所有文档的引用或位置。</li>
</ul>
<h5 id="5-4-倒排索引的建立过程："><a href="#5-4-倒排索引的建立过程：" class="headerlink" title="5.4. 倒排索引的建立过程："></a>5.4. <strong>倒排索引的建立过程：</strong></h5><pre><code>  1. **文本分析：** 对文档中的文本进行分析，将其拆分为词项。
  2. **建立倒排列表：** 对于每个词项，记录包含该词项的文档和它们的位置信息。
  3. **构建倒排索引：** 将所有的倒排列表组合在一起，形成完整的倒排索引。
</code></pre>
<h5 id="5-5-查询过程："><a href="#5-5-查询过程：" class="headerlink" title="5.5. 查询过程："></a>5.5. <strong>查询过程：</strong></h5><ul>
<li>当执行搜索时，查询的词项会被映射到倒排索引中，检索相关文档的引用，然后通过这些引用找到实际的文档数据。这使得搜索非常高效，因为不需要扫描整个文档集合。</li>
</ul>
<h5 id="5-6-权重和评分："><a href="#5-6-权重和评分：" class="headerlink" title="5.6. 权重和评分："></a>5.6. <strong>权重和评分：</strong></h5><ul>
<li>倒排索引不仅记录了文档的存在，还可以存储关于文档的其他信息，如词频、位置信息等。这些信息用于计算文档的相关性，从而为搜索结果进行排序。</li>
</ul>
<p>倒排索引是Elasticsearch实现强大全文搜索的关键之一。它的设计使得搜索和检索过程变得高效，特别适用于需要在大量文档中进行复杂查询的场景，比如全文搜索引擎、日志分析等。</p>
</li>
</ul>
<h4 id="6-实时性："><a href="#6-实时性：" class="headerlink" title="6. 实时性："></a>6. <strong>实时性：</strong></h4><ul>
<li>Elasticsearch提供了实时（near real-time）搜索和分析，文档的索引和搜索几乎是实时的，适用于需要快速响应的场景。</li>
</ul>
<h4 id="7-插件和生态系统："><a href="#7-插件和生态系统：" class="headerlink" title="7. 插件和生态系统："></a>7. <strong>插件和生态系统：</strong></h4><ul>
<li>Elasticsearch具有丰富的插件生态系统，可以通过插件扩展其功能，例如Kibana用于数据可视化，Logstash用于日志处理。</li>
</ul>
<h4 id="8-安全性："><a href="#8-安全性：" class="headerlink" title="8. 安全性："></a>8. <strong>安全性：</strong></h4><ul>
<li>Elasticsearch提供安全功能，包括身份验证、授权和传输层加密，以保护数据的安全性。</li>
</ul>
<h4 id="9-监控和集群管理："><a href="#9-监控和集群管理：" class="headerlink" title="9. 监控和集群管理："></a>9. <strong>监控和集群管理：</strong></h4><ul>
<li>Elasticsearch提供了监控和集群管理工具，例如X-Pack插件，可用于实时监控和管理集群。</li>
</ul>
<p>Elasticsearch被广泛应用于各种场景，包括日志和事件数据分析、全文搜索、指标分析等。由于其灵活性和强大的搜索能力，它成为处理大规模数据集的理想选择。</p>
<h4 id="10-es实现分词搜索："><a href="#10-es实现分词搜索：" class="headerlink" title="10. **es实现分词搜索： **"></a>10. **es实现分词搜索： **</h4><p>在Elasticsearch中，分词搜索是通过全文搜索实现的。全文搜索涉及将文本分析为单独的词项，然后在倒排索引中搜索这些词项。以下是使用Elasticsearch实现分词搜索的基本步骤：</p>
<h5 id="10-1-创建索引："><a href="#10-1-创建索引：" class="headerlink" title="10.1. 创建索引："></a>10.1. <strong>创建索引：</strong></h5><p>在Elasticsearch中，首先需要创建一个索引，用于存储文档和构建倒排索引。索引定义了文档的映射和分析器等信息。</p>
<pre class="line-numbers language-json" data-language="json"><code class="language-json">PUT /my_index
<span class="token punctuation">{</span>
  <span class="token property">"mappings"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">"properties"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">"content"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">"type"</span><span class="token operator">:</span> <span class="token string">"text"</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>上述示例中，创建了一个名为<code>my_index</code>的索引，并定义了一个字段<code>content</code>，类型为<code>text</code>，表示这个字段将被用于全文搜索。</p>
<h5 id="10-2-添加文档："><a href="#10-2-添加文档：" class="headerlink" title="10.2. 添加文档："></a>10.2. <strong>添加文档：</strong></h5><p>向索引中添加包含需要搜索的文本的文档。</p>
<pre class="line-numbers language-json" data-language="json"><code class="language-json">POST /my_index/_doc/<span class="token number">1</span>
<span class="token punctuation">{</span>
  <span class="token property">"content"</span><span class="token operator">:</span> <span class="token string">"Elasticsearch is a powerful search engine."</span>
<span class="token punctuation">}</span>

POST /my_index/_doc/<span class="token number">2</span>
<span class="token punctuation">{</span>
  <span class="token property">"content"</span><span class="token operator">:</span> <span class="token string">"Full-text search is essential for modern applications."</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h5 id="10-3-执行分词搜索："><a href="#10-3-执行分词搜索：" class="headerlink" title="10.3. 执行分词搜索："></a>10.3. <strong>执行分词搜索：</strong></h5><p>使用全文搜索查询来执行分词搜索。</p>
<pre class="line-numbers language-json" data-language="json"><code class="language-json">GET /my_index/_search
<span class="token punctuation">{</span>
  <span class="token property">"query"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">"match"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">"content"</span><span class="token operator">:</span> <span class="token string">"powerful search"</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>上述查询使用了<code>match</code>查询，它会对搜索词进行分词，并与文档中的词项匹配。这样可以找到包含任意搜索词的文档。</p>
<h5 id="10-4-自定义分析器："><a href="#10-4-自定义分析器：" class="headerlink" title="10.4. 自定义分析器："></a>10.4. <strong>自定义分析器：</strong></h5><p>Elasticsearch提供了各种内置分析器，但也可以根据需要创建自定义分析器。自定义分析器允许您指定分词器、过滤器等详细设置。</p>
<pre class="line-numbers language-json" data-language="json"><code class="language-json">PUT /my_index
<span class="token punctuation">{</span>
  <span class="token property">"settings"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">"analysis"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">"analyzer"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">"custom_analyzer"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token property">"type"</span><span class="token operator">:</span> <span class="token string">"custom"</span><span class="token punctuation">,</span>
          <span class="token property">"tokenizer"</span><span class="token operator">:</span> <span class="token string">"standard"</span><span class="token punctuation">,</span>
          <span class="token property">"filter"</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">"lowercase"</span><span class="token punctuation">,</span> <span class="token string">"my_custom_filter"</span><span class="token punctuation">]</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token property">"filter"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">"my_custom_filter"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token property">"type"</span><span class="token operator">:</span> <span class="token string">"stop"</span><span class="token punctuation">,</span>
          <span class="token property">"stopwords"</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">"is"</span><span class="token punctuation">,</span> <span class="token string">"a"</span><span class="token punctuation">,</span> <span class="token string">"for"</span><span class="token punctuation">]</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token property">"mappings"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">"properties"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">"content"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">"type"</span><span class="token operator">:</span> <span class="token string">"text"</span><span class="token punctuation">,</span>
        <span class="token property">"analyzer"</span><span class="token operator">:</span> <span class="token string">"custom_analyzer"</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>上述示例中，定义了一个名为<code>custom_analyzer</code>的自定义分析器，其中包括标准分词器和一个停用词过滤器。然后将<code>custom_analyzer</code>应用于<code>content</code>字段。</p>
<p>通过这些步骤，您可以使用Elasticsearch实现分词搜索，并根据需要自定义分析器以满足特定的搜索需求。</p>
<h3 id="十五-Java并发编程"><a href="#十五-Java并发编程" class="headerlink" title="十五. Java并发编程"></a>十五. Java并发编程</h3><p>Java并发编程是指在多个线程同时执行的情况下，有效地管理和协调线程的执行。以下是Java并发编程的一些基本知识：</p>
<h5 id="1-线程和进程："><a href="#1-线程和进程：" class="headerlink" title="1. 线程和进程："></a>1. <strong>线程和进程：</strong></h5><ul>
<li><strong>线程（Thread）：</strong> 线程是程序执行的最小单元，一个进程可以包含多个线程。</li>
<li><strong>进程（Process）：</strong> 进程是一个独立的执行环境，包含独立的内存空间和系统资源。</li>
</ul>
<h5 id="2-创建和运行线程："><a href="#2-创建和运行线程：" class="headerlink" title="2. 创建和运行线程："></a>2. <strong>创建和运行线程：</strong></h5><ul>
<li><p><strong>继承Thread类：</strong></p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">class</span> <span class="token class-name">MyThread</span> <span class="token keyword">extends</span> <span class="token class-name">Thread</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// 线程执行的代码</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
</li>
<li><p><strong>实现Runnable接口：</strong></p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">class</span> <span class="token class-name">MyRunnable</span> <span class="token keyword">implements</span> <span class="token class-name">Runnable</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// 线程执行的代码</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
</li>
<li><p><strong>使用Executor框架：</strong></p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token class-name">ExecutorService</span> executor <span class="token operator">=</span> <span class="token class-name">Executors</span><span class="token punctuation">.</span><span class="token function">newFixedThreadPool</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
executor<span class="token punctuation">.</span><span class="token function">execute</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">MyRunnable</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre></li>
</ul>
<h5 id="3-线程状态："><a href="#3-线程状态：" class="headerlink" title="3. 线程状态："></a>3. <strong>线程状态：</strong></h5><ul>
<li><strong>新建（New）：</strong> 线程已经被创建，但尚未启动。</li>
<li><strong>就绪（Runnable）：</strong> 线程已经启动，等待被调度执行。</li>
<li><strong>运行（Running）：</strong> 线程正在执行。</li>
<li><strong>阻塞（Blocked）：</strong> 线程因为某些原因暂时停止执行。</li>
<li><strong>终止（Terminated）：</strong> 线程执行完成或因异常退出。</li>
</ul>
<h5 id="4-同步和锁："><a href="#4-同步和锁：" class="headerlink" title="4. 同步和锁："></a>4. <strong>同步和锁：</strong></h5><ul>
<li><strong>同步方法：</strong> 使用<code>synchronized</code>关键字修饰的方法，确保同一时刻只有一个线程可以执行该方法。</li>
<li><strong>同步块：</strong> 使用<code>synchronized</code>关键字包裹的代码块，用于实现更灵活的同步。</li>
<li><strong>Lock接口：</strong> <code>ReentrantLock</code>等实现了<code>Lock</code>接口的类提供更灵活的锁机制。</li>
</ul>
<h5 id="5-线程安全性："><a href="#5-线程安全性：" class="headerlink" title="5. 线程安全性："></a>5. <strong>线程安全性：</strong></h5><ul>
<li><strong>原子性：</strong> 单个操作是原子的，不会被中断。</li>
<li><strong>可见性：</strong> 一个线程对共享变量的修改能立即被其他线程看到。</li>
<li><strong>有序性：</strong> 程序执行的顺序按照代码的先后顺序。</li>
</ul>
<h5 id="6-并发工具类："><a href="#6-并发工具类：" class="headerlink" title="6. 并发工具类："></a>6. <strong>并发工具类：</strong></h5><ul>
<li><strong>CountDownLatch：</strong> 用于等待一个或多个线程执行完成。</li>
<li><strong>CyclicBarrier：</strong> 用于让一组线程相互等待，直到到达某个公共屏障点。</li>
<li><strong>Semaphore：</strong> 用于控制同时访问的线程个数。</li>
</ul>
<h5 id="7-线程池："><a href="#7-线程池：" class="headerlink" title="7. 线程池："></a>7. <strong>线程池：</strong></h5><ul>
<li><strong>Executors类：</strong> 提供了创建和管理线程池的工厂方法。</li>
<li><strong>ThreadPoolExecutor：</strong> 真正的线程池实现，可以灵活地配置线程池的参数。</li>
</ul>
<h5 id="8-并发集合："><a href="#8-并发集合：" class="headerlink" title="8. 并发集合："></a>8. <strong>并发集合：</strong></h5><ul>
<li><strong>ConcurrentHashMap：</strong> 线程安全的HashMap实现。</li>
<li><strong>CopyOnWriteArrayList：</strong> 线程安全的ArrayList实现，适合读多写少的场景。</li>
</ul>
<h5 id="9-原子操作类："><a href="#9-原子操作类：" class="headerlink" title="9. 原子操作类："></a>9. <strong>原子操作类：</strong></h5><ul>
<li><strong>AtomicInteger、AtomicLong、AtomicReference：</strong> 提供了原子性操作，避免了使用<code>synchronized</code>关键字。</li>
</ul>
<h5 id="10-volatile关键字："><a href="#10-volatile关键字：" class="headerlink" title="10. volatile关键字："></a>10. <strong>volatile关键字：</strong></h5><ul>
<li><strong>volatile修饰变量：</strong> 保证变量的可见性，但不保证原子性，适用于标记状态等场景。</li>
</ul>
<h5 id="11-线程间通信："><a href="#11-线程间通信：" class="headerlink" title="11. 线程间通信："></a>11. <strong>线程间通信：</strong></h5><ul>
<li><strong>wait()、notify()、notifyAll()：</strong> 用于线程之间的协调和通信。</li>
<li><strong>Lock和Condition：</strong> <code>ReentrantLock</code>和<code>Condition</code>接口提供了更灵活的线程间通信方式。</li>
</ul>
<p>以上是Java并发编程的一些基础知识，实现并发程序时需要注意线程安全性、避免死锁和饥饿等问题。了解这些基础知识有助于有效地设计和调试并发程序。</p>
<h3 id="十六-Redis基础知识"><a href="#十六-Redis基础知识" class="headerlink" title="十六. Redis基础知识"></a>十六. Redis基础知识</h3><p>Redis（Remote Dictionary Server）是一个开源的、内存中的数据结构存储系统，它可以用作数据库、缓存和消息中间件。以下是Redis的一些基础知识：</p>
<h4 id="1-数据结构："><a href="#1-数据结构：" class="headerlink" title="1. 数据结构："></a>1. <strong>数据结构：</strong></h4><p>Redis支持多种数据结构，包括：</p>
<ul>
<li><strong>字符串（String）：</strong> 最基本的数据类型，可以包含任何数据，比如文本、JSON等。</li>
<li><strong>哈希表（Hash）：</strong> 类似于Java中的Map，适合存储对象。</li>
<li><strong>列表（List）：</strong> 类似于Java中的List，支持左右插入和删除操作。</li>
<li><strong>集合（Set）：</strong> 不重复的元素集合，支持交集、并集、差集等操作。</li>
<li><strong>有序集合（Sorted Set）：</strong> 类似于集合，但每个元素都关联一个分数，可以按照分数排序。</li>
</ul>
<h4 id="2-持久化："><a href="#2-持久化：" class="headerlink" title="2. 持久化："></a>2. <strong>持久化：</strong></h4><p>Redis支持两种持久化方式：</p>
<ul>
<li><strong>快照（RDB）：</strong> 定期保存数据的快照，将数据写入磁盘。</li>
<li><strong>追加文件（AOF）：</strong> 记录每个写操作，以保证数据的持久性。</li>
</ul>
<h4 id="3-内存模型："><a href="#3-内存模型：" class="headerlink" title="3. 内存模型："></a>3. <strong>内存模型：</strong></h4><p>Redis是基于内存的数据库，但也可以通过配置使用磁盘存储数据。内存模型允许快速读写操作，使其在缓存和实时数据处理等场景中表现优异。</p>
<h4 id="4-单线程模型："><a href="#4-单线程模型：" class="headerlink" title="4. 单线程模型："></a>4. <strong>单线程模型：</strong></h4><p>Redis采用单线程模型，即一个请求在同一时间内只能被处理一次。这样可以避免复杂的并发控制，使得Redis的操作变得简单且高效。</p>
<h4 id="5-发布-订阅（Pub-Sub）："><a href="#5-发布-订阅（Pub-Sub）：" class="headerlink" title="5. 发布/订阅（Pub/Sub）："></a>5. <strong>发布/订阅（Pub/Sub）：</strong></h4><p>Redis支持发布/订阅模式，允许多个客户端订阅相同的频道，从而在某一客户端发送消息时，所有订阅该频道的客户端都能接收到消息。</p>
<h4 id="6-事务："><a href="#6-事务：" class="headerlink" title="6. 事务："></a>6. <strong>事务：</strong></h4><p>Redis的事务机制类似于数据库事务，支持多个命令的原子性执行。事务可以通过MULTI、EXEC、DISCARD和WATCH等命令来进行控制。</p>
<h4 id="7-分布式锁："><a href="#7-分布式锁：" class="headerlink" title="7. 分布式锁："></a>7. <strong>分布式锁：</strong></h4><p>Redis通过SETNX（SET if Not eXists）命令实现分布式锁，通过给一个不存在的键设置值来实现锁定。</p>
<p>分布式锁是在分布式系统中用于控制对共享资源或临界区域的访问的一种同步机制。在Redis中，常用的实现分布式锁的方式包括使用<code>SETNX</code>（SET if Not eXists）命令和Redlock算法。</p>
<h5 id="7-1-使用SETNX命令实现分布式锁："><a href="#7-1-使用SETNX命令实现分布式锁：" class="headerlink" title="7.1. 使用SETNX命令实现分布式锁："></a>7.1. 使用<code>SETNX</code>命令实现分布式锁：</h5><p>通过<code>SETNX</code>命令，可以尝试将一个值设置到指定的键，只有当该键不存在时才会设置成功。这一特性可以用来实现分布式锁。</p>
<h6 id="加锁（获取锁）："><a href="#加锁（获取锁）：" class="headerlink" title="加锁（获取锁）："></a>加锁（获取锁）：</h6><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">SET lock_key <span class="token string">"unique_value"</span> NX PX <span class="token number">30000</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<ul>
<li><code>lock_key</code>是锁的键名，可以是一个唯一的标识。</li>
<li><code>"unique_value"</code>是一个唯一的值，用于标识持有锁的客户端。</li>
<li><code>NX</code>表示只有在键不存在时才设置成功。</li>
<li><code>PX 30000</code>表示设置一个过期时间为30秒的锁，以防止锁永远不会被释放。</li>
</ul>
<h6 id="解锁（释放锁）："><a href="#解锁（释放锁）：" class="headerlink" title="解锁（释放锁）："></a>解锁（释放锁）：</h6><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token keyword">if</span> redis.call<span class="token punctuation">(</span><span class="token string">"get"</span>,KEYS<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">==</span> ARGV<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token keyword">then</span>
    <span class="token builtin class-name">return</span> redis.call<span class="token punctuation">(</span><span class="token string">"del"</span>,KEYS<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">else</span>
    <span class="token builtin class-name">return</span> <span class="token number">0</span>
end<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>上述Lua脚本用于释放锁，通过比较锁的值是否与预期值相同，如果相同则执行删除操作，释放锁。</p>
<h5 id="7-2-使用Redlock算法实现分布式锁："><a href="#7-2-使用Redlock算法实现分布式锁：" class="headerlink" title="7.2. 使用Redlock算法实现分布式锁："></a>7.2. 使用Redlock算法实现分布式锁：</h5><p>Redlock算法是一个由Redis作者提出的分布式锁算法，通过在多个Redis节点上加锁，提高了系统的可靠性。</p>
<h6 id="加锁（获取锁）：-1"><a href="#加锁（获取锁）：-1" class="headerlink" title="加锁（获取锁）："></a>加锁（获取锁）：</h6><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># Python示例代码</span>
<span class="token keyword">import</span> redis
<span class="token keyword">from</span> redlock <span class="token keyword">import</span> Redlock

dl <span class="token operator">=</span> Redlock<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">{</span><span class="token string">"host"</span><span class="token punctuation">:</span> <span class="token string">"localhost"</span><span class="token punctuation">,</span> <span class="token string">"port"</span><span class="token punctuation">:</span> <span class="token number">6379</span><span class="token punctuation">,</span> <span class="token string">"db"</span><span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">,</span> retry_count<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">)</span>

lock <span class="token operator">=</span> dl<span class="token punctuation">.</span>lock<span class="token punctuation">(</span><span class="token string">"resource_name"</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>上述代码使用了<code>redlock-py</code>库，通过多个Redis节点协同工作，确保在网络分区等故障情况下仍能提供可靠的分布式锁。</p>
<h6 id="解锁（释放锁）：-1"><a href="#解锁（释放锁）：-1" class="headerlink" title="解锁（释放锁）："></a>解锁（释放锁）：</h6><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># Python示例代码</span>
dl<span class="token punctuation">.</span>unlock<span class="token punctuation">(</span>lock<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p>Redlock算法的实现相对复杂，需要确保时钟同步、多节点可用性等条件，因此在使用之前需要仔细了解其适用场景和风险。</p>
<h5 id="7-3-Java实现Redis分布式锁："><a href="#7-3-Java实现Redis分布式锁：" class="headerlink" title="7.3. Java实现Redis分布式锁："></a>7.3. <strong>Java实现Redis分布式锁：</strong></h5><p>在Java中实现分布式锁，可以使用Redis作为分布式锁的后端存储，结合Java的<code>Jedis</code>或<code>Lettuce</code>等Redis客户端库。以下是一个简单的Java实现分布式锁的示例代码：</p>
<h6 id="使用Jedis库："><a href="#使用Jedis库：" class="headerlink" title="使用Jedis库："></a>使用Jedis库：</h6><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">import</span> <span class="token import"><span class="token namespace">redis<span class="token punctuation">.</span>clients<span class="token punctuation">.</span>jedis<span class="token punctuation">.</span></span><span class="token class-name">Jedis</span></span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">DistributedLock</span> <span class="token punctuation">{</span>

    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">Jedis</span> jedis<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">String</span> lockKey<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">String</span> lockValue<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token keyword">int</span> lockTimeout<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token class-name">DistributedLock</span><span class="token punctuation">(</span><span class="token class-name">Jedis</span> jedis<span class="token punctuation">,</span> <span class="token class-name">String</span> lockKey<span class="token punctuation">,</span> <span class="token class-name">String</span> lockValue<span class="token punctuation">,</span> <span class="token keyword">int</span> lockTimeout<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>jedis <span class="token operator">=</span> jedis<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>lockKey <span class="token operator">=</span> lockKey<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>lockValue <span class="token operator">=</span> lockValue<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>lockTimeout <span class="token operator">=</span> lockTimeout<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">acquireLock</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// 使用SET命令尝试获取锁</span>
        <span class="token class-name">String</span> result <span class="token operator">=</span> jedis<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>lockKey<span class="token punctuation">,</span> lockValue<span class="token punctuation">,</span> <span class="token string">"NX"</span><span class="token punctuation">,</span> <span class="token string">"PX"</span><span class="token punctuation">,</span> lockTimeout<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token string">"OK"</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">releaseLock</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// 使用Lua脚本释放锁</span>
        <span class="token class-name">String</span> luaScript <span class="token operator">=</span> <span class="token string">"if redis.call('get', KEYS[1]) == ARGV[1] then return redis.call('del', KEYS[1]) else return 0 end"</span><span class="token punctuation">;</span>
        jedis<span class="token punctuation">.</span><span class="token function">eval</span><span class="token punctuation">(</span>luaScript<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> lockKey<span class="token punctuation">,</span> lockValue<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// 示例用法</span>
        <span class="token keyword">try</span> <span class="token punctuation">(</span><span class="token class-name">Jedis</span> jedis <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Jedis</span><span class="token punctuation">(</span><span class="token string">"localhost"</span><span class="token punctuation">,</span> <span class="token number">6379</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">DistributedLock</span> distributedLock <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">DistributedLock</span><span class="token punctuation">(</span>jedis<span class="token punctuation">,</span> <span class="token string">"my_lock"</span><span class="token punctuation">,</span> <span class="token string">"unique_value"</span><span class="token punctuation">,</span> <span class="token number">30000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token keyword">if</span> <span class="token punctuation">(</span>distributedLock<span class="token punctuation">.</span><span class="token function">acquireLock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">try</span> <span class="token punctuation">{</span>
                    <span class="token comment">// 获取锁成功，执行业务逻辑</span>
                    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"Lock acquired, performing business logic..."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span> <span class="token keyword">finally</span> <span class="token punctuation">{</span>
                    <span class="token comment">// 释放锁</span>
                    distributedLock<span class="token punctuation">.</span><span class="token function">releaseLock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
                <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"Failed to acquire lock"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>上述示例中，通过<code>SET</code>命令尝试获取锁，使用<code>NX</code>参数表示只在键不存在时设置成功，使用<code>PX</code>参数设置锁的过期时间。在释放锁时，使用Lua脚本确保解锁操作的原子性。</p>
<h6 id="使用Lettuce库："><a href="#使用Lettuce库：" class="headerlink" title="使用Lettuce库："></a>使用Lettuce库：</h6><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">import</span> <span class="token import"><span class="token namespace">io<span class="token punctuation">.</span>lettuce<span class="token punctuation">.</span>core<span class="token punctuation">.</span></span><span class="token class-name">RedisClient</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">io<span class="token punctuation">.</span>lettuce<span class="token punctuation">.</span>core<span class="token punctuation">.</span>api<span class="token punctuation">.</span></span><span class="token class-name">StatefulRedisConnection</span></span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">DistributedLock</span> <span class="token punctuation">{</span>

    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">RedisClient</span> redisClient<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">String</span> lockKey<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">String</span> lockValue<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token keyword">int</span> lockTimeout<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token class-name">DistributedLock</span><span class="token punctuation">(</span><span class="token class-name">RedisClient</span> redisClient<span class="token punctuation">,</span> <span class="token class-name">String</span> lockKey<span class="token punctuation">,</span> <span class="token class-name">String</span> lockValue<span class="token punctuation">,</span> <span class="token keyword">int</span> lockTimeout<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>redisClient <span class="token operator">=</span> redisClient<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>lockKey <span class="token operator">=</span> lockKey<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>lockValue <span class="token operator">=</span> lockValue<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>lockTimeout <span class="token operator">=</span> lockTimeout<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">acquireLock</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">try</span> <span class="token punctuation">(</span><span class="token class-name">StatefulRedisConnection</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> connection <span class="token operator">=</span> redisClient<span class="token punctuation">.</span><span class="token function">connect</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">// 使用SET命令尝试获取锁</span>
            <span class="token class-name">String</span> result <span class="token operator">=</span> connection<span class="token punctuation">.</span><span class="token function">sync</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>lockKey<span class="token punctuation">,</span> lockValue<span class="token punctuation">,</span> <span class="token string">"NX"</span><span class="token punctuation">,</span> <span class="token string">"PX"</span><span class="token punctuation">,</span> lockTimeout<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> <span class="token string">"OK"</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">releaseLock</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">try</span> <span class="token punctuation">(</span><span class="token class-name">StatefulRedisConnection</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> connection <span class="token operator">=</span> redisClient<span class="token punctuation">.</span><span class="token function">connect</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">// 使用Lua脚本释放锁</span>
            <span class="token class-name">String</span> luaScript <span class="token operator">=</span> <span class="token string">"if redis.call('get', KEYS[1]) == ARGV[1] then return redis.call('del', KEYS[1]) else return 0 end"</span><span class="token punctuation">;</span>
            connection<span class="token punctuation">.</span><span class="token function">sync</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">eval</span><span class="token punctuation">(</span>luaScript<span class="token punctuation">,</span> <span class="token class-name">List</span><span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span>lockKey<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token class-name">List</span><span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span>lockValue<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// 示例用法</span>
        <span class="token class-name">RedisClient</span> redisClient <span class="token operator">=</span> <span class="token class-name">RedisClient</span><span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token string">"redis://localhost:6379"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">DistributedLock</span> distributedLock <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">DistributedLock</span><span class="token punctuation">(</span>redisClient<span class="token punctuation">,</span> <span class="token string">"my_lock"</span><span class="token punctuation">,</span> <span class="token string">"unique_value"</span><span class="token punctuation">,</span> <span class="token number">30000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span>distributedLock<span class="token punctuation">.</span><span class="token function">acquireLock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">try</span> <span class="token punctuation">{</span>
                <span class="token comment">// 获取锁成功，执行业务逻辑</span>
                <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"Lock acquired, performing business logic..."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span> <span class="token keyword">finally</span> <span class="token punctuation">{</span>
                <span class="token comment">// 释放锁</span>
                distributedLock<span class="token punctuation">.</span><span class="token function">releaseLock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"Failed to acquire lock"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>上述示例使用了<code>Lettuce</code>库，它是一个高性能的Redis客户端。与<code>Jedis</code>类似，通过<code>set</code>命令获取锁，通过Lua脚本释放锁。</p>
<p>请注意，以上示例代码仅为演示目的，实际应用中还需要考虑异常处理、锁</p>
<h5 id="7-4-注意事项："><a href="#7-4-注意事项：" class="headerlink" title="7.4. 注意事项："></a>7.4. 注意事项：</h5><ol>
<li><strong>加锁的超时时间：</strong> 在使用<code>SETNX</code>命令时，应注意设置合适的超时时间，防止因为某个客户端崩溃而导致锁一直被占用。</li>
<li><strong>解锁的原子性：</strong> 使用Lua脚本可以保证解锁操作的原子性，避免误解锁。</li>
<li><strong>Redlock算法的复杂性：</strong> 在选择使用Redlock算法时，需要仔细评估其在特定环境下的可用性和性能开销。</li>
</ol>
<p>分布式锁的实现需要考虑网络分区、节点故障等复杂情况，因此在选择和使用分布式锁时需要谨慎，根据实际需求选择合适的方案。</p>
<h4 id="8-管道（Pipeline）："><a href="#8-管道（Pipeline）：" class="headerlink" title="8. 管道（Pipeline）："></a>8. <strong>管道（Pipeline）：</strong></h4><p>通过使用管道，可以在一个请求中发送多个命令，从而减少网络通信的开销，提高性能。</p>
<h4 id="9-Lua脚本："><a href="#9-Lua脚本：" class="headerlink" title="9. Lua脚本："></a>9. <strong>Lua脚本：</strong></h4><p>Redis支持使用Lua脚本执行一系列命令，这使得可以在服务器端执行一组原子操作，减少了多个命令之间的网络通信开销。</p>
<h4 id="10-高可用性："><a href="#10-高可用性：" class="headerlink" title="10. 高可用性："></a>10. <strong>高可用性：</strong></h4><p>Redis提供了一些高可用性的解决方案，如主从复制、哨兵模式和集群模式，以保证系统的稳定性和可用性。</p>
<h4 id="11-客户端库和工具："><a href="#11-客户端库和工具：" class="headerlink" title="11. 客户端库和工具："></a>11. <strong>客户端库和工具：</strong></h4><p>Redis有丰富的客户端库，支持多种编程语言，如Java、Python、Node.js等。此外，有一些图形化管理工具，如Redis Desktop Manager，可用于方便地管理Redis服务器。</p>
<h4 id="12-Redis分布式缓存概念："><a href="#12-Redis分布式缓存概念：" class="headerlink" title="12. Redis分布式缓存概念："></a>12. <strong>Redis分布式缓存概念：</strong></h4><p>Redis分布式缓存是通过在多个节点上分布存储和管理数据，以提高缓存的容量、性能和可用性。在分布式缓存中，不同的节点可以共同存储和提供对相同缓存数据的访问，从而实现更好的横向扩展性。以下是一些与Redis分布式缓存相关的概念：</p>
<h5 id="1-分片（Sharding）："><a href="#1-分片（Sharding）：" class="headerlink" title="1. 分片（Sharding）："></a>1. <strong>分片（Sharding）：</strong></h5><p>分片是指将数据分散存储在多个节点上的过程。在Redis分布式缓存中，可以通过哈希函数或其他分片算法将数据分布到不同的节点上。每个节点负责存储部分数据，从而实现数据的分布式存储。</p>
<h5 id="2-主从复制："><a href="#2-主从复制：" class="headerlink" title="2. 主从复制："></a>2. <strong>主从复制：</strong></h5><p>主从复制是指一个节点（主节点）的数据被复制到其他节点（从节点）上。在Redis中，主节点负责写入操作，从节点负责复制主节点的数据。主从复制可以提高数据的可用性和读取性能。</p>
<h5 id="3-哨兵模式（Sentinel）："><a href="#3-哨兵模式（Sentinel）：" class="headerlink" title="3. 哨兵模式（Sentinel）："></a>3. <strong>哨兵模式（Sentinel）：</strong></h5><p>哨兵模式是一种用于监控和管理Redis节点的机制。哨兵负责监控节点的健康状态，当主节点宕机时，会自动选举一个从节点作为新的主节点，确保系统的高可用性。</p>
<h5 id="4-集群模式（Cluster）："><a href="#4-集群模式（Cluster）：" class="headerlink" title="4. 集群模式（Cluster）："></a>4. <strong>集群模式（Cluster）：</strong></h5><p>集群模式是一种用于水平扩展的分布式部署方式。在Redis集群模式中，数据被分散存储在多个节点上，每个节点负责一部分数据。集群模式提供了更好的横向扩展性和负载均衡。</p>
<h5 id="5-数据分片策略："><a href="#5-数据分片策略：" class="headerlink" title="5. 数据分片策略："></a>5. <strong>数据分片策略：</strong></h5><p>数据分片策略是指将数据分配到不同节点的规则。常见的策略包括：</p>
<ul>
<li><strong>哈希分片：</strong> 使用哈希函数将数据的键映射到不同的节点。</li>
<li><strong>范围分片：</strong> 将数据按照范围划分到不同的节点，比如按照字母顺序划分。</li>
<li><strong>一致性哈希：</strong> 通过一致性哈希算法将数据均匀地分布到多个节点上。</li>
</ul>
<h5 id="6-缓存击穿、雪崩和穿透："><a href="#6-缓存击穿、雪崩和穿透：" class="headerlink" title="6. 缓存击穿、雪崩和穿透："></a>6. <strong>缓存击穿、雪崩和穿透：</strong></h5><ul>
<li><strong>缓存击穿：</strong> 指的是对于某个热点数据，在缓存失效的瞬间，大量请求同时涌入，直接请求数据库，导致数据库负载过高。</li>
<li><strong>缓存雪崩：</strong> 指的是在某个时间点，大量缓存失效，导致大量请求直接落到数据库上。</li>
<li><strong>缓存穿透：</strong> 指的是恶意或异常请求查询一个不存在的数据，导致每次都要查询数据库，增加数据库负载。</li>
</ul>
<h5 id="7-缓存更新策略："><a href="#7-缓存更新策略：" class="headerlink" title="7. 缓存更新策略："></a>7. <strong>缓存更新策略：</strong></h5><ul>
<li><strong>写穿透防护：</strong> 当请求查询的数据不存在时，可以设置一个空值或占位符，并设置较短的过期时间，防止频繁查询数据库。</li>
<li><strong>定期刷新：</strong> 定期刷新缓存，保持数据的新鲜性。</li>
<li><strong>异步刷新：</strong> 在缓存失效的瞬间，异步更新缓存，避免请求直接落到数据库。</li>
</ul>
<p>这些概念涵盖了在构建和管理Redis分布式缓存时需要考虑的关键方面，以确保系统的性能、可用性和稳定性。</p>
<h5 id="8-Java实现Redis分布式缓存："><a href="#8-Java实现Redis分布式缓存：" class="headerlink" title="8. Java实现Redis分布式缓存："></a>8. Java实现Redis分布式缓存：</h5><p>在Java中实现Redis分布式缓存，一般可以使用Redis的Java客户端库，如Jedis或Lettuce。以下是一个简单的示例，演示如何使用Jedis实现Redis分布式缓存。</p>
<p>首先，你需要在项目中添加Jedis的依赖，如果使用Maven，可以在<code>pom.xml</code>中添加以下依赖：</p>
<pre class="line-numbers language-markup" data-language="markup"><code class="language-markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependencies</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>redis.clients<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>jedis<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>3.7.0<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependencies</span><span class="token punctuation">&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>然后，可以使用以下代码示例来实现Redis分布式缓存：</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">import</span> <span class="token import"><span class="token namespace">redis<span class="token punctuation">.</span>clients<span class="token punctuation">.</span>jedis<span class="token punctuation">.</span></span><span class="token class-name">Jedis</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">redis<span class="token punctuation">.</span>clients<span class="token punctuation">.</span>jedis<span class="token punctuation">.</span>exceptions<span class="token punctuation">.</span></span><span class="token class-name">JedisDataException</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">redis<span class="token punctuation">.</span>clients<span class="token punctuation">.</span>jedis<span class="token punctuation">.</span>exceptions<span class="token punctuation">.</span></span><span class="token class-name">JedisException</span></span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">RedisDistributedCache</span> <span class="token punctuation">{</span>

    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">Jedis</span> jedis<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token class-name">RedisDistributedCache</span><span class="token punctuation">(</span><span class="token class-name">String</span> host<span class="token punctuation">,</span> <span class="token keyword">int</span> port<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>jedis <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Jedis</span><span class="token punctuation">(</span>host<span class="token punctuation">,</span> port<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">put</span><span class="token punctuation">(</span><span class="token class-name">String</span> key<span class="token punctuation">,</span> <span class="token class-name">String</span> value<span class="token punctuation">,</span> <span class="token keyword">int</span> expirationInSeconds<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            jedis<span class="token punctuation">.</span><span class="token function">setex</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> expirationInSeconds<span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">JedisException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token function">handleJedisException</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">get</span><span class="token punctuation">(</span><span class="token class-name">String</span> key<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> jedis<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">JedisException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token function">handleJedisException</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">delete</span><span class="token punctuation">(</span><span class="token class-name">String</span> key<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            jedis<span class="token punctuation">.</span><span class="token function">del</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">JedisException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token function">handleJedisException</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">handleJedisException</span><span class="token punctuation">(</span><span class="token class-name">JedisException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// 处理Jedis异常，可以根据实际情况进行处理，例如记录日志或抛出自定义异常</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>e <span class="token keyword">instanceof</span> <span class="token class-name">JedisDataException</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"JedisDataException: "</span> <span class="token operator">+</span> e<span class="token punctuation">.</span><span class="token function">getMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"JedisException: "</span> <span class="token operator">+</span> e<span class="token punctuation">.</span><span class="token function">getMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// 示例用法</span>
        <span class="token class-name">RedisDistributedCache</span> cache <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">RedisDistributedCache</span><span class="token punctuation">(</span><span class="token string">"localhost"</span><span class="token punctuation">,</span> <span class="token number">6379</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// 存入缓存</span>
        cache<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">"key1"</span><span class="token punctuation">,</span> <span class="token string">"value1"</span><span class="token punctuation">,</span> <span class="token number">60</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// 获取缓存</span>
        <span class="token class-name">String</span> result <span class="token operator">=</span> cache<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">"key1"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>result <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"Value: "</span> <span class="token operator">+</span> result<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"Key not found"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token comment">// 删除缓存</span>
        cache<span class="token punctuation">.</span><span class="token function">delete</span><span class="token punctuation">(</span><span class="token string">"key1"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>上述代码示例创建了一个简单的<code>RedisDistributedCache</code>类，其中包含了常用的缓存操作方法，包括<code>put</code>、<code>get</code>和<code>delete</code>。在实际项目中，你可能需要根据业务需求扩展这些方法，并考虑缓存的失效策略、异常处理等方面。此外，为了提高性能，可以考虑使用连接池管理与Redis的连接。</p>
<p>请注意，上述代码中的异常处理部分是简单示例，实际项目中可能需要更复杂的异常处理逻辑。</p>
<p>这些是Redis的一些基础知识，它是一个强大而灵活的工具，适用于多种应用场景，包括缓存、实时统计、消息队列等。</p>
<h3 id="十七-计算机网络基础知识"><a href="#十七-计算机网络基础知识" class="headerlink" title="十七. 计算机网络基础知识"></a>十七. 计算机网络基础知识</h3><p>计算机网络是指将多台计算机连接在一起，以便它们可以相互通信和共享资源的系统。以下是一些计算机网络的基础知识：</p>
<h4 id="1-网络基础概念："><a href="#1-网络基础概念：" class="headerlink" title="1. 网络基础概念："></a>1. <strong>网络基础概念：</strong></h4><ul>
<li><strong>网络：</strong> 多台计算机通过通信链路相连接，以便共享资源和信息。</li>
<li><strong>通信：</strong> 在网络中，设备之间通过传输数据的方式进行信息交流。</li>
</ul>
<h4 id="2-网络的分类："><a href="#2-网络的分类：" class="headerlink" title="2. 网络的分类："></a>2. <strong>网络的分类：</strong></h4><ul>
<li><strong>局域网（LAN）：</strong> 小范围内的网络，通常在一个建筑或者一个校园内。</li>
<li><strong>城域网（MAN）：</strong> 比局域网范围更广，通常覆盖一个城市。</li>
<li><strong>广域网（WAN）：</strong> 跨越大范围的网络，通常覆盖多个城市或者国家。</li>
</ul>
<h4 id="3-协议："><a href="#3-协议：" class="headerlink" title="3. 协议："></a>3. <strong>协议：</strong></h4><ul>
<li><strong>协议：</strong> 计算机网络中，协议是一种规则或约定，确保通信设备之间的正常通信。常见的协议有TCP/IP、HTTP、FTP等。</li>
</ul>
<h4 id="4-OSI模型："><a href="#4-OSI模型：" class="headerlink" title="4. OSI模型："></a>4. <strong>OSI模型：</strong></h4><ul>
<li><strong>OSI模型（Open Systems Interconnection）：</strong> 将网络通信划分为七个层次，每个层次都有特定的功能。包括物理层、数据链路层、网络层、传输层、会话层、表示层和应用层。</li>
</ul>
<h4 id="5-TCP-IP协议族："><a href="#5-TCP-IP协议族：" class="headerlink" title="5. TCP/IP协议族："></a>5. <strong>TCP/IP协议族：</strong></h4><ul>
<li><p><strong>TCP/IP：</strong> 是互联网所使用的通信协议族，包括传输控制协议（TCP）和因特网协议（IP）等。它是一个四层的模型，包括链路层、网络层、传输层和应用层。</p>
<p>TCP/IP（Transmission Control Protocol/Internet Protocol）是一组用于在计算机网络上进行通信的协议。</p>
<h5 id="TCP（传输控制协议）："><a href="#TCP（传输控制协议）：" class="headerlink" title="TCP（传输控制协议）："></a>TCP（传输控制协议）：</h5><p>想象一下，你正在通过互联网下载一个文件。TCP就像是一个可靠的快递服务。当你发送一个文件请求时，TCP会确保文件的每个部分都被正确地分割、传输、接收，并且没有任何遗漏。如果在传输过程中发生了错误，TCP会重新发送出错的那一部分，直到整个文件都被准确地传送到你的电脑上。</p>
<h5 id="IP（互联网协议）："><a href="#IP（互联网协议）：" class="headerlink" title="IP（互联网协议）："></a>IP（互联网协议）：</h5><p>现在，想象一下你给你的朋友寄一封信。IP就像是邮递员，它帮助信件找到正确的地址，确保信件可以正确地从寄信人传递到收信人。在计算机网络中，IP协议负责确定数据的源地址和目标地址，就像邮寄信件时需要写上寄信人和收信人的地址一样。</p>
<h5 id="TCP-IP的协同工作："><a href="#TCP-IP的协同工作：" class="headerlink" title="TCP/IP的协同工作："></a>TCP/IP的协同工作：</h5><p>TCP和IP一起工作，就像是互联网通信的黄金搭档。TCP确保数据在传输过程中的可靠性，而IP负责数据的路由和传递。它们一同构成了一个可靠、高效的通信系统，使得数据可以在世界各地的计算机之间流动，就像你寄信给朋友一样简单。</p>
<p>综合来说，TCP/IP就像是互联网通信的两位关键角色：一个负责确保数据的完整性和有序传输，另一个负责确定数据的源和目标，帮助数据找到正确的路径。这个协议家族是互联网通信的基石，使得我们能够畅通无阻地在网络上传递信息。</p>
</li>
</ul>
<h4 id="6-IP地址和子网："><a href="#6-IP地址和子网：" class="headerlink" title="6. IP地址和子网："></a>6. <strong>IP地址和子网：</strong></h4><ul>
<li><strong>IP地址：</strong> 是网络上的设备的标识符，分为IPv4和IPv6两种版本。</li>
<li><strong>子网：</strong> 将一个大的IP地址空间划分成若干个小的子网，有助于更有效地管理IP地址。</li>
</ul>
<h4 id="7-域名和DNS："><a href="#7-域名和DNS：" class="headerlink" title="7. 域名和DNS："></a>7. <strong>域名和DNS：</strong></h4><ul>
<li><strong>域名：</strong> 是用于标识互联网上计算机和网络服务的人类可读的名称。</li>
<li><strong>DNS（Domain Name System）：</strong> 是将域名映射到IP地址的分布式数据库系统。</li>
</ul>
<h4 id="8-HTTP和HTTPS："><a href="#8-HTTP和HTTPS：" class="headerlink" title="8. HTTP和HTTPS："></a>8. <strong>HTTP和HTTPS：</strong></h4><ul>
<li><strong>HTTP（Hypertext Transfer Protocol）：</strong> 是用于在Web浏览器和Web服务器之间传输超文本的协议。</li>
<li><strong>HTTPS：</strong> 是HTTP的安全版本，通过SSL/TLS协议对数据进行加密传输。</li>
</ul>
<h4 id="9-网络安全："><a href="#9-网络安全：" class="headerlink" title="9. 网络安全："></a>9. <strong>网络安全：</strong></h4><ul>
<li><strong>防火墙：</strong> 用于控制网络流量，保护内部网络免受未经授权的访问。</li>
<li><strong>VPN（Virtual Private Network）：</strong> 通过加密和隧道技术，在公共网络上建立私人网络。</li>
</ul>
<h4 id="10-网络设备："><a href="#10-网络设备：" class="headerlink" title="10. 网络设备："></a>10. <strong>网络设备：</strong></h4><ul>
<li><strong>路由器：</strong> 用于在不同网络之间传递数据包。</li>
<li><strong>交换机：</strong> 在局域网中连接多个设备，并基于MAC地址进行数据转发。</li>
<li><strong>网关：</strong> 连接不同网络体系结构的设备，实现协议转换。</li>
</ul>
<h4 id="11-无线网络："><a href="#11-无线网络：" class="headerlink" title="11. 无线网络："></a>11. <strong>无线网络：</strong></h4><ul>
<li><strong>Wi-Fi：</strong> 一种无线局域网技术，允许设备通过无线信号进行通信。</li>
<li><strong>蓝牙：</strong> 一种短距离通信技术，用于连接设备，如手机和耳机。</li>
</ul>
<h4 id="12-TCP-IP-与HTTP的区别："><a href="#12-TCP-IP-与HTTP的区别：" class="headerlink" title="12. TCP/IP 与HTTP的区别："></a>12. <strong>TCP/IP 与HTTP的区别：</strong></h4><p>TCP/IP（Transmission Control Protocol/Internet Protocol）和HTTP（Hypertext Transfer Protocol）是两个不同的概念，分别表示网络通信的协议族和应用层协议。以下是它们的主要区别：</p>
<h5 id="1-层级不同："><a href="#1-层级不同：" class="headerlink" title="1. 层级不同："></a>1. <strong>层级不同：</strong></h5><ul>
<li><strong>TCP/IP：</strong> 是一个包含多个层级的网络通信协议族，包括物理层、数据链路层、网络层、传输层、会话层、表示层和应用层。</li>
<li><strong>HTTP：</strong> 是应用层协议，位于TCP/IP协议栈的最上层，负责在网络中传输超文本（Hypertext）。</li>
</ul>
<h5 id="2-功能不同："><a href="#2-功能不同：" class="headerlink" title="2. 功能不同："></a>2. <strong>功能不同：</strong></h5><ul>
<li><strong>TCP/IP：</strong> 提供了一系列规范，包括数据传输、路由、寻址和网络通信的基本规则。它并没有规定应用层的具体协议，而是提供了一种通用的网络通信基础。</li>
<li><strong>HTTP：</strong> 是一个应用层协议，用于在Web浏览器和Web服务器之间传输超文本。它规定了客户端和服务器之间的通信格式，定义了请求和响应的格式以及如何进行数据传输。</li>
</ul>
<h5 id="3-使用场景不同："><a href="#3-使用场景不同：" class="headerlink" title="3. 使用场景不同："></a>3. <strong>使用场景不同：</strong></h5><ul>
<li><strong>TCP/IP：</strong> 作为基础的网络协议族，支持多种应用层协议，包括HTTP、FTP、SMTP等。它是网络通信的基础，而不仅仅局限于Web通信。</li>
<li><strong>HTTP：</strong> 主要用于Web浏览器和Web服务器之间的通信，用于获取和传输超文本内容。它是Web应用的基础协议。</li>
</ul>
<h5 id="4-连接性不同："><a href="#4-连接性不同：" class="headerlink" title="4. 连接性不同："></a>4. <strong>连接性不同：</strong></h5><ul>
<li><strong>TCP/IP：</strong> 是一种连接性协议，它建立可靠的、面向连接的通信。</li>
<li><strong>HTTP：</strong> 在TCP/IP之上运行，使用TCP协议进行通信，但本身是无连接的，即每个HTTP请求都是独立的，不保留连接状态。</li>
</ul>
<h5 id="5-状态保持不同："><a href="#5-状态保持不同：" class="headerlink" title="5. 状态保持不同："></a>5. <strong>状态保持不同：</strong></h5><ul>
<li><strong>TCP/IP：</strong> 通过TCP协议提供连接的状态保持，确保数据的可靠性。</li>
<li><strong>HTTP：</strong> 是一种无状态协议，每个请求和响应之间没有关联，服务器不会保留关于客户端的信息。</li>
</ul>
<h5 id="6-总结："><a href="#6-总结：" class="headerlink" title="6. 总结："></a>6. 总结：</h5><p>TCP/IP是一组通用的网络通信协议，负责提供网络通信的基础规范。HTTP是基于TCP/IP协议的应用层协议，用于实现Web浏览器和Web服务器之间的超文本传输。在Web应用中，TCP/IP提供了底层的连接性和可靠性，而HTTP定义了高层次的数据传输规则。在实际应用中，它们通常是相互配合工作的。</p>
<p>这些基础知识涵盖了计算机网络的关键概念，理解这些概念对于设计、配置和维护计算机网络是至关重要的。网络技术的不断发展也带来了更多的网络协议和应用，因此保持学习和更新对于从事网络相关工作的专业人士是必要的。</p>
<h3 id="十八-RabbitMQ基础知识"><a href="#十八-RabbitMQ基础知识" class="headerlink" title="十八. RabbitMQ基础知识"></a>十八. RabbitMQ基础知识</h3><p>RabbitMQ 是一个消息中间件，用于在分布式系统中传递消息。以下是 RabbitMQ 的基础知识：</p>
<h4 id="1-消息中间件："><a href="#1-消息中间件：" class="headerlink" title="1. 消息中间件："></a>1. <strong>消息中间件：</strong></h4><p>消息中间件是一种通过消息传递在应用程序之间进行通信的机制。它允许不同的应用程序在分布式系统中异步地发送和接收消息。</p>
<h4 id="2-RabbitMQ-的角色："><a href="#2-RabbitMQ-的角色：" class="headerlink" title="2. RabbitMQ 的角色："></a>2. <strong>RabbitMQ 的角色：</strong></h4><ul>
<li><strong>Producer（生产者）：</strong> 负责发送消息的应用程序。</li>
<li><strong>Queue（队列）：</strong> 用于存储消息的地方，生产者将消息发送到队列。</li>
<li><strong>Exchange（交换机）：</strong> 用于将消息路由到一个或多个队列。生产者发送消息到交换机，交换机根据规则将消息路由到队列。</li>
<li><strong>Consumer（消费者）：</strong> 负责接收和处理消息的应用程序。</li>
</ul>
<h4 id="3-消息的传递模型："><a href="#3-消息的传递模型：" class="headerlink" title="3. 消息的传递模型："></a>3. <strong>消息的传递模型：</strong></h4><p>RabbitMQ 使用 AMQP（Advanced Message Queuing Protocol）作为消息传递的协议。消息从生产者发送到交换机，然后由交换机路由到队列，最后由消费者从队列中接收和处理消息。</p>
<h4 id="4-Exchange-的类型："><a href="#4-Exchange-的类型：" class="headerlink" title="4. Exchange 的类型："></a>4. <strong>Exchange 的类型：</strong></h4><p>RabbitMQ 提供了不同类型的交换机，包括：</p>
<ul>
<li><strong>Direct Exchange（直连交换机）：</strong> 将消息直接路由到与消息中的路由键相匹配的队列。</li>
<li><strong>Fanout Exchange（扇出交换机）：</strong> 将消息广播到所有绑定的队列。</li>
<li><strong>Topic Exchange（主题交换机）：</strong> 使用通配符匹配路由键，将消息路由到一个或多个队列。</li>
<li><strong>Headers Exchange（头交换机）：</strong> 根据消息的头部属性来进行匹配。</li>
</ul>
<h4 id="5-持久化："><a href="#5-持久化：" class="headerlink" title="5. 持久化："></a>5. <strong>持久化：</strong></h4><p>RabbitMQ 支持消息的持久化，确保消息在服务器重启后不会丢失。生产者和队列都可以声明为持久的。</p>
<h4 id="6-消息确认机制："><a href="#6-消息确认机制：" class="headerlink" title="6. 消息确认机制："></a>6. <strong>消息确认机制：</strong></h4><p>RabbitMQ 提供了消息确认机制，确保消息成功发送到队列或消费者成功接收和处理。生产者可以通过确认机制了解消息是否成功发送到 RabbitMQ，消费者可以通过确认机制告诉 RabbitMQ 已经成功处理了消息。</p>
<h4 id="7-消息的优先级："><a href="#7-消息的优先级：" class="headerlink" title="7. 消息的优先级："></a>7. <strong>消息的优先级：</strong></h4><p>RabbitMQ 支持为消息设置优先级，优先级高的消息将被优先处理。</p>
<h4 id="8-死信队列："><a href="#8-死信队列：" class="headerlink" title="8. 死信队列："></a>8. <strong>死信队列：</strong></h4><p>死信队列用于存储不能被消费的消息，通常是由于消息过期或者被拒绝。这样可以更灵活地处理无法正常处理的消息。</p>
<h4 id="9-集群和高可用性："><a href="#9-集群和高可用性：" class="headerlink" title="9. 集群和高可用性："></a>9. <strong>集群和高可用性：</strong></h4><p>RabbitMQ 支持集群部署，以提高系统的可靠性和性能。</p>
<h4 id="10-管理界面："><a href="#10-管理界面：" class="headerlink" title="10. 管理界面："></a>10. <strong>管理界面：</strong></h4><p>RabbitMQ 提供了一个用户友好的管理界面，可以通过浏览器访问，用于监控和管理 RabbitMQ 服务器。</p>
<p>RabbitMQ 在分布式系统中起到了重要的角色，提供了可靠的消息传递机制，适用于各种场景，包括微服务架构、任务队列等。</p>

                
            </div>
            <hr/>

            

    <div class="reprint" id="reprint-statement">
        
            <div class="reprint__author">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-user">
                        文章作者:
                    </i>
                </span>
                <span class="reprint-info">
                    <a href="/about" rel="external nofollow noreferrer">jochenxiao</a>
                </span>
            </div>
            <div class="reprint__type">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-link">
                        文章链接:
                    </i>
                </span>
                <span class="reprint-info">
                    <a href="https://codingxboy.github.io/2023/11/21/hou-duan/java/java-ji-chu-zhi-shi-da-gang/">https://codingxboy.github.io/2023/11/21/hou-duan/java/java-ji-chu-zhi-shi-da-gang/</a>
                </span>
            </div>
            <div class="reprint__notice">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-copyright">
                        版权声明:
                    </i>
                </span>
                <span class="reprint-info">
                    本博客所有文章除特別声明外，均采用
                    <a href="https://creativecommons.org/licenses/by/4.0/deed.zh" rel="external nofollow noreferrer" target="_blank">CC BY 4.0</a>
                    许可协议。转载请注明来源
                    <a href="/about" target="_blank">jochenxiao</a>
                    !
                </span>
            </div>
        
    </div>

    <script async defer>
      document.addEventListener("copy", function (e) {
        let toastHTML = '<span>复制成功，请遵循本文的转载规则</span><button class="btn-flat toast-action" onclick="navToReprintStatement()" style="font-size: smaller">查看</a>';
        M.toast({html: toastHTML})
      });

      function navToReprintStatement() {
        $("html, body").animate({scrollTop: $("#reprint-statement").offset().top - 80}, 800);
      }
    </script>



            <div class="tag_share" style="display: block;">
                <div class="post-meta__tag-list" style="display: inline-block;">
                    
                        <div class="article-tag">
                            
                                <a href="/tags/java/">
                                    <span class="chip bg-color">java</span>
                                </a>
                            
                        </div>
                    
                </div>
                <div class="post_share" style="zoom: 80%; width: fit-content; display: inline-block; float: right; margin: -0.15rem 0;">
                    <link rel="stylesheet" type="text/css" href="/libs/share/css/share.min.css">
<div id="article-share">

    
    <div class="social-share" data-sites="twitter,facebook,google,qq,qzone,wechat,weibo,douban,linkedin" data-wechat-qrcode-helper="<p>微信扫一扫即可分享！</p>"></div>
    <script src="/libs/share/js/social-share.min.js"></script>
    

    

</div>

                </div>
            </div>
            
                <div id="reward">
    <a href="#rewardModal" class="reward-link modal-trigger btn-floating btn-medium waves-effect waves-light red">扫码关注抖音号</a>

    <!-- Modal Structure -->
    <div id="rewardModal" class="modal">
        <div class="modal-content">
            <a class="close modal-close"><i class="fas fa-times"></i></a>
            <h4 class="reward-title">你的关注是我前进的动力</h4>
            <div class="reward-content">
                <div class="reward-tabs">
                    <ul class="tabs row">
                        <li class="tab col s6 alipay-tab waves-effect waves-light"><a href="#alipay">抖音号</a></li>
                    </ul>
                    <div id="alipay">
                        <img src="/medias/reward/alipay.jpg" class="reward-img" alt="抖音号二维码">
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    $(function () {
        $('.tabs').tabs();
    });
</script>

            
        </div>
    </div>

    

    

    

    

    

    

    

    

    

<article id="prenext-posts" class="prev-next articles">
    <div class="row article-row">
        
        <div class="article col s12 m6" data-aos="fade-up" data-aos="fade-up">
            <div class="article-badge left-badge text-color">
                <i class="far fa-dot-circle"></i>&nbsp;本篇
            </div>
            <div class="card">
                <a href="/2023/11/21/hou-duan/java/java-ji-chu-zhi-shi-da-gang/">
                    <div class="card-image">
                        
                        <img src="https://statics.sh1a.qingstor.com/2018/11/13/java8-1.jpg" class="responsive-img" alt="Java基础知识大纲">
                        
                        <span class="card-title">Java基础知识大纲</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            
                        
                    </div>
                    <div class="publish-info">
                            <span class="publish-date">
                                <i class="far fa-clock fa-fw icon-date"></i>2023-11-21
                            </span>
                        <span class="publish-author">
                            
                            <i class="fas fa-bookmark fa-fw icon-category"></i>
                            
                            <a href="/categories/%E5%90%8E%E7%AB%AF/" class="post-category">
                                    后端
                                </a>
                            
                            
                        </span>
                    </div>
                </div>

                
                <div class="card-action article-tags">
                    
                    <a href="/tags/java/">
                        <span class="chip bg-color">java</span>
                    </a>
                    
                </div>
                
            </div>
        </div>
        
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge right-badge text-color">
                下一篇&nbsp;<i class="fas fa-chevron-right"></i>
            </div>
            <div class="card">
                <a href="/2023/11/09/medias/">
                    <div class="card-image">
                        
                        
                        <img src="/medias/featureimages/6.jpg" class="responsive-img" alt="jQuery应用">
                        
                        <span class="card-title">jQuery应用</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            
                        
                    </div>
                    <div class="publish-info">
                            <span class="publish-date">
                                <i class="far fa-clock fa-fw icon-date"></i>2023-11-09
                            </span>
                        <span class="publish-author">
                            
                            <i class="fas fa-bookmark fa-fw icon-category"></i>
                            
                            <a href="/categories/web%E5%89%8D%E7%AB%AF/" class="post-category">
                                    web前端
                                </a>
                            
                            
                        </span>
                    </div>
                </div>
                
                <div class="card-action article-tags">
                    
                    <a href="/tags/%E5%89%8D%E7%AB%AF/">
                        <span class="chip bg-color">前端</span>
                    </a>
                    
                </div>
                
            </div>
        </div>
        
    </div>
</article>

</div>



<!-- 代码块功能依赖 -->
<script type="text/javascript" src="/libs/codeBlock/codeBlockFuction.js"></script>


  <!-- 是否加载使用自带的 prismjs. -->
  <script type="text/javascript" src="/libs/prism/prism.min.js"></script>


<!-- 代码语言 -->

<script type="text/javascript" src="/libs/codeBlock/codeLang.js"></script>


<!-- 代码块复制 -->

<script type="text/javascript" src="/libs/codeBlock/codeCopy.js"></script>


<!-- 代码块收缩 -->

<script type="text/javascript" src="/libs/codeBlock/codeShrink.js"></script>



    </div>
    <div id="toc-aside" class="expanded col l3 hide-on-med-and-down">
        <div class="toc-widget card" style="background-color: white;">
            <div class="toc-title"><i class="far fa-list-alt"></i>&nbsp;&nbsp;目录</div>
            <div id="toc-content"></div>
        </div>
    </div>
</div>

<!-- TOC 悬浮按钮. -->

<div id="floating-toc-btn" class="hide-on-med-and-down">
    <a class="btn-floating btn-large bg-color">
        <i class="fas fa-list-ul"></i>
    </a>
</div>


<script src="/libs/tocbot/tocbot.min.js"></script>
<script>
    $(function () {
        tocbot.init({
            tocSelector: '#toc-content',
            contentSelector: '#articleContent',
            headingsOffset: -($(window).height() * 0.4 - 45),
            collapseDepth: Number('0'),
            headingSelector: 'h2, h3, h4'
        });

        // Set scroll toc fixed.
        let tocHeight = parseInt($(window).height() * 0.4 - 64);
        let $tocWidget = $('.toc-widget');
        $(window).scroll(function () {
            let scroll = $(window).scrollTop();
            /* add post toc fixed. */
            if (scroll > tocHeight) {
                $tocWidget.addClass('toc-fixed');
            } else {
                $tocWidget.removeClass('toc-fixed');
            }
        });

        
        /* 修复文章卡片 div 的宽度. */
        let fixPostCardWidth = function (srcId, targetId) {
            let srcDiv = $('#' + srcId);
            if (srcDiv.length === 0) {
                return;
            }

            let w = srcDiv.width();
            if (w >= 450) {
                w = w + 21;
            } else if (w >= 350 && w < 450) {
                w = w + 18;
            } else if (w >= 300 && w < 350) {
                w = w + 16;
            } else {
                w = w + 14;
            }
            $('#' + targetId).width(w);
        };

        // 切换TOC目录展开收缩的相关操作.
        const expandedClass = 'expanded';
        let $tocAside = $('#toc-aside');
        let $mainContent = $('#main-content');
        $('#floating-toc-btn .btn-floating').click(function () {
            if ($tocAside.hasClass(expandedClass)) {
                $tocAside.removeClass(expandedClass).hide();
                $mainContent.removeClass('l9');
            } else {
                $tocAside.addClass(expandedClass).show();
                $mainContent.addClass('l9');
            }
            fixPostCardWidth('artDetail', 'prenext-posts');
        });
        
    });
</script>

    

</main>




    <footer class="page-footer bg-color">
    
        <link rel="stylesheet" href="/libs/aplayer/APlayer.min.css">
<style>
    .aplayer .aplayer-lrc p {
        
        display: none;
        
        font-size: 12px;
        font-weight: 700;
        line-height: 16px !important;
    }

    .aplayer .aplayer-lrc p.aplayer-lrc-current {
        
        display: none;
        
        font-size: 15px;
        color: #42b983;
    }

    
    .aplayer.aplayer-fixed.aplayer-narrow .aplayer-body {
        left: -66px !important;
    }

    .aplayer.aplayer-fixed.aplayer-narrow .aplayer-body:hover {
        left: 0px !important;
    }

    
</style>
<div class="">
    
    <div class="row">
        <meting-js class="col l8 offset-l2 m10 offset-m1 s12"
                   server="netease"
                   type="playlist"
                   id="503838841"
                   fixed='true'
                   autoplay='false'
                   theme='#42b983'
                   loop='all'
                   order='random'
                   preload='auto'
                   volume='0.7'
                   list-folded='true'
        >
        </meting-js>
    </div>
</div>

<script src="/libs/aplayer/APlayer.min.js"></script>
<script src="/libs/aplayer/Meting.min.js"></script>

    

    <div class="container row center-align"
         style="margin-bottom: 15px !important;">
        <div class="col s12 m8 l8 copy-right">
            Copyright&nbsp;&copy;
            
                <span id="year">2019-2023</span>
            
            <a href="/about" target="_blank">JochenXiao</a>
            |&nbsp;Powered by&nbsp;<a href="https://hexo.io/" target="_blank">Hexo</a>
            |&nbsp;Theme&nbsp;<a href="https://github.com/blinkfox/hexo-theme-matery" target="_blank">Matery</a>
            
                <span id="translate">|&nbsp;繁/简：</span><a id="translateLink" href="javascript:translatePage();">繁</a>
            
            <br>
            
                &nbsp;<i class="fas fa-chart-area"></i>&nbsp;站点总字数:&nbsp;<span
                        class="white-color">59.6k</span>
            
            
            
                
            
            
                <span id="busuanzi_container_site_pv">
                &nbsp;|&nbsp;<i class="far fa-eye"></i>&nbsp;总访问量:&nbsp;
                    <span id="busuanzi_value_site_pv" class="white-color"></span>
            </span>
            
            
                <span id="busuanzi_container_site_uv">
                &nbsp;|&nbsp;<i class="fas fa-users"></i>&nbsp;总访问人数:&nbsp;
                    <span id="busuanzi_value_site_uv" class="white-color"></span>
            </span>
            
            <br>

            <!-- 运行天数提醒. -->
            
                <span id="sitetime"> Loading ...</span>
                <script>
                    var calcSiteTime = function () {
                        var seconds = 1000;
                        var minutes = seconds * 60;
                        var hours = minutes * 60;
                        var days = hours * 24;
                        var years = days * 365;
                        var today = new Date();
                        var startYear = "2019";
                        var startMonth = "6";
                        var startDate = "28";
                        var startHour = "0";
                        var startMinute = "0";
                        var startSecond = "0";
                        var todayYear = today.getFullYear();
                        var todayMonth = today.getMonth() + 1;
                        var todayDate = today.getDate();
                        var todayHour = today.getHours();
                        var todayMinute = today.getMinutes();
                        var todaySecond = today.getSeconds();
                        var t1 = Date.UTC(startYear, startMonth, startDate, startHour, startMinute, startSecond);
                        var t2 = Date.UTC(todayYear, todayMonth, todayDate, todayHour, todayMinute, todaySecond);
                        var diff = t2 - t1;
                        var diffYears = Math.floor(diff / years);
                        var diffDays = Math.floor((diff / days) - diffYears * 365);

                        // 区分是否有年份.
                        var language = 'zh-CN';
                        if (startYear === String(todayYear)) {
                            document.getElementById("year").innerHTML = todayYear;
                            var daysTip = 'This site has been running for ' + diffDays + ' days';
                            if (language === 'zh-CN') {
                                daysTip = '本站已运行 ' + diffDays + ' 天';
                            } else if (language === 'zh-HK') {
                                daysTip = '本站已運行 ' + diffDays + ' 天';
                            }
                            document.getElementById("sitetime").innerHTML = daysTip;
                        } else {
                            document.getElementById("year").innerHTML = startYear + " - " + todayYear;
                            var yearsAndDaysTip = 'This site has been running for ' + diffYears + ' years and '
                                + diffDays + ' days';
                            if (language === 'zh-CN') {
                                yearsAndDaysTip = '本站已运行 ' + diffYears + ' 年 ' + diffDays + ' 天';
                            } else if (language === 'zh-HK') {
                                yearsAndDaysTip = '本站已運行 ' + diffYears + ' 年 ' + diffDays + ' 天';
                            }
                            document.getElementById("sitetime").innerHTML = yearsAndDaysTip;
                        }
                    }

                    calcSiteTime();
                </script>
            
            <br>
            
        </div>
        <div class="col s12 m4 l4 social-link social-statis">
    <a href="https://github.com/blinkfox" class="tooltipped" target="_blank" data-tooltip="访问我的GitHub" data-position="top" data-delay="50">
        <i class="fab fa-github"></i>
    </a>



    <a href="mailto:1181062873@qq.com" class="tooltipped" target="_blank" data-tooltip="邮件联系我" data-position="top" data-delay="50">
        <i class="fas fa-envelope-open"></i>
    </a>







    <a href="tencent://AddContact/?fromId=50&fromSubId=1&subcmd=all&uin=1181062873" class="tooltipped" target="_blank" data-tooltip="QQ联系我: 1181062873" data-position="top" data-delay="50">
        <i class="fab fa-qq"></i>
    </a>







    <a href="/atom.xml" class="tooltipped" target="_blank" data-tooltip="RSS 订阅" data-position="top" data-delay="50">
        <i class="fas fa-rss"></i>
    </a>

</div>
    </div>
</footer>

<div class="progress-bar"></div>


    <!-- 搜索遮罩框 -->
<div id="searchModal" class="modal">
    <div class="modal-content">
        <div class="search-header">
            <span class="title"><i class="fas fa-search"></i>&nbsp;&nbsp;搜索</span>
            <input type="search" id="searchInput" name="s" placeholder="请输入搜索的关键字"
                   class="search-input">
        </div>
        <div id="searchResult"></div>
    </div>
</div>

<script type="text/javascript">
$(function () {
    var searchFunc = function (path, search_id, content_id) {
        'use strict';
        $.ajax({
            url: path,
            dataType: "xml",
            success: function (xmlResponse) {
                // get the contents from search data
                var datas = $("entry", xmlResponse).map(function () {
                    return {
                        title: $("title", this).text(),
                        content: $("content", this).text(),
                        url: $("url", this).text()
                    };
                }).get();
                var $input = document.getElementById(search_id);
                var $resultContent = document.getElementById(content_id);
                $input.addEventListener('input', function () {
                    var str = '<ul class=\"search-result-list\">';
                    var keywords = this.value.trim().toLowerCase().split(/[\s\-]+/);
                    $resultContent.innerHTML = "";
                    if (this.value.trim().length <= 0) {
                        return;
                    }
                    // perform local searching
                    datas.forEach(function (data) {
                        var isMatch = true;
                        var data_title = data.title.trim().toLowerCase();
                        var data_content = data.content.trim().replace(/<[^>]+>/g, "").toLowerCase();
                        var data_url = data.url;
                        data_url = data_url.indexOf('/') === 0 ? data.url : '/' + data_url;
                        var index_title = -1;
                        var index_content = -1;
                        var first_occur = -1;
                        // only match artiles with not empty titles and contents
                        if (data_title !== '' && data_content !== '') {
                            keywords.forEach(function (keyword, i) {
                                index_title = data_title.indexOf(keyword);
                                index_content = data_content.indexOf(keyword);
                                if (index_title < 0 && index_content < 0) {
                                    isMatch = false;
                                } else {
                                    if (index_content < 0) {
                                        index_content = 0;
                                    }
                                    if (i === 0) {
                                        first_occur = index_content;
                                    }
                                }
                            });
                        }
                        // show search results
                        if (isMatch) {
                            str += "<li><a href='" + data_url + "' class='search-result-title'>" + data_title + "</a>";
                            var content = data.content.trim().replace(/<[^>]+>/g, "");
                            if (first_occur >= 0) {
                                // cut out 100 characters
                                var start = first_occur - 20;
                                var end = first_occur + 80;
                                if (start < 0) {
                                    start = 0;
                                }
                                if (start === 0) {
                                    end = 100;
                                }
                                if (end > content.length) {
                                    end = content.length;
                                }
                                var match_content = content.substr(start, end);
                                // highlight all keywords
                                keywords.forEach(function (keyword) {
                                    var regS = new RegExp(keyword, "gi");
                                    match_content = match_content.replace(regS, "<em class=\"search-keyword\">" + keyword + "</em>");
                                });

                                str += "<p class=\"search-result\">" + match_content + "...</p>"
                            }
                            str += "</li>";
                        }
                    });
                    str += "</ul>";
                    $resultContent.innerHTML = str;
                });
            }
        });
    };

    searchFunc('/search.xml', 'searchInput', 'searchResult');
});
</script>

    <!-- 白天和黑夜主题 -->
<div class="stars-con">
    <div id="stars"></div>
    <div id="stars2"></div>
    <div id="stars3"></div>  
</div>

<script>
    function switchNightMode() {
        $('<div class="Cuteen_DarkSky"><div class="Cuteen_DarkPlanet"></div></div>').appendTo($('body')),
        setTimeout(function () {
            $('body').hasClass('DarkMode') 
            ? ($('body').removeClass('DarkMode'), localStorage.setItem('isDark', '0'), $('#sum-moon-icon').removeClass("fa-sun").addClass('fa-moon')) 
            : ($('body').addClass('DarkMode'), localStorage.setItem('isDark', '1'), $('#sum-moon-icon').addClass("fa-sun").removeClass('fa-moon')),
            
            setTimeout(function () {
            $('.Cuteen_DarkSky').fadeOut(1e3, function () {
                $(this).remove()
            })
            }, 2e3)
        })
    }
</script>

    <!-- 回到顶部按钮 -->
<div id="backTop" class="top-scroll">
    <a class="btn-floating btn-large waves-effect waves-light" href="#!">
        <i class="fas fa-arrow-up"></i>
    </a>
</div>


    <script src="/libs/materialize/materialize.min.js"></script>
    <script src="/libs/masonry/masonry.pkgd.min.js"></script>
    <script src="/libs/aos/aos.js"></script>
    <script src="/libs/scrollprogress/scrollProgress.min.js"></script>
    <script src="/libs/lightGallery/js/lightgallery-all.min.js"></script>
    <script src="/js/matery.js"></script>

    

    
        <script type="text/javascript" src="/js/tw_cn.js"></script>
        <script type="text/javascript">
          var defaultEncoding = 2; //网站编写字体是否繁体，1-繁体，2-简体
          var translateDelay = 0; //延迟时间,若不在前, 要设定延迟翻译时间, 如100表示100ms,默认为0
          var cookieDomain = "https://codingxboy.github.io"; //Cookie地址, 一定要设定, 通常为你的网址
          var msgToTraditionalChinese = "繁"; //此处可以更改为你想要显示的文字
          var msgToSimplifiedChinese = "简"; //同上，但两处均不建议更改
          var translateButtonId = "translateLink"; //默认互换id
          translateInitilization();
        </script>
    
    
    

    <!-- 雪花特效 -->
    

    <!-- 鼠标星星特效 -->
     
        <script type="text/javascript">
            // 只在桌面版网页启用特效
            var windowWidth = $(window).width();
            if (windowWidth > 768) {
                document.write('<script type="text/javascript" src="/libs/others/star.js"><\/script>');
            }
        </script>
    

     
        <script src="https://ssl.captcha.qq.com/TCaptcha.js"></script>
        <script src="/libs/others/TencentCaptcha.js"></script>
        <button id="TencentCaptcha" data-appid="xxxxxxxxxx" data-cbfn="callback" type="button" hidden></button>
    

    <!-- Baidu Analytics -->

    <!-- Baidu Push -->

<script>
    (function () {
        var bp = document.createElement('script');
        var curProtocol = window.location.protocol.split(':')[0];
        if (curProtocol === 'https') {
            bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
        } else {
            bp.src = 'http://push.zhanzhang.baidu.com/push.js';
        }
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(bp, s);
    })();
</script>

    
    <script src="/libs/others/clicklove.js" async="async"></script>
    
    
    <script async src="/libs/others/busuanzi.pure.mini.js"></script>
    

    
        <script src="//code.tidio.co/yfadw38o0ba9cq3sjdhswugzbq0of3fw.js"></script>
        <script>
            $(document).ready(function () {
                setInterval(change_Tidio, 50);
                function change_Tidio() {
                    var tidio=$("#tidio-chat iframe");
                    if(tidio.css("display")=="block"&& $(window).width()>977 ){
                        document.getElementById("tidio-chat-iframe").style.bottom= ($("div#backTop.top-scroll").css("display")=="none" &&$(window).width()>977)>0? "-40px" : ($("div.toc-title").length&&$(window).width()>977)>0?"85px":"20px";
                        document.getElementById("tidio-chat-iframe").style.right="-15px";
                        document.getElementById("tidio-chat-iframe").style.height=parseInt(tidio.css("height"))>=520?"520px":tidio.css("height");
                        document.getElementById("tidio-chat-iframe").style.zIndex="997";
                    }
                    else if(tidio.css("display")=="block"&&$(window).width()>601 &&$(window).width()<992 ){
                        document.getElementById("tidio-chat-iframe").style.bottom= ($("div#backTop.top-scroll").css("display")=="none" && 601< $(window).width()<992)>0? "-40px":"20px" ;
                        document.getElementById("tidio-chat-iframe").style.right="-15px";
                        document.getElementById("tidio-chat-iframe").style.zIndex="997";
                    }
                    else if(tidio.css("display")=="block"&&$(window).width()<601 && parseInt(tidio.css("height"))<230){
                        document.getElementById("tidio-chat-iframe").style.bottom= ($("div#backTop.top-scroll").css("display")=="none" && $(window).width()<601)>0? "-10px":"45px" ;
                        document.getElementById("tidio-chat-iframe").style.zIndex="997";
                    }
                    if( tidio.css("display")=="block"&&$(window).width()<601 && parseInt(tidio.css("height"))>=230){
                        document.getElementById("tidio-chat-iframe").style.zIndex="998";
                    }
                }
            });
        </script>
    

    

    <!--腾讯兔小巢-->
    
    

    

    

    
    <script src="/libs/instantpage/instantpage.js" type="module"></script>
    

</body>

</html>
